2017-04-19 10:09:23,170: Tracking: tracking
2017-04-19 10:09:23,170: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f264550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f264a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f264908>]}
2017-04-19 10:09:23,248: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 10:09:23,299: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 10:09:23,302: Parsing materializations/incremental.sql
2017-04-19 10:09:23,322: Parsing materializations/table.sql
2017-04-19 10:09:23,331: Parsing materializations/view.sql
2017-04-19 10:09:23,336: Parsing materializations/wrapper.sql
2017-04-19 10:09:23,340: Parsing schema_tests/accepted_values.sql
2017-04-19 10:09:23,344: Parsing schema_tests/not_null.sql
2017-04-19 10:09:23,346: Parsing schema_tests/relationships.sql
2017-04-19 10:09:23,348: Parsing schema_tests/unique.sql
2017-04-19 10:09:23,353: Parsing model.shippo_test.shippo_parcels
2017-04-19 10:09:23,356: Compiled 1 models, 0 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 10:09:23,356: Acquiring new redshift connection "master".
2017-04-19 10:09:23,356: Opening a new connection (0 currently allocated)
2017-04-19 10:09:23,518: Using redshift connection "master".
2017-04-19 10:09:23,518: On master: BEGIN
2017-04-19 10:09:23,541: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:09:23,542: Creating schema "analytics".
2017-04-19 10:09:23,542: Using redshift connection "master".
2017-04-19 10:09:23,542: On master: create schema if not exists "analytics"
2017-04-19 10:09:23,553: SQL status: CREATE SCHEMA in 0.01 seconds
2017-04-19 10:09:23,553: On master: COMMIT
2017-04-19 10:09:24,590: Concurrency: 4 threads (target='only')
2017-04-19 10:09:24,590: Using redshift connection "master".
2017-04-19 10:09:24,590: On master: BEGIN
2017-04-19 10:09:24,613: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:09:24,614: Using redshift connection "master".
2017-04-19 10:09:24,614: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 10:09:24,643: SQL status: SELECT in 0.03 seconds
2017-04-19 10:09:24,643: On master: COMMIT
2017-04-19 10:09:24,655: 
2017-04-19 10:09:24,655: 10:09:24 | Running 1 view models
2017-04-19 10:09:24,655: 10:09:24 | 
2017-04-19 10:09:24,655: Using redshift connection "master".
2017-04-19 10:09:24,655: On master: BEGIN
2017-04-19 10:09:24,680: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:09:24,680: On master: COMMIT
2017-04-19 10:09:24,690: 10:09:24 | 1 of 1 START view model analytics.shippo_parcels..................... [RUN]
2017-04-19 10:09:24,690: Compiling model.shippo_test.shippo_parcels
2017-04-19 10:09:24,691: Acquiring new redshift connection "shippo_parcels".
2017-04-19 10:09:24,692: Opening a new connection (1 currently allocated)
2017-04-19 10:09:24,791: Using redshift connection "shippo_parcels".
2017-04-19 10:09:24,791: On shippo_parcels: BEGIN
2017-04-19 10:09:24,811: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:09:24,812: Using redshift connection "shippo_parcels".
2017-04-19 10:09:24,812: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 10:09:24,841: SQL status: SELECT in 0.03 seconds
2017-04-19 10:09:24,844: executing node model.shippo_test.shippo_parcels
2017-04-19 10:09:24,845: Using redshift connection "shippo_parcels".
2017-04-19 10:09:24,845: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 10:09:25,058: SQL status: CREATE VIEW in 0.21 seconds
2017-04-19 10:09:25,058: Using redshift connection "shippo_parcels".
2017-04-19 10:09:25,058: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 10:09:25,511: SQL status: ALTER TABLE in 0.45 seconds
2017-04-19 10:09:25,511: On shippo_parcels: COMMIT
2017-04-19 10:09:26,330: 10:09:26 | 1 of 1 OK created view model analytics.shippo_parcels................ [CREATE VIEW in 1.64s]
2017-04-19 10:09:26,331: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5b4e799-5d3b-4901-ad4e-f7591903ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f313be0>]}
2017-04-19 10:09:26,399: Using redshift connection "master".
2017-04-19 10:09:26,399: On master: BEGIN
2017-04-19 10:09:26,424: SQL status: BEGIN in 0.03 seconds
2017-04-19 10:09:26,425: On master: COMMIT
2017-04-19 10:09:26,441: 10:09:26 | 
2017-04-19 10:09:26,441: 10:09:26 | Finished running 1 view models in 1.79s.
2017-04-19 10:09:26,442: Connection 'master' was left open.
2017-04-19 10:09:26,442: Done. PASS=1 ERROR=0 SKIP=0 TOTAL=1
2017-04-19 10:09:26,442: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f264908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f264a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2645c0>]}
2017-04-19 10:09:26,507: Flushing usage events
2017-04-19 10:10:34,109: Tracking: tracking
2017-04-19 10:10:34,110: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7a8358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7a8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7a8a20>]}
2017-04-19 10:10:34,210: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 10:10:34,255: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 10:10:34,256: Parsing materializations/incremental.sql
2017-04-19 10:10:34,271: Parsing materializations/table.sql
2017-04-19 10:10:34,279: Parsing materializations/view.sql
2017-04-19 10:10:34,282: Parsing materializations/wrapper.sql
2017-04-19 10:10:34,285: Parsing schema_tests/accepted_values.sql
2017-04-19 10:10:34,287: Parsing schema_tests/not_null.sql
2017-04-19 10:10:34,288: Parsing schema_tests/relationships.sql
2017-04-19 10:10:34,290: Parsing schema_tests/unique.sql
2017-04-19 10:10:34,295: Parsing model.shippo_test.shippo_parcels
2017-04-19 10:10:34,300: Compiled 1 models, 0 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 10:10:34,301: Acquiring new redshift connection "master".
2017-04-19 10:10:34,301: Opening a new connection (0 currently allocated)
2017-04-19 10:10:34,424: Using redshift connection "master".
2017-04-19 10:10:34,424: On master: BEGIN
2017-04-19 10:10:34,444: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:10:34,445: Creating schema "analytics".
2017-04-19 10:10:34,445: Using redshift connection "master".
2017-04-19 10:10:34,445: On master: create schema if not exists "analytics"
2017-04-19 10:10:34,464: SQL status: CREATE SCHEMA in 0.02 seconds
2017-04-19 10:10:34,464: On master: COMMIT
2017-04-19 10:10:37,628: Concurrency: 4 threads (target='only')
2017-04-19 10:10:37,628: Using redshift connection "master".
2017-04-19 10:10:37,628: On master: BEGIN
2017-04-19 10:10:37,650: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:10:37,651: Using redshift connection "master".
2017-04-19 10:10:37,651: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 10:10:37,679: SQL status: SELECT in 0.03 seconds
2017-04-19 10:10:37,680: On master: COMMIT
2017-04-19 10:10:37,691: 
2017-04-19 10:10:37,691: 10:10:37 | Running 1 view models
2017-04-19 10:10:37,691: 10:10:37 | 
2017-04-19 10:10:37,691: Using redshift connection "master".
2017-04-19 10:10:37,691: On master: BEGIN
2017-04-19 10:10:37,714: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:10:37,715: On master: COMMIT
2017-04-19 10:10:37,728: 10:10:37 | 1 of 1 START view model analytics.shippo_parcels..................... [RUN]
2017-04-19 10:10:37,728: Compiling model.shippo_test.shippo_parcels
2017-04-19 10:10:37,730: Acquiring new redshift connection "shippo_parcels".
2017-04-19 10:10:37,730: Opening a new connection (1 currently allocated)
2017-04-19 10:10:37,853: Using redshift connection "shippo_parcels".
2017-04-19 10:10:37,853: On shippo_parcels: BEGIN
2017-04-19 10:10:37,875: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:10:37,875: Using redshift connection "shippo_parcels".
2017-04-19 10:10:37,875: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 10:10:37,905: SQL status: SELECT in 0.03 seconds
2017-04-19 10:10:37,907: executing node model.shippo_test.shippo_parcels
2017-04-19 10:10:37,908: Using redshift connection "shippo_parcels".
2017-04-19 10:10:37,908: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 10:10:37,930: SQL status: CREATE VIEW in 0.02 seconds
2017-04-19 10:10:37,931: On shippo_parcels: COMMIT
2017-04-19 10:10:41,045: Using redshift connection "shippo_parcels".
2017-04-19 10:10:41,045: On shippo_parcels: BEGIN
2017-04-19 10:10:41,070: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:10:41,070: Using redshift connection "shippo_parcels".
2017-04-19 10:10:41,071: On shippo_parcels: drop view if exists "analytics"."shippo_parcels" cascade
2017-04-19 10:10:41,198: SQL status: DROP VIEW in 0.13 seconds
2017-04-19 10:10:41,199: On shippo_parcels: COMMIT
2017-04-19 10:10:41,682: Using redshift connection "shippo_parcels".
2017-04-19 10:10:41,682: On shippo_parcels: BEGIN
2017-04-19 10:10:41,707: SQL status: BEGIN in 0.03 seconds
2017-04-19 10:10:41,707: Using redshift connection "shippo_parcels".
2017-04-19 10:10:41,708: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 10:10:41,721: SQL status: ALTER TABLE in 0.01 seconds
2017-04-19 10:10:41,721: On shippo_parcels: COMMIT
2017-04-19 10:10:42,413: 10:10:42 | 1 of 1 OK created view model analytics.shippo_parcels................ [CREATE VIEW in 4.69s]
2017-04-19 10:10:42,414: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def40905-5456-44a5-ba9a-7327b1987d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e858b00>]}
2017-04-19 10:10:42,540: Using redshift connection "master".
2017-04-19 10:10:42,540: On master: BEGIN
2017-04-19 10:10:42,561: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:10:42,561: On master: COMMIT
2017-04-19 10:10:42,572: 10:10:42 | 
2017-04-19 10:10:42,573: 10:10:42 | Finished running 1 view models in 4.88s.
2017-04-19 10:10:42,573: Connection 'master' was left open.
2017-04-19 10:10:42,573: Done. PASS=1 ERROR=0 SKIP=0 TOTAL=1
2017-04-19 10:10:42,574: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e775518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e775198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e775780>]}
2017-04-19 10:10:42,641: Flushing usage events
2017-04-19 10:29:38,538: Tracking: tracking
2017-04-19 10:29:38,540: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148d4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148d080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148d438>]}
2017-04-19 10:29:38,765: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 10:29:38,817: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 10:29:38,820: Parsing materializations/incremental.sql
2017-04-19 10:29:38,838: Parsing materializations/table.sql
2017-04-19 10:29:38,848: Parsing materializations/view.sql
2017-04-19 10:29:38,853: Parsing materializations/wrapper.sql
2017-04-19 10:29:38,856: Parsing schema_tests/accepted_values.sql
2017-04-19 10:29:38,859: Parsing schema_tests/not_null.sql
2017-04-19 10:29:38,862: Parsing schema_tests/relationships.sql
2017-04-19 10:29:38,864: Parsing schema_tests/unique.sql
2017-04-19 10:29:38,870: Parsing model.shippo_test.shippo_parcels
2017-04-19 10:29:38,874: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 10:29:38,875: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 10:29:38,876: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 10:29:38,878: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 10:29:38,879: Compiled 1 models, 4 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 10:29:38,880: Acquiring new redshift connection "master".
2017-04-19 10:29:38,880: Opening a new connection (0 currently allocated)
2017-04-19 10:29:39,008: Using redshift connection "master".
2017-04-19 10:29:39,008: On master: BEGIN
2017-04-19 10:29:39,034: SQL status: BEGIN in 0.03 seconds
2017-04-19 10:29:39,034: Creating schema "analytics".
2017-04-19 10:29:39,035: Using redshift connection "master".
2017-04-19 10:29:39,035: On master: create schema if not exists "analytics"
2017-04-19 10:29:39,044: SQL status: CREATE SCHEMA in 0.01 seconds
2017-04-19 10:29:39,044: On master: COMMIT
2017-04-19 10:29:39,666: Concurrency: 4 threads (target='only')
2017-04-19 10:29:39,666: Using redshift connection "master".
2017-04-19 10:29:39,666: On master: BEGIN
2017-04-19 10:29:39,685: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:29:39,685: Using redshift connection "master".
2017-04-19 10:29:39,685: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 10:29:39,714: SQL status: SELECT in 0.03 seconds
2017-04-19 10:29:39,714: On master: COMMIT
2017-04-19 10:29:39,724: 
2017-04-19 10:29:39,724: 10:29:39 | Running 4 tests
2017-04-19 10:29:39,725: 10:29:39 | 
2017-04-19 10:29:39,725: 10:29:39 | 1 of 4 START test not_null_shippo_parcels_created_at................. [RUN]
2017-04-19 10:29:39,725: Compiling test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 10:29:39,725: 10:29:39 | 2 of 4 START test not_null_shippo_parcels_id......................... [RUN]
2017-04-19 10:29:39,725: 10:29:39 | 3 of 4 START test not_null_shippo_parcels_state...................... [RUN]
2017-04-19 10:29:39,727: Compiling test.shippo_test.not_null_shippo_parcels_id
2017-04-19 10:29:39,725: 10:29:39 | 4 of 4 START test unique_shippo_parcels_id........................... [RUN]
2017-04-19 10:29:39,727: Compiling test.shippo_test.not_null_shippo_parcels_state
2017-04-19 10:29:39,729: executing node test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 10:29:39,729: executing node test.shippo_test.not_null_shippo_parcels_id
2017-04-19 10:29:39,729: Compiling test.shippo_test.unique_shippo_parcels_id
2017-04-19 10:29:39,732: Acquiring new redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 10:29:39,732: Acquiring new redshift connection "not_null_shippo_parcels_id".
2017-04-19 10:29:39,734: Opening a new connection (1 currently allocated)
2017-04-19 10:29:39,734: executing node test.shippo_test.not_null_shippo_parcels_state
2017-04-19 10:29:39,734: executing node test.shippo_test.unique_shippo_parcels_id
2017-04-19 10:29:39,735: Acquiring new redshift connection "not_null_shippo_parcels_state".
2017-04-19 10:29:39,736: Acquiring new redshift connection "unique_shippo_parcels_id".
2017-04-19 10:29:39,820: Using redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 10:29:39,821: On not_null_shippo_parcels_created_at: BEGIN
2017-04-19 10:29:39,821: Opening a new connection (2 currently allocated)
2017-04-19 10:29:39,840: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:29:39,841: Using redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 10:29:39,841: On not_null_shippo_parcels_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 10:29:39,904: Using redshift connection "not_null_shippo_parcels_id".
2017-04-19 10:29:39,904: On not_null_shippo_parcels_id: BEGIN
2017-04-19 10:29:39,904: Opening a new connection (3 currently allocated)
2017-04-19 10:29:39,924: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:29:39,924: Using redshift connection "not_null_shippo_parcels_id".
2017-04-19 10:29:39,925: On not_null_shippo_parcels_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 10:29:39,983: Using redshift connection "not_null_shippo_parcels_state".
2017-04-19 10:29:39,983: On not_null_shippo_parcels_state: BEGIN
2017-04-19 10:29:39,983: Opening a new connection (4 currently allocated)
2017-04-19 10:29:40,003: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:29:40,004: Using redshift connection "not_null_shippo_parcels_state".
2017-04-19 10:29:40,004: On not_null_shippo_parcels_state: 

with validation as (

    select
        state as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 10:29:40,072: Using redshift connection "unique_shippo_parcels_id".
2017-04-19 10:29:40,072: On unique_shippo_parcels_id: BEGIN
2017-04-19 10:29:40,092: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:29:40,092: Using redshift connection "unique_shippo_parcels_id".
2017-04-19 10:29:40,092: On unique_shippo_parcels_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_parcels"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 10:29:42,534: SQL status: SELECT in 2.69 seconds
2017-04-19 10:29:42,534: On not_null_shippo_parcels_created_at: COMMIT
2017-04-19 10:29:42,544: 10:29:42 | 1 of 4 PASS not_null_shippo_parcels_created_at....................... [PASS in 2.82s]
2017-04-19 10:29:42,545: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eeea1c3-ffe6-4b6a-8202-90813b4001dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111479208>]}
2017-04-19 10:29:42,689: SQL status: SELECT in 2.69 seconds
2017-04-19 10:29:42,689: On not_null_shippo_parcels_state: COMMIT
2017-04-19 10:29:42,699: 10:29:42 | 3 of 4 PASS not_null_shippo_parcels_state............................ [PASS in 2.97s]
2017-04-19 10:29:42,699: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eeea1c3-ffe6-4b6a-8202-90813b4001dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111479668>]}
2017-04-19 10:29:42,771: SQL status: SELECT in 2.85 seconds
2017-04-19 10:29:42,772: On not_null_shippo_parcels_id: COMMIT
2017-04-19 10:29:42,781: 10:29:42 | 2 of 4 PASS not_null_shippo_parcels_id............................... [PASS in 3.06s]
2017-04-19 10:29:42,782: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eeea1c3-ffe6-4b6a-8202-90813b4001dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111479860>]}
2017-04-19 10:29:44,888: SQL status: SELECT in 4.80 seconds
2017-04-19 10:29:44,888: On unique_shippo_parcels_id: COMMIT
2017-04-19 10:29:44,898: 10:29:44 | 4 of 4 PASS unique_shippo_parcels_id................................. [PASS in 5.17s]
2017-04-19 10:29:44,899: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eeea1c3-ffe6-4b6a-8202-90813b4001dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114795c0>]}
2017-04-19 10:29:44,982: 10:29:44 | 
2017-04-19 10:29:44,982: 10:29:44 | Finished running 4 tests in 5.26s.
2017-04-19 10:29:44,983: Connection 'master' was left open.
2017-04-19 10:29:44,983: Done. PASS=4 ERROR=0 SKIP=0 TOTAL=4
2017-04-19 10:29:44,984: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148d438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148d080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148d390>]}
2017-04-19 10:29:45,057: Flushing usage events
2017-04-19 10:52:00,173: Tracking: tracking
2017-04-19 10:52:00,175: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ee240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ee0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ee9b0>]}
2017-04-19 10:52:00,318: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 10:52:00,365: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 10:52:00,367: Parsing materializations/incremental.sql
2017-04-19 10:52:00,386: Parsing materializations/table.sql
2017-04-19 10:52:00,395: Parsing materializations/view.sql
2017-04-19 10:52:00,400: Parsing materializations/wrapper.sql
2017-04-19 10:52:00,404: Parsing schema_tests/accepted_values.sql
2017-04-19 10:52:00,408: Parsing schema_tests/not_null.sql
2017-04-19 10:52:00,410: Parsing schema_tests/relationships.sql
2017-04-19 10:52:00,413: Parsing schema_tests/unique.sql
2017-04-19 10:52:00,418: Parsing model.shippo_test.shippo_parcels
2017-04-19 10:52:00,420: Parsing model.shippo_test.shippo_shipments
2017-04-19 10:52:00,426: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 10:52:00,427: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 10:52:00,429: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 10:52:00,430: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 10:52:00,431: Compiled 2 models, 4 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 10:52:00,432: Acquiring new redshift connection "master".
2017-04-19 10:52:00,432: Opening a new connection (0 currently allocated)
2017-04-19 10:52:00,544: Using redshift connection "master".
2017-04-19 10:52:00,544: On master: BEGIN
2017-04-19 10:52:00,564: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:52:00,564: Creating schema "analytics".
2017-04-19 10:52:00,564: Using redshift connection "master".
2017-04-19 10:52:00,564: On master: create schema if not exists "analytics"
2017-04-19 10:52:00,574: SQL status: CREATE SCHEMA in 0.01 seconds
2017-04-19 10:52:00,574: On master: COMMIT
2017-04-19 10:52:00,958: Concurrency: 4 threads (target='only')
2017-04-19 10:52:00,958: Using redshift connection "master".
2017-04-19 10:52:00,958: On master: BEGIN
2017-04-19 10:52:00,986: SQL status: BEGIN in 0.03 seconds
2017-04-19 10:52:00,987: Using redshift connection "master".
2017-04-19 10:52:00,987: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 10:52:01,017: SQL status: SELECT in 0.03 seconds
2017-04-19 10:52:01,017: On master: COMMIT
2017-04-19 10:52:01,028: 
2017-04-19 10:52:01,028: 10:52:01 | Running 2 view models
2017-04-19 10:52:01,028: 10:52:01 | 
2017-04-19 10:52:01,028: Using redshift connection "master".
2017-04-19 10:52:01,028: On master: BEGIN
2017-04-19 10:52:01,048: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:52:01,049: On master: COMMIT
2017-04-19 10:52:01,059: 10:52:01 | 1 of 2 START view model analytics.shippo_shipments................... [RUN]
2017-04-19 10:52:01,059: Compiling model.shippo_test.shippo_shipments
2017-04-19 10:52:01,061: Acquiring new redshift connection "shippo_shipments".
2017-04-19 10:52:01,061: 10:52:01 | 2 of 2 START view model analytics.shippo_parcels..................... [RUN]
2017-04-19 10:52:01,061: Opening a new connection (1 currently allocated)
2017-04-19 10:52:01,061: Compiling model.shippo_test.shippo_parcels
2017-04-19 10:52:01,063: Acquiring new redshift connection "shippo_parcels".
2017-04-19 10:52:01,151: Using redshift connection "shippo_shipments".
2017-04-19 10:52:01,151: On shippo_shipments: BEGIN
2017-04-19 10:52:01,152: Opening a new connection (2 currently allocated)
2017-04-19 10:52:01,169: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:52:01,170: Using redshift connection "shippo_shipments".
2017-04-19 10:52:01,170: On shippo_shipments: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 10:52:01,197: SQL status: SELECT in 0.03 seconds
2017-04-19 10:52:01,199: executing node model.shippo_test.shippo_shipments
2017-04-19 10:52:01,200: Using redshift connection "shippo_shipments".
2017-04-19 10:52:01,201: On shippo_shipments: -- Compiled by DBT

    

    create view "analytics"."shippo_shipments__dbt_tmp" as (
        select

    object_id as id,

    address_from as address_from_id,
    address_return as address_return_id,
    address_to as address_to_id,
    parcel as parcel_id,

    insurance_amount::float,
    insurance_currency,

    rates_url,
    return_of,
    submission_date,
    lower(submission_type) as submission_type,
    customs_declaration,


    object_owner as owner,
    lower(object_state) as state,
    lower(object_purpose) as purpose,
    lower(object_status) as status,


    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments
    );

    
2017-04-19 10:52:01,270: Using redshift connection "shippo_parcels".
2017-04-19 10:52:01,270: On shippo_parcels: BEGIN
2017-04-19 10:52:01,287: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:52:01,288: Using redshift connection "shippo_parcels".
2017-04-19 10:52:01,288: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 10:52:01,316: SQL status: SELECT in 0.03 seconds
2017-04-19 10:52:01,317: executing node model.shippo_test.shippo_parcels
2017-04-19 10:52:01,318: Using redshift connection "shippo_parcels".
2017-04-19 10:52:01,319: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 10:52:01,333: SQL status: CREATE VIEW in 0.01 seconds
2017-04-19 10:52:01,333: On shippo_parcels: COMMIT
2017-04-19 10:52:01,346: SQL status: CREATE VIEW in 0.15 seconds
2017-04-19 10:52:01,346: Using redshift connection "shippo_shipments".
2017-04-19 10:52:01,346: On shippo_shipments: alter table "analytics"."shippo_shipments__dbt_tmp" rename to "shippo_shipments"
2017-04-19 10:52:01,355: SQL status: ALTER TABLE in 0.01 seconds
2017-04-19 10:52:01,356: On shippo_shipments: COMMIT
2017-04-19 10:52:01,784: Using redshift connection "shippo_parcels".
2017-04-19 10:52:01,784: On shippo_parcels: BEGIN
2017-04-19 10:52:01,801: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:52:01,801: Using redshift connection "shippo_parcels".
2017-04-19 10:52:01,801: On shippo_parcels: drop view if exists "analytics"."shippo_parcels" cascade
2017-04-19 10:52:01,867: 10:52:01 | 1 of 2 OK created view model analytics.shippo_shipments.............. [CREATE VIEW in 0.81s]
2017-04-19 10:52:01,868: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f27d05b-599b-4436-91f8-b92801e462ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789e8d0>]}
2017-04-19 10:52:01,870: SQL status: DROP VIEW in 0.07 seconds
2017-04-19 10:52:01,870: On shippo_parcels: COMMIT
2017-04-19 10:52:02,293: Using redshift connection "shippo_parcels".
2017-04-19 10:52:02,294: On shippo_parcels: BEGIN
2017-04-19 10:52:02,311: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:52:02,311: Using redshift connection "shippo_parcels".
2017-04-19 10:52:02,312: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 10:52:02,702: SQL status: ALTER TABLE in 0.39 seconds
2017-04-19 10:52:02,702: On shippo_parcels: COMMIT
2017-04-19 10:52:04,461: 10:52:04 | 2 of 2 OK created view model analytics.shippo_parcels................ [CREATE VIEW in 3.40s]
2017-04-19 10:52:04,462: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f27d05b-599b-4436-91f8-b92801e462ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077df780>]}
2017-04-19 10:52:04,529: Using redshift connection "master".
2017-04-19 10:52:04,529: On master: BEGIN
2017-04-19 10:52:04,549: SQL status: BEGIN in 0.02 seconds
2017-04-19 10:52:04,549: On master: COMMIT
2017-04-19 10:52:04,558: 10:52:04 | 
2017-04-19 10:52:04,559: 10:52:04 | Finished running 2 view models in 3.53s.
2017-04-19 10:52:04,559: Connection 'master' was left open.
2017-04-19 10:52:04,559: Done. PASS=2 ERROR=0 SKIP=0 TOTAL=2
2017-04-19 10:52:04,560: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107795a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ee240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ee5c0>]}
2017-04-19 10:52:04,623: Flushing usage events
2017-04-19 11:00:20,438: Tracking: tracking
2017-04-19 11:00:20,438: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299a278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299a128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299a9e8>]}
2017-04-19 11:00:20,555: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 11:00:20,602: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 11:00:20,603: Parsing materializations/incremental.sql
2017-04-19 11:00:20,619: Parsing materializations/table.sql
2017-04-19 11:00:20,627: Parsing materializations/view.sql
2017-04-19 11:00:20,631: Parsing materializations/wrapper.sql
2017-04-19 11:00:20,634: Parsing schema_tests/accepted_values.sql
2017-04-19 11:00:20,636: Parsing schema_tests/not_null.sql
2017-04-19 11:00:20,638: Parsing schema_tests/relationships.sql
2017-04-19 11:00:20,639: Parsing schema_tests/unique.sql
2017-04-19 11:00:20,645: Parsing model.shippo_test.shippo_parcels
2017-04-19 11:00:20,647: Parsing model.shippo_test.shippo_shipments
2017-04-19 11:00:20,653: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 11:00:20,655: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 11:00:20,656: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 11:00:20,657: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 11:00:20,658: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 11:00:20,660: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 11:00:20,661: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 11:00:20,662: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 11:00:20,663: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 11:00:20,665: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 11:00:20,666: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 11:00:20,668: Compiled 2 models, 11 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 11:00:20,669: Acquiring new redshift connection "master".
2017-04-19 11:00:20,669: Opening a new connection (0 currently allocated)
2017-04-19 11:00:20,820: Using redshift connection "master".
2017-04-19 11:00:20,820: On master: BEGIN
2017-04-19 11:00:20,840: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:20,840: Creating schema "analytics".
2017-04-19 11:00:20,840: Using redshift connection "master".
2017-04-19 11:00:20,840: On master: create schema if not exists "analytics"
2017-04-19 11:00:20,850: SQL status: CREATE SCHEMA in 0.01 seconds
2017-04-19 11:00:20,851: On master: COMMIT
2017-04-19 11:00:22,271: Concurrency: 4 threads (target='only')
2017-04-19 11:00:22,271: Using redshift connection "master".
2017-04-19 11:00:22,271: On master: BEGIN
2017-04-19 11:00:22,292: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:22,292: Using redshift connection "master".
2017-04-19 11:00:22,293: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 11:00:22,321: SQL status: SELECT in 0.03 seconds
2017-04-19 11:00:22,322: On master: COMMIT
2017-04-19 11:00:22,333: 
2017-04-19 11:00:22,333: 11:00:22 | Running 11 tests
2017-04-19 11:00:22,333: 11:00:22 | 
2017-04-19 11:00:22,333: 11:00:22 | 1 of 11 START test relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_ [RUN]
2017-04-19 11:00:22,334: Compiling test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 11:00:22,333: 11:00:22 | 2 of 11 START test not_null_shippo_shipments_purpose................. [RUN]
2017-04-19 11:00:22,333: 11:00:22 | 3 of 11 START test not_null_shippo_parcels_created_at................ [RUN]
2017-04-19 11:00:22,333: 11:00:22 | 4 of 11 START test not_null_shippo_shipments_id...................... [RUN]
2017-04-19 11:00:22,336: Compiling test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 11:00:22,336: Compiling test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 11:00:22,336: Compiling test.shippo_test.not_null_shippo_shipments_id
2017-04-19 11:00:22,337: executing node test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 11:00:22,343: Acquiring new redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 11:00:22,343: Opening a new connection (1 currently allocated)
2017-04-19 11:00:22,343: executing node test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 11:00:22,343: executing node test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 11:00:22,343: executing node test.shippo_test.not_null_shippo_shipments_id
2017-04-19 11:00:22,344: Acquiring new redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 11:00:22,345: Acquiring new redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 11:00:22,345: Acquiring new redshift connection "not_null_shippo_shipments_id".
2017-04-19 11:00:22,433: Using redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 11:00:22,433: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: BEGIN
2017-04-19 11:00:22,433: Opening a new connection (2 currently allocated)
2017-04-19 11:00:22,454: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:22,454: Using redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 11:00:22,454: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_parcels"

),

child as (

    select
        parcel_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 11:00:22,522: Using redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 11:00:22,522: On not_null_shippo_parcels_created_at: BEGIN
2017-04-19 11:00:22,522: Opening a new connection (3 currently allocated)
2017-04-19 11:00:22,543: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:22,543: Using redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 11:00:22,543: On not_null_shippo_parcels_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 11:00:22,613: SQL status: SELECT in 0.07 seconds
2017-04-19 11:00:22,613: On not_null_shippo_parcels_created_at: COMMIT
2017-04-19 11:00:22,617: Using redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 11:00:22,617: Opening a new connection (4 currently allocated)
2017-04-19 11:00:22,617: On not_null_shippo_shipments_purpose: BEGIN
2017-04-19 11:00:22,640: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:22,640: Using redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 11:00:22,640: On not_null_shippo_shipments_purpose: 

with validation as (

    select
        purpose as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 11:00:22,705: Using redshift connection "not_null_shippo_shipments_id".
2017-04-19 11:00:22,705: 11:00:22 | 3 of 11 PASS not_null_shippo_parcels_created_at...................... [PASS in 0.37s]
2017-04-19 11:00:22,705: On not_null_shippo_shipments_id: BEGIN
2017-04-19 11:00:22,705: 11:00:22 | 5 of 11 START test unique_shippo_parcels_id.......................... [RUN]
2017-04-19 11:00:22,706: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a4d9b0>]}
2017-04-19 11:00:22,706: Compiling test.shippo_test.unique_shippo_parcels_id
2017-04-19 11:00:22,710: executing node test.shippo_test.unique_shippo_parcels_id
2017-04-19 11:00:22,711: Acquiring new redshift connection "unique_shippo_parcels_id".
2017-04-19 11:00:22,711: Re-using an available connection from the pool.
2017-04-19 11:00:22,711: Using redshift connection "unique_shippo_parcels_id".
2017-04-19 11:00:22,711: On unique_shippo_parcels_id: BEGIN
2017-04-19 11:00:22,727: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:22,727: Using redshift connection "not_null_shippo_shipments_id".
2017-04-19 11:00:22,727: On not_null_shippo_shipments_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 11:00:22,732: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:22,732: Using redshift connection "unique_shippo_parcels_id".
2017-04-19 11:00:22,732: On unique_shippo_parcels_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_parcels"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 11:00:22,919: SQL status: SELECT in 0.19 seconds
2017-04-19 11:00:22,920: On unique_shippo_parcels_id: COMMIT
2017-04-19 11:00:22,930: 11:00:22 | 5 of 11 PASS unique_shippo_parcels_id................................ [PASS in 0.22s]
2017-04-19 11:00:22,931: 11:00:22 | 6 of 11 START test not_null_shippo_shipments_status.................. [RUN]
2017-04-19 11:00:22,931: Compiling test.shippo_test.not_null_shippo_shipments_status
2017-04-19 11:00:22,933: executing node test.shippo_test.not_null_shippo_shipments_status
2017-04-19 11:00:22,934: Acquiring new redshift connection "not_null_shippo_shipments_status".
2017-04-19 11:00:22,934: Re-using an available connection from the pool.
2017-04-19 11:00:22,934: Using redshift connection "not_null_shippo_shipments_status".
2017-04-19 11:00:22,934: On not_null_shippo_shipments_status: BEGIN
2017-04-19 11:00:22,955: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:22,955: Using redshift connection "not_null_shippo_shipments_status".
2017-04-19 11:00:22,955: On not_null_shippo_shipments_status: 

with validation as (

    select
        status as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 11:00:23,339: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a4d9b0>]}
2017-04-19 11:00:25,485: SQL status: SELECT in 2.84 seconds
2017-04-19 11:00:25,485: On not_null_shippo_shipments_purpose: COMMIT
2017-04-19 11:00:25,485: SQL status: SELECT in 2.76 seconds
2017-04-19 11:00:25,485: On not_null_shippo_shipments_id: COMMIT
2017-04-19 11:00:25,499: 11:00:25 | 4 of 11 PASS not_null_shippo_shipments_id............................ [PASS in 3.17s]
2017-04-19 11:00:25,499: 11:00:25 | 2 of 11 PASS not_null_shippo_shipments_purpose....................... [PASS in 3.17s]
2017-04-19 11:00:25,500: 11:00:25 | 7 of 11 START test not_null_shippo_parcels_state..................... [RUN]
2017-04-19 11:00:25,500: Compiling test.shippo_test.not_null_shippo_parcels_state
2017-04-19 11:00:25,502: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a4d438>]}
2017-04-19 11:00:25,500: 11:00:25 | 8 of 11 START test unique_shippo_shipments_id........................ [RUN]
2017-04-19 11:00:25,504: Compiling test.shippo_test.unique_shippo_shipments_id
2017-04-19 11:00:25,507: executing node test.shippo_test.unique_shippo_shipments_id
2017-04-19 11:00:25,507: executing node test.shippo_test.not_null_shippo_parcels_state
2017-04-19 11:00:25,508: Acquiring new redshift connection "unique_shippo_shipments_id".
2017-04-19 11:00:25,508: Acquiring new redshift connection "not_null_shippo_parcels_state".
2017-04-19 11:00:25,508: Re-using an available connection from the pool.
2017-04-19 11:00:25,508: Using redshift connection "unique_shippo_shipments_id".
2017-04-19 11:00:25,509: On unique_shippo_shipments_id: BEGIN
2017-04-19 11:00:25,509: Re-using an available connection from the pool.
2017-04-19 11:00:25,509: Using redshift connection "not_null_shippo_parcels_state".
2017-04-19 11:00:25,509: On not_null_shippo_parcels_state: BEGIN
2017-04-19 11:00:25,541: SQL status: BEGIN in 0.03 seconds
2017-04-19 11:00:25,542: Using redshift connection "unique_shippo_shipments_id".
2017-04-19 11:00:25,542: On unique_shippo_shipments_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_shipments"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 11:00:25,542: SQL status: BEGIN in 0.03 seconds
2017-04-19 11:00:25,542: Using redshift connection "not_null_shippo_parcels_state".
2017-04-19 11:00:25,542: On not_null_shippo_parcels_state: 

with validation as (

    select
        state as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 11:00:25,590: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11296ee48>]}
2017-04-19 11:00:25,618: SQL status: SELECT in 0.08 seconds
2017-04-19 11:00:25,619: On not_null_shippo_parcels_state: COMMIT
2017-04-19 11:00:25,630: 11:00:25 | 7 of 11 PASS not_null_shippo_parcels_state........................... [PASS in 0.13s]
2017-04-19 11:00:25,630: 11:00:25 | 9 of 11 START test not_null_shippo_parcels_id........................ [RUN]
2017-04-19 11:00:25,630: Compiling test.shippo_test.not_null_shippo_parcels_id
2017-04-19 11:00:25,633: executing node test.shippo_test.not_null_shippo_parcels_id
2017-04-19 11:00:25,634: Acquiring new redshift connection "not_null_shippo_parcels_id".
2017-04-19 11:00:25,634: Re-using an available connection from the pool.
2017-04-19 11:00:25,634: Using redshift connection "not_null_shippo_parcels_id".
2017-04-19 11:00:25,634: On not_null_shippo_parcels_id: BEGIN
2017-04-19 11:00:25,655: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11296ee48>]}
2017-04-19 11:00:25,656: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:25,656: Using redshift connection "not_null_shippo_parcels_id".
2017-04-19 11:00:25,656: On not_null_shippo_parcels_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 11:00:25,695: SQL status: SELECT in 0.04 seconds
2017-04-19 11:00:25,695: On not_null_shippo_parcels_id: COMMIT
2017-04-19 11:00:25,706: 11:00:25 | 9 of 11 PASS not_null_shippo_parcels_id.............................. [PASS in 0.08s]
2017-04-19 11:00:25,706: 11:00:25 | 10 of 11 START test not_null_shippo_shipments_state.................. [RUN]
2017-04-19 11:00:25,706: Compiling test.shippo_test.not_null_shippo_shipments_state
2017-04-19 11:00:25,709: executing node test.shippo_test.not_null_shippo_shipments_state
2017-04-19 11:00:25,710: Acquiring new redshift connection "not_null_shippo_shipments_state".
2017-04-19 11:00:25,710: Re-using an available connection from the pool.
2017-04-19 11:00:25,710: Using redshift connection "not_null_shippo_shipments_state".
2017-04-19 11:00:25,710: On not_null_shippo_shipments_state: BEGIN
2017-04-19 11:00:25,732: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:25,732: Using redshift connection "not_null_shippo_shipments_state".
2017-04-19 11:00:25,732: On not_null_shippo_shipments_state: 

with validation as (

    select
        state as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 11:00:25,745: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11296ee48>]}
2017-04-19 11:00:27,902: SQL status: SELECT in 4.95 seconds
2017-04-19 11:00:27,902: On not_null_shippo_shipments_status: COMMIT
2017-04-19 11:00:27,913: 11:00:27 | 6 of 11 PASS not_null_shippo_shipments_status........................ [PASS in 4.98s]
2017-04-19 11:00:27,913: 11:00:27 | 11 of 11 START test not_null_shippo_shipments_created_at............. [RUN]
2017-04-19 11:00:27,913: Compiling test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 11:00:27,916: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11296ec18>]}
2017-04-19 11:00:27,917: executing node test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 11:00:27,918: Acquiring new redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 11:00:27,918: Re-using an available connection from the pool.
2017-04-19 11:00:27,918: Using redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 11:00:27,918: On not_null_shippo_shipments_created_at: BEGIN
2017-04-19 11:00:27,944: SQL status: BEGIN in 0.02 seconds
2017-04-19 11:00:27,944: Using redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 11:00:27,944: On not_null_shippo_shipments_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 11:00:28,127: SQL status: SELECT in 5.67 seconds
2017-04-19 11:00:28,128: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: COMMIT
2017-04-19 11:00:28,139: 11:00:28 | 1 of 11 PASS relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_ [PASS in 5.81s]
2017-04-19 11:00:28,139: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297cbe0>]}
2017-04-19 11:00:28,481: SQL status: SELECT in 2.94 seconds
2017-04-19 11:00:28,481: On unique_shippo_shipments_id: COMMIT
2017-04-19 11:00:28,493: 11:00:28 | 8 of 11 PASS unique_shippo_shipments_id.............................. [PASS in 2.99s]
2017-04-19 11:00:28,493: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297ccf8>]}
2017-04-19 11:00:29,854: SQL status: SELECT in 4.12 seconds
2017-04-19 11:00:29,854: On not_null_shippo_shipments_state: COMMIT
2017-04-19 11:00:29,865: 11:00:29 | 10 of 11 PASS not_null_shippo_shipments_state........................ [PASS in 4.16s]
2017-04-19 11:00:29,866: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297ca20>]}
2017-04-19 11:00:29,906: SQL status: SELECT in 1.96 seconds
2017-04-19 11:00:29,906: On not_null_shippo_shipments_created_at: COMMIT
2017-04-19 11:00:29,916: 11:00:29 | 11 of 11 PASS not_null_shippo_shipments_created_at................... [PASS in 2.00s]
2017-04-19 11:00:29,937: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f3544a-54cb-4800-a6a8-0ae4957362b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297ca20>]}
2017-04-19 11:00:30,043: 11:00:30 | 
2017-04-19 11:00:30,044: 11:00:30 | Finished running 11 tests in 7.71s.
2017-04-19 11:00:30,044: Connection 'master' was left open.
2017-04-19 11:00:30,045: Done. PASS=11 ERROR=0 SKIP=0 TOTAL=11
2017-04-19 11:00:30,045: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299a9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299a128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299aba8>]}
2017-04-19 11:00:30,114: Flushing usage events
2017-04-19 12:40:17,011: Tracking: tracking
2017-04-19 12:40:17,013: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b5d7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b5d6d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b5d710>]}
2017-04-19 12:40:17,162: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 12:40:17,211: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 12:40:17,213: Parsing materializations/incremental.sql
2017-04-19 12:40:17,232: Parsing materializations/table.sql
2017-04-19 12:40:17,242: Parsing materializations/view.sql
2017-04-19 12:40:17,248: Parsing materializations/wrapper.sql
2017-04-19 12:40:17,252: Parsing schema_tests/accepted_values.sql
2017-04-19 12:40:17,256: Parsing schema_tests/not_null.sql
2017-04-19 12:40:17,259: Parsing schema_tests/relationships.sql
2017-04-19 12:40:17,261: Parsing schema_tests/unique.sql
2017-04-19 12:40:17,268: Parsing model.shippo_test.shippo_addresses
2017-04-19 12:40:17,269: Parsing model.shippo_test.shippo_parcels
2017-04-19 12:40:17,271: Parsing model.shippo_test.shippo_shipments
2017-04-19 12:40:17,279: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:40:17,280: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:40:17,282: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:40:17,283: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:40:17,284: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:40:17,286: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:40:17,287: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:40:17,289: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:40:17,290: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:40:17,292: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:40:17,293: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:40:17,295: Compiled 3 models, 11 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 12:40:17,296: Acquiring new redshift connection "master".
2017-04-19 12:40:17,296: Opening a new connection (0 currently allocated)
2017-04-19 12:40:17,412: Using redshift connection "master".
2017-04-19 12:40:17,412: On master: BEGIN
2017-04-19 12:40:17,435: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:17,435: Creating schema "analytics".
2017-04-19 12:40:17,435: Using redshift connection "master".
2017-04-19 12:40:17,435: On master: create schema if not exists "analytics"
2017-04-19 12:40:17,447: SQL status: CREATE SCHEMA in 0.01 seconds
2017-04-19 12:40:17,447: On master: COMMIT
2017-04-19 12:40:19,834: Concurrency: 4 threads (target='only')
2017-04-19 12:40:19,834: Using redshift connection "master".
2017-04-19 12:40:19,835: On master: BEGIN
2017-04-19 12:40:19,855: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:19,855: Using redshift connection "master".
2017-04-19 12:40:19,855: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:40:19,884: SQL status: SELECT in 0.03 seconds
2017-04-19 12:40:19,884: On master: COMMIT
2017-04-19 12:40:19,895: 
2017-04-19 12:40:19,896: 12:40:19 | Running 3 view models
2017-04-19 12:40:19,896: 12:40:19 | 
2017-04-19 12:40:19,896: Using redshift connection "master".
2017-04-19 12:40:19,896: On master: BEGIN
2017-04-19 12:40:19,917: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:19,917: On master: COMMIT
2017-04-19 12:40:19,927: 12:40:19 | 1 of 3 START view model analytics.shippo_addresses................... [RUN]
2017-04-19 12:40:19,927: Compiling model.shippo_test.shippo_addresses
2017-04-19 12:40:19,929: Acquiring new redshift connection "shippo_addresses".
2017-04-19 12:40:19,929: 12:40:19 | 2 of 3 START view model analytics.shippo_parcels..................... [RUN]
2017-04-19 12:40:19,930: Compiling model.shippo_test.shippo_parcels
2017-04-19 12:40:19,930: Opening a new connection (1 currently allocated)
2017-04-19 12:40:19,930: 12:40:19 | 3 of 3 START view model analytics.shippo_shipments................... [RUN]
2017-04-19 12:40:19,931: Acquiring new redshift connection "shippo_parcels".
2017-04-19 12:40:19,932: Compiling model.shippo_test.shippo_shipments
2017-04-19 12:40:19,933: Acquiring new redshift connection "shippo_shipments".
2017-04-19 12:40:20,014: Using redshift connection "shippo_addresses".
2017-04-19 12:40:20,014: Opening a new connection (2 currently allocated)
2017-04-19 12:40:20,014: On shippo_addresses: BEGIN
2017-04-19 12:40:20,035: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:20,035: Using redshift connection "shippo_addresses".
2017-04-19 12:40:20,035: On shippo_addresses: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:40:20,064: SQL status: SELECT in 0.03 seconds
2017-04-19 12:40:20,066: executing node model.shippo_test.shippo_addresses
2017-04-19 12:40:20,067: Using redshift connection "shippo_addresses".
2017-04-19 12:40:20,067: On shippo_addresses: -- Compiled by DBT

    

    create view "analytics"."shippo_addresses__dbt_tmp" as (
        select

    object_id as id,

    name,
    company,

    street1,
    street2,
    street3,
    street_no,

    city,
    state,
    zip,
    country,

    email,
    phone,

    is_residential,

    object_owner,
    lower(object_purpose) as purpose,
    lower(object_source) as source,
    lower(object_state) as state,

    object_created,
    object_updated


from shippo_chooze.addresses
    );

    
2017-04-19 12:40:20,099: Using redshift connection "shippo_parcels".
2017-04-19 12:40:20,099: Opening a new connection (3 currently allocated)
2017-04-19 12:40:20,100: On shippo_parcels: BEGIN
2017-04-19 12:40:20,120: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:20,120: Using redshift connection "shippo_parcels".
2017-04-19 12:40:20,120: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:40:20,150: SQL status: SELECT in 0.03 seconds
2017-04-19 12:40:20,151: executing node model.shippo_test.shippo_parcels
2017-04-19 12:40:20,152: Using redshift connection "shippo_parcels".
2017-04-19 12:40:20,152: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 12:40:20,180: Using redshift connection "shippo_shipments".
2017-04-19 12:40:20,180: On shippo_shipments: BEGIN
2017-04-19 12:40:20,199: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:20,199: Using redshift connection "shippo_shipments".
2017-04-19 12:40:20,199: On shippo_shipments: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:40:20,230: SQL status: SELECT in 0.03 seconds
2017-04-19 12:40:20,232: executing node model.shippo_test.shippo_shipments
2017-04-19 12:40:20,233: Using redshift connection "shippo_shipments".
2017-04-19 12:40:20,233: On shippo_shipments: -- Compiled by DBT

    

    create view "analytics"."shippo_shipments__dbt_tmp" as (
        select

    object_id as id,

    address_from as address_from_id,
    address_return as address_return_id,
    address_to as address_to_id,
    parcel as parcel_id,

    insurance_amount::float,
    insurance_currency,

    rates_url,
    return_of,
    submission_date,
    lower(submission_type) as submission_type,
    customs_declaration,


    object_owner as owner,
    lower(object_state) as state,
    lower(object_purpose) as purpose,
    lower(object_status) as status,


    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments
    );

    
2017-04-19 12:40:22,011: SQL status: CREATE VIEW in 1.86 seconds
2017-04-19 12:40:22,012: On shippo_parcels: COMMIT
2017-04-19 12:40:22,021: SQL status: CREATE VIEW in 1.79 seconds
2017-04-19 12:40:22,142: Postgres error: column "state" duplicated

2017-04-19 12:40:22,142: On shippo_addresses: ROLLBACK
2017-04-19 12:40:22,152: Error executing target/build/shippo_test/shippo/base/shippo_addresses.sql
column "state" duplicated
2017-04-19 12:40:22,152: 12:40:22 | 1 of 3 ERROR creating view model analytics.shippo_addresses.......... [ERROR in 2.22s]
2017-04-19 12:40:22,152: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '503c648a-08f6-45e0-a928-e3f639a5f886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c0d780>]}
2017-04-19 12:40:22,217: Error executing target/build/shippo_test/shippo/base/shippo_addresses.sql
column "state" duplicated
2017-04-19 12:40:22,381: Using redshift connection "shippo_parcels".
2017-04-19 12:40:22,382: On shippo_parcels: BEGIN
2017-04-19 12:40:22,403: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:22,403: Using redshift connection "shippo_parcels".
2017-04-19 12:40:22,403: On shippo_parcels: drop view if exists "analytics"."shippo_parcels" cascade
2017-04-19 12:40:22,427: SQL status: DROP VIEW in 0.02 seconds
2017-04-19 12:40:22,427: On shippo_parcels: COMMIT
2017-04-19 12:40:22,995: Using redshift connection "shippo_parcels".
2017-04-19 12:40:22,995: On shippo_parcels: BEGIN
2017-04-19 12:40:23,016: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:23,016: Using redshift connection "shippo_parcels".
2017-04-19 12:40:23,016: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 12:40:23,016: On shippo_shipments: COMMIT
2017-04-19 12:40:23,031: SQL status: ALTER TABLE in 0.01 seconds
2017-04-19 12:40:23,031: On shippo_parcels: COMMIT
2017-04-19 12:40:23,853: Using redshift connection "shippo_shipments".
2017-04-19 12:40:23,853: On shippo_shipments: BEGIN
2017-04-19 12:40:23,873: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:23,873: Using redshift connection "shippo_shipments".
2017-04-19 12:40:23,874: On shippo_shipments: drop view if exists "analytics"."shippo_shipments" cascade
2017-04-19 12:40:24,096: SQL status: DROP VIEW in 0.22 seconds
2017-04-19 12:40:24,096: On shippo_shipments: COMMIT
2017-04-19 12:40:24,268: 12:40:24 | 2 of 3 OK created view model analytics.shippo_parcels................ [CREATE VIEW in 4.34s]
2017-04-19 12:40:24,269: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '503c648a-08f6-45e0-a928-e3f639a5f886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c0da90>]}
2017-04-19 12:40:24,838: Using redshift connection "shippo_shipments".
2017-04-19 12:40:24,838: On shippo_shipments: BEGIN
2017-04-19 12:40:24,858: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:24,859: Using redshift connection "shippo_shipments".
2017-04-19 12:40:24,859: On shippo_shipments: alter table "analytics"."shippo_shipments__dbt_tmp" rename to "shippo_shipments"
2017-04-19 12:40:24,872: SQL status: ALTER TABLE in 0.01 seconds
2017-04-19 12:40:24,872: On shippo_shipments: COMMIT
2017-04-19 12:40:25,234: 12:40:25 | 3 of 3 OK created view model analytics.shippo_shipments.............. [CREATE VIEW in 5.30s]
2017-04-19 12:40:25,234: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '503c648a-08f6-45e0-a928-e3f639a5f886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c0dbe0>]}
2017-04-19 12:40:25,335: Using redshift connection "master".
2017-04-19 12:40:25,335: On master: BEGIN
2017-04-19 12:40:25,356: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:25,356: On master: COMMIT
2017-04-19 12:40:25,367: 12:40:25 | 
2017-04-19 12:40:25,367: 12:40:25 | Finished running 3 view models in 5.47s.
2017-04-19 12:40:25,367: Connection 'master' was left open.
2017-04-19 12:40:25,368: Done. PASS=2 ERROR=1 SKIP=0 TOTAL=3
2017-04-19 12:40:25,368: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae9f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c11780>]}
2017-04-19 12:40:25,435: Flushing usage events
2017-04-19 12:40:52,416: Tracking: tracking
2017-04-19 12:40:52,416: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123d02e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123d0828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123d0978>]}
2017-04-19 12:40:52,518: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 12:40:52,562: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 12:40:52,563: Parsing materializations/incremental.sql
2017-04-19 12:40:52,580: Parsing materializations/table.sql
2017-04-19 12:40:52,588: Parsing materializations/view.sql
2017-04-19 12:40:52,592: Parsing materializations/wrapper.sql
2017-04-19 12:40:52,595: Parsing schema_tests/accepted_values.sql
2017-04-19 12:40:52,597: Parsing schema_tests/not_null.sql
2017-04-19 12:40:52,599: Parsing schema_tests/relationships.sql
2017-04-19 12:40:52,600: Parsing schema_tests/unique.sql
2017-04-19 12:40:52,605: Parsing model.shippo_test.shippo_addresses
2017-04-19 12:40:52,606: Parsing model.shippo_test.shippo_parcels
2017-04-19 12:40:52,607: Parsing model.shippo_test.shippo_shipments
2017-04-19 12:40:52,616: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:40:52,617: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:40:52,618: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:40:52,619: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:40:52,620: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:40:52,622: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:40:52,623: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:40:52,624: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:40:52,625: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:40:52,626: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:40:52,627: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:40:52,629: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:40:52,630: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:40:52,631: Parsing test.shippo_test.not_null_shippo_addresses_state
2017-04-19 12:40:52,633: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:40:52,634: Parsing test.shippo_test.not_null_shippo_addresses_status
2017-04-19 12:40:52,635: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:40:52,636: Parsing test.shippo_test.relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:40:52,638: Compiled 3 models, 18 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 12:40:52,638: Acquiring new redshift connection "master".
2017-04-19 12:40:52,639: Opening a new connection (0 currently allocated)
2017-04-19 12:40:52,729: Using redshift connection "master".
2017-04-19 12:40:52,730: On master: BEGIN
2017-04-19 12:40:52,752: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:52,752: Creating schema "analytics".
2017-04-19 12:40:52,753: Using redshift connection "master".
2017-04-19 12:40:52,753: On master: create schema if not exists "analytics"
2017-04-19 12:40:52,764: SQL status: CREATE SCHEMA in 0.01 seconds
2017-04-19 12:40:52,764: On master: COMMIT
2017-04-19 12:40:53,102: Concurrency: 4 threads (target='only')
2017-04-19 12:40:53,102: Using redshift connection "master".
2017-04-19 12:40:53,102: On master: BEGIN
2017-04-19 12:40:53,125: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:53,125: Using redshift connection "master".
2017-04-19 12:40:53,125: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:40:53,158: SQL status: SELECT in 0.03 seconds
2017-04-19 12:40:53,158: On master: COMMIT
2017-04-19 12:40:53,171: 
2017-04-19 12:40:53,172: 12:40:53 | Running 3 view models
2017-04-19 12:40:53,172: 12:40:53 | 
2017-04-19 12:40:53,172: Using redshift connection "master".
2017-04-19 12:40:53,172: On master: BEGIN
2017-04-19 12:40:53,193: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:53,194: On master: COMMIT
2017-04-19 12:40:53,205: 12:40:53 | 1 of 3 START view model analytics.shippo_addresses................... [RUN]
2017-04-19 12:40:53,205: Compiling model.shippo_test.shippo_addresses
2017-04-19 12:40:53,208: Acquiring new redshift connection "shippo_addresses".
2017-04-19 12:40:53,208: Opening a new connection (1 currently allocated)
2017-04-19 12:40:53,208: 12:40:53 | 2 of 3 START view model analytics.shippo_shipments................... [RUN]
2017-04-19 12:40:53,208: Compiling model.shippo_test.shippo_shipments
2017-04-19 12:40:53,210: Acquiring new redshift connection "shippo_shipments".
2017-04-19 12:40:53,210: 12:40:53 | 3 of 3 START view model analytics.shippo_parcels..................... [RUN]
2017-04-19 12:40:53,210: Compiling model.shippo_test.shippo_parcels
2017-04-19 12:40:53,212: Acquiring new redshift connection "shippo_parcels".
2017-04-19 12:40:53,300: Using redshift connection "shippo_addresses".
2017-04-19 12:40:53,300: On shippo_addresses: BEGIN
2017-04-19 12:40:53,300: Opening a new connection (2 currently allocated)
2017-04-19 12:40:53,321: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:53,321: Using redshift connection "shippo_addresses".
2017-04-19 12:40:53,321: On shippo_addresses: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:40:53,354: SQL status: SELECT in 0.03 seconds
2017-04-19 12:40:53,356: executing node model.shippo_test.shippo_addresses
2017-04-19 12:40:53,357: Using redshift connection "shippo_addresses".
2017-04-19 12:40:53,357: On shippo_addresses: -- Compiled by DBT

    

    create view "analytics"."shippo_addresses__dbt_tmp" as (
        select

    object_id as id,

    name,
    company,

    street1,
    street2,
    street3,
    street_no,

    city,
    state,
    zip,
    country,

    email,
    phone,

    is_residential,

    object_owner,
    lower(object_purpose) as purpose,
    lower(object_source) as source,
    lower(object_state) as object_state,

    object_created,
    object_updated


from shippo_chooze.addresses
    );

    
2017-04-19 12:40:53,383: SQL status: CREATE VIEW in 0.03 seconds
2017-04-19 12:40:53,383: Using redshift connection "shippo_addresses".
2017-04-19 12:40:53,383: On shippo_addresses: alter table "analytics"."shippo_addresses__dbt_tmp" rename to "shippo_addresses"
2017-04-19 12:40:53,387: Using redshift connection "shippo_shipments".
2017-04-19 12:40:53,387: On shippo_shipments: BEGIN
2017-04-19 12:40:53,388: Opening a new connection (3 currently allocated)
2017-04-19 12:40:53,394: SQL status: ALTER TABLE in 0.01 seconds
2017-04-19 12:40:53,395: On shippo_addresses: COMMIT
2017-04-19 12:40:53,408: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:53,408: Using redshift connection "shippo_shipments".
2017-04-19 12:40:53,409: On shippo_shipments: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:40:53,440: SQL status: SELECT in 0.03 seconds
2017-04-19 12:40:53,442: executing node model.shippo_test.shippo_shipments
2017-04-19 12:40:53,444: Using redshift connection "shippo_shipments".
2017-04-19 12:40:53,444: On shippo_shipments: -- Compiled by DBT

    

    create view "analytics"."shippo_shipments__dbt_tmp" as (
        select

    object_id as id,

    address_from as address_from_id,
    address_return as address_return_id,
    address_to as address_to_id,
    parcel as parcel_id,

    insurance_amount::float,
    insurance_currency,

    rates_url,
    return_of,
    submission_date,
    lower(submission_type) as submission_type,
    customs_declaration,


    object_owner as owner,
    lower(object_state) as state,
    lower(object_purpose) as purpose,
    lower(object_status) as status,


    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments
    );

    
2017-04-19 12:40:53,459: SQL status: CREATE VIEW in 0.01 seconds
2017-04-19 12:40:53,459: On shippo_shipments: COMMIT
2017-04-19 12:40:53,485: Using redshift connection "shippo_parcels".
2017-04-19 12:40:53,485: On shippo_parcels: BEGIN
2017-04-19 12:40:53,507: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:53,507: Using redshift connection "shippo_parcels".
2017-04-19 12:40:53,507: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:40:53,538: SQL status: SELECT in 0.03 seconds
2017-04-19 12:40:53,541: executing node model.shippo_test.shippo_parcels
2017-04-19 12:40:53,542: Using redshift connection "shippo_parcels".
2017-04-19 12:40:53,542: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 12:40:54,125: SQL status: CREATE VIEW in 0.58 seconds
2017-04-19 12:40:54,141: 12:40:54 | 1 of 3 OK created view model analytics.shippo_addresses.............. [CREATE VIEW in 0.94s]
2017-04-19 12:40:54,142: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c43d22-115f-4e09-b74f-dd1edaad25b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b59b0>]}
2017-04-19 12:40:54,637: Using redshift connection "shippo_shipments".
2017-04-19 12:40:54,637: On shippo_shipments: BEGIN
2017-04-19 12:40:54,659: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:54,660: Using redshift connection "shippo_shipments".
2017-04-19 12:40:54,660: On shippo_shipments: drop view if exists "analytics"."shippo_shipments" cascade
2017-04-19 12:40:54,675: SQL status: DROP VIEW in 0.02 seconds
2017-04-19 12:40:54,675: On shippo_shipments: COMMIT
2017-04-19 12:40:54,984: Using redshift connection "shippo_shipments".
2017-04-19 12:40:54,984: On shippo_shipments: BEGIN
2017-04-19 12:40:55,004: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:55,004: Using redshift connection "shippo_shipments".
2017-04-19 12:40:55,004: On shippo_shipments: alter table "analytics"."shippo_shipments__dbt_tmp" rename to "shippo_shipments"
2017-04-19 12:40:55,004: On shippo_parcels: COMMIT
2017-04-19 12:40:55,035: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 12:40:55,035: On shippo_shipments: COMMIT
2017-04-19 12:40:55,661: Using redshift connection "shippo_parcels".
2017-04-19 12:40:55,661: On shippo_parcels: BEGIN
2017-04-19 12:40:55,683: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:55,684: Using redshift connection "shippo_parcels".
2017-04-19 12:40:55,684: On shippo_parcels: drop view if exists "analytics"."shippo_parcels" cascade
2017-04-19 12:40:55,805: 12:40:55 | 2 of 3 OK created view model analytics.shippo_shipments.............. [CREATE VIEW in 2.60s]
2017-04-19 12:40:55,805: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c43d22-115f-4e09-b74f-dd1edaad25b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b8a58>]}
2017-04-19 12:40:55,807: SQL status: DROP VIEW in 0.12 seconds
2017-04-19 12:40:55,807: On shippo_parcels: COMMIT
2017-04-19 12:40:56,386: Using redshift connection "shippo_parcels".
2017-04-19 12:40:56,386: On shippo_parcels: BEGIN
2017-04-19 12:40:56,410: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:40:56,410: Using redshift connection "shippo_parcels".
2017-04-19 12:40:56,410: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 12:40:56,424: SQL status: ALTER TABLE in 0.01 seconds
2017-04-19 12:40:56,425: On shippo_parcels: COMMIT
2017-04-19 12:40:56,889: 12:40:56 | 3 of 3 OK created view model analytics.shippo_parcels................ [CREATE VIEW in 3.68s]
2017-04-19 12:40:56,890: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c43d22-115f-4e09-b74f-dd1edaad25b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b8b00>]}
2017-04-19 12:40:57,005: Using redshift connection "master".
2017-04-19 12:40:57,005: On master: BEGIN
2017-04-19 12:40:57,031: SQL status: BEGIN in 0.03 seconds
2017-04-19 12:40:57,032: On master: COMMIT
2017-04-19 12:40:57,043: 12:40:57 | 
2017-04-19 12:40:57,043: 12:40:57 | Finished running 3 view models in 3.87s.
2017-04-19 12:40:57,044: Connection 'master' was left open.
2017-04-19 12:40:57,044: Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2017-04-19 12:40:57,044: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112365d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112365f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123aa9b0>]}
2017-04-19 12:40:57,108: Flushing usage events
2017-04-19 12:42:50,501: Tracking: tracking
2017-04-19 12:42:50,501: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e77b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e7c18>]}
2017-04-19 12:42:50,619: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 12:42:50,664: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 12:42:50,665: Parsing materializations/incremental.sql
2017-04-19 12:42:50,684: Parsing materializations/table.sql
2017-04-19 12:42:50,692: Parsing materializations/view.sql
2017-04-19 12:42:50,696: Parsing materializations/wrapper.sql
2017-04-19 12:42:50,699: Parsing schema_tests/accepted_values.sql
2017-04-19 12:42:50,701: Parsing schema_tests/not_null.sql
2017-04-19 12:42:50,702: Parsing schema_tests/relationships.sql
2017-04-19 12:42:50,704: Parsing schema_tests/unique.sql
2017-04-19 12:42:50,709: Parsing model.shippo_test.shippo_addresses
2017-04-19 12:42:50,710: Parsing model.shippo_test.shippo_parcels
2017-04-19 12:42:50,711: Parsing model.shippo_test.shippo_shipments
2017-04-19 12:42:50,721: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:42:50,722: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:42:50,723: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:42:50,725: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:42:50,726: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:42:50,727: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:42:50,728: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:42:50,730: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:42:50,731: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:42:50,732: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:42:50,733: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:42:50,735: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 12:42:50,736: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 12:42:50,738: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 12:42:50,739: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:42:50,741: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:42:50,743: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 12:42:50,744: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:42:50,745: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 12:42:50,746: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:42:50,748: Parsing test.shippo_test.relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:42:50,750: Compiled 3 models, 21 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 12:42:50,752: Acquiring new redshift connection "master".
2017-04-19 12:42:50,752: Opening a new connection (0 currently allocated)
2017-04-19 12:42:50,915: Using redshift connection "master".
2017-04-19 12:42:50,916: On master: BEGIN
2017-04-19 12:42:50,939: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:50,939: Creating schema "analytics".
2017-04-19 12:42:50,939: Using redshift connection "master".
2017-04-19 12:42:50,939: On master: create schema if not exists "analytics"
2017-04-19 12:42:50,951: SQL status: CREATE SCHEMA in 0.01 seconds
2017-04-19 12:42:50,951: On master: COMMIT
2017-04-19 12:42:51,239: Concurrency: 4 threads (target='only')
2017-04-19 12:42:51,240: Using redshift connection "master".
2017-04-19 12:42:51,240: On master: BEGIN
2017-04-19 12:42:51,264: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:51,264: Using redshift connection "master".
2017-04-19 12:42:51,264: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:42:51,305: SQL status: SELECT in 0.04 seconds
2017-04-19 12:42:51,305: On master: COMMIT
2017-04-19 12:42:51,318: 
2017-04-19 12:42:51,318: 12:42:51 | Running 21 tests
2017-04-19 12:42:51,318: 12:42:51 | 
2017-04-19 12:42:51,318: 12:42:51 | 1 of 21 START test unique_shippo_addresses_id........................ [RUN]
2017-04-19 12:42:51,319: Compiling test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:42:51,320: 12:42:51 | 2 of 21 START test not_null_shippo_shipments_purpose................. [RUN]
2017-04-19 12:42:51,320: 12:42:51 | 3 of 21 START test relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_ [RUN]
2017-04-19 12:42:51,320: Compiling test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:42:51,320: 12:42:51 | 4 of 21 START test unique_shippo_shipments_id........................ [RUN]
2017-04-19 12:42:51,321: Compiling test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 12:42:51,326: Compiling test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:42:51,330: executing node test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:42:51,331: Acquiring new redshift connection "unique_shippo_addresses_id".
2017-04-19 12:42:51,331: Opening a new connection (1 currently allocated)
2017-04-19 12:42:51,331: executing node test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:42:51,331: executing node test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 12:42:51,332: Acquiring new redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 12:42:51,332: executing node test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:42:51,333: Acquiring new redshift connection "relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_".
2017-04-19 12:42:51,333: Acquiring new redshift connection "unique_shippo_shipments_id".
2017-04-19 12:42:51,419: Using redshift connection "unique_shippo_addresses_id".
2017-04-19 12:42:51,419: On unique_shippo_addresses_id: BEGIN
2017-04-19 12:42:51,419: Opening a new connection (2 currently allocated)
2017-04-19 12:42:51,442: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:51,442: Using redshift connection "unique_shippo_addresses_id".
2017-04-19 12:42:51,442: On unique_shippo_addresses_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_addresses"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 12:42:51,548: Using redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 12:42:51,549: On not_null_shippo_shipments_purpose: BEGIN
2017-04-19 12:42:51,549: Opening a new connection (3 currently allocated)
2017-04-19 12:42:51,570: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:51,570: Using redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 12:42:51,571: On not_null_shippo_shipments_purpose: 

with validation as (

    select
        purpose as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:42:51,624: SQL status: SELECT in 0.05 seconds
2017-04-19 12:42:51,624: On not_null_shippo_shipments_purpose: COMMIT
2017-04-19 12:42:51,683: Using redshift connection "relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_".
2017-04-19 12:42:51,683: Opening a new connection (4 currently allocated)
2017-04-19 12:42:51,683: On relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_: BEGIN
2017-04-19 12:42:51,705: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:51,706: Using redshift connection "relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_".
2017-04-19 12:42:51,706: On relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_addresses"

),

child as (

    select
        address_from_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:42:51,776: Using redshift connection "unique_shippo_shipments_id".
2017-04-19 12:42:51,777: 12:42:51 | 2 of 21 PASS not_null_shippo_shipments_purpose....................... [PASS in 0.46s]
2017-04-19 12:42:51,777: On unique_shippo_shipments_id: BEGIN
2017-04-19 12:42:51,777: 12:42:51 | 5 of 21 START test not_null_shippo_addresses_source.................. [RUN]
2017-04-19 12:42:51,778: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b8978>]}
2017-04-19 12:42:51,778: Compiling test.shippo_test.not_null_shippo_addresses_source
2017-04-19 12:42:51,783: executing node test.shippo_test.not_null_shippo_addresses_source
2017-04-19 12:42:51,783: Acquiring new redshift connection "not_null_shippo_addresses_source".
2017-04-19 12:42:51,783: Re-using an available connection from the pool.
2017-04-19 12:42:51,783: Using redshift connection "not_null_shippo_addresses_source".
2017-04-19 12:42:51,784: On not_null_shippo_addresses_source: BEGIN
2017-04-19 12:42:51,799: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:51,799: Using redshift connection "unique_shippo_shipments_id".
2017-04-19 12:42:51,799: On unique_shippo_shipments_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_shipments"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 12:42:51,804: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:51,805: Using redshift connection "not_null_shippo_addresses_source".
2017-04-19 12:42:51,805: On not_null_shippo_addresses_source: 

with validation as (

    select
        source as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:42:52,007: SQL status: SELECT in 0.21 seconds
2017-04-19 12:42:52,007: On unique_shippo_shipments_id: COMMIT
2017-04-19 12:42:52,018: 12:42:52 | 4 of 21 PASS unique_shippo_shipments_id.............................. [PASS in 0.70s]
2017-04-19 12:42:52,018: 12:42:52 | 6 of 21 START test not_null_shippo_addresses_object_state............ [RUN]
2017-04-19 12:42:52,018: Compiling test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 12:42:52,018: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b8240>]}
2017-04-19 12:42:52,022: executing node test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 12:42:52,023: Acquiring new redshift connection "not_null_shippo_addresses_object_state".
2017-04-19 12:42:52,023: Re-using an available connection from the pool.
2017-04-19 12:42:52,023: Using redshift connection "not_null_shippo_addresses_object_state".
2017-04-19 12:42:52,023: On not_null_shippo_addresses_object_state: BEGIN
2017-04-19 12:42:52,044: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:52,044: Using redshift connection "not_null_shippo_addresses_object_state".
2017-04-19 12:42:52,044: On not_null_shippo_addresses_object_state: 

with validation as (

    select
        object_state as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:42:54,649: SQL status: SELECT in 3.21 seconds
2017-04-19 12:42:54,650: On unique_shippo_addresses_id: COMMIT
2017-04-19 12:42:54,660: 12:42:54 | 1 of 21 PASS unique_shippo_addresses_id.............................. [PASS in 3.34s]
2017-04-19 12:42:54,661: 12:42:54 | 7 of 21 START test unique_shippo_parcels_id.......................... [RUN]
2017-04-19 12:42:54,661: Compiling test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:42:54,663: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b8860>]}
2017-04-19 12:42:54,665: executing node test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:42:54,666: Acquiring new redshift connection "unique_shippo_parcels_id".
2017-04-19 12:42:54,666: Re-using an available connection from the pool.
2017-04-19 12:42:54,666: Using redshift connection "unique_shippo_parcels_id".
2017-04-19 12:42:54,666: On unique_shippo_parcels_id: BEGIN
2017-04-19 12:42:54,688: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:54,688: Using redshift connection "unique_shippo_parcels_id".
2017-04-19 12:42:54,688: On unique_shippo_parcels_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_parcels"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 12:42:55,981: SQL status: SELECT in 1.29 seconds
2017-04-19 12:42:55,981: On unique_shippo_parcels_id: COMMIT
2017-04-19 12:42:55,992: 12:42:55 | 7 of 21 PASS unique_shippo_parcels_id................................ [PASS in 1.33s]
2017-04-19 12:42:55,992: 12:42:55 | 8 of 21 START test relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_ [RUN]
2017-04-19 12:42:55,992: Compiling test.shippo_test.relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:42:55,995: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cfe48>]}
2017-04-19 12:42:55,997: executing node test.shippo_test.relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:42:55,998: Acquiring new redshift connection "relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:42:55,998: Re-using an available connection from the pool.
2017-04-19 12:42:55,998: Using redshift connection "relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:42:55,998: On relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_: BEGIN
2017-04-19 12:42:56,019: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:56,019: Using redshift connection "relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:42:56,019: On relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_parcels"

),

child as (

    select
        parcel_id as id

    from "analytics"."shippo_addresses"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:42:56,031: Postgres error: column "parcel_id" does not exist in shippo_addresses

2017-04-19 12:42:56,031: On relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_: ROLLBACK
2017-04-19 12:42:56,041: Error executing target/build/shippo_test/shippo/base/schema_test/relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_.sql
column "parcel_id" does not exist in shippo_addresses
2017-04-19 12:42:56,041: 12:42:56 | 8 of 21 ERROR relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_ [ERROR in 0.05s]
2017-04-19 12:42:56,041: 12:42:56 | 9 of 21 START test not_null_shippo_addresses_id...................... [RUN]
2017-04-19 12:42:56,041: Compiling test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:42:56,043: executing node test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:42:56,044: Acquiring new redshift connection "not_null_shippo_addresses_id".
2017-04-19 12:42:56,044: Re-using an available connection from the pool.
2017-04-19 12:42:56,044: Using redshift connection "not_null_shippo_addresses_id".
2017-04-19 12:42:56,044: On not_null_shippo_addresses_id: BEGIN
2017-04-19 12:42:56,065: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:56,065: Using redshift connection "not_null_shippo_addresses_id".
2017-04-19 12:42:56,066: On not_null_shippo_addresses_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:42:56,092: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cfe48>]}
2017-04-19 12:42:56,227: Error executing target/build/shippo_test/shippo/base/schema_test/relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_.sql
column "parcel_id" does not exist in shippo_addresses
2017-04-19 12:42:57,312: SQL status: SELECT in 5.51 seconds
2017-04-19 12:42:57,312: On not_null_shippo_addresses_source: COMMIT
2017-04-19 12:42:57,324: 12:42:57 | 5 of 21 PASS not_null_shippo_addresses_source........................ [PASS in 5.55s]
2017-04-19 12:42:57,324: 12:42:57 | 10 of 21 START test relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_ [RUN]
2017-04-19 12:42:57,324: Compiling test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 12:42:57,327: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cf0b8>]}
2017-04-19 12:42:57,329: executing node test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 12:42:57,330: Acquiring new redshift connection "relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_".
2017-04-19 12:42:57,330: Re-using an available connection from the pool.
2017-04-19 12:42:57,330: Using redshift connection "relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_".
2017-04-19 12:42:57,330: On relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_: BEGIN
2017-04-19 12:42:57,353: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:57,353: Using redshift connection "relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_".
2017-04-19 12:42:57,353: On relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_addresses"

),

child as (

    select
        address_to_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:42:57,379: SQL status: SELECT in 5.33 seconds
2017-04-19 12:42:57,379: On not_null_shippo_addresses_object_state: COMMIT
2017-04-19 12:42:57,390: 12:42:57 | 6 of 21 PASS not_null_shippo_addresses_object_state.................. [PASS in 5.37s]
2017-04-19 12:42:57,390: 12:42:57 | 11 of 21 START test not_null_shippo_parcels_id....................... [RUN]
2017-04-19 12:42:57,390: Compiling test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:42:57,393: executing node test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:42:57,394: Acquiring new redshift connection "not_null_shippo_parcels_id".
2017-04-19 12:42:57,394: Re-using an available connection from the pool.
2017-04-19 12:42:57,394: Using redshift connection "not_null_shippo_parcels_id".
2017-04-19 12:42:57,394: On not_null_shippo_parcels_id: BEGIN
2017-04-19 12:42:57,397: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cf0b8>]}
2017-04-19 12:42:57,415: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:57,415: Using redshift connection "not_null_shippo_parcels_id".
2017-04-19 12:42:57,415: On not_null_shippo_parcels_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:42:57,500: SQL status: SELECT in 0.08 seconds
2017-04-19 12:42:57,500: On not_null_shippo_parcels_id: COMMIT
2017-04-19 12:42:57,511: 12:42:57 | 11 of 21 PASS not_null_shippo_parcels_id............................. [PASS in 0.12s]
2017-04-19 12:42:57,511: 12:42:57 | 12 of 21 START test not_null_shippo_addresses_created_at............. [RUN]
2017-04-19 12:42:57,511: Compiling test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:42:57,514: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cfe10>]}
2017-04-19 12:42:57,515: executing node test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:42:57,516: Acquiring new redshift connection "not_null_shippo_addresses_created_at".
2017-04-19 12:42:57,516: Re-using an available connection from the pool.
2017-04-19 12:42:57,516: Using redshift connection "not_null_shippo_addresses_created_at".
2017-04-19 12:42:57,516: On not_null_shippo_addresses_created_at: BEGIN
2017-04-19 12:42:57,537: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:57,537: Using redshift connection "not_null_shippo_addresses_created_at".
2017-04-19 12:42:57,537: On not_null_shippo_addresses_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:42:57,548: Postgres error: column "created_at" does not exist in shippo_addresses

2017-04-19 12:42:57,548: On not_null_shippo_addresses_created_at: ROLLBACK
2017-04-19 12:42:57,558: Error executing target/build/shippo_test/shippo/base/schema_test/not_null_shippo_addresses_created_at.sql
column "created_at" does not exist in shippo_addresses
2017-04-19 12:42:57,558: 12:42:57 | 12 of 21 ERROR not_null_shippo_addresses_created_at.................. [ERROR in 0.05s]
2017-04-19 12:42:57,559: 12:42:57 | 13 of 21 START test not_null_shippo_parcels_state.................... [RUN]
2017-04-19 12:42:57,559: Compiling test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:42:57,560: executing node test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:42:57,561: Acquiring new redshift connection "not_null_shippo_parcels_state".
2017-04-19 12:42:57,561: Re-using an available connection from the pool.
2017-04-19 12:42:57,561: Using redshift connection "not_null_shippo_parcels_state".
2017-04-19 12:42:57,561: On not_null_shippo_parcels_state: BEGIN
2017-04-19 12:42:57,583: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:57,584: Using redshift connection "not_null_shippo_parcels_state".
2017-04-19 12:42:57,584: On not_null_shippo_parcels_state: 

with validation as (

    select
        state as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:42:57,593: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cfe10>]}
2017-04-19 12:42:57,650: SQL status: SELECT in 0.07 seconds
2017-04-19 12:42:57,650: On not_null_shippo_parcels_state: COMMIT
2017-04-19 12:42:57,659: Error executing target/build/shippo_test/shippo/base/schema_test/not_null_shippo_addresses_created_at.sql
column "created_at" does not exist in shippo_addresses
2017-04-19 12:42:57,661: 12:42:57 | 13 of 21 PASS not_null_shippo_parcels_state.......................... [PASS in 0.10s]
2017-04-19 12:42:57,661: 12:42:57 | 14 of 21 START test not_null_shippo_shipments_id..................... [RUN]
2017-04-19 12:42:57,661: Compiling test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:42:57,663: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e1c18>]}
2017-04-19 12:42:57,665: executing node test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:42:57,666: Acquiring new redshift connection "not_null_shippo_shipments_id".
2017-04-19 12:42:57,666: Re-using an available connection from the pool.
2017-04-19 12:42:57,666: Using redshift connection "not_null_shippo_shipments_id".
2017-04-19 12:42:57,666: On not_null_shippo_shipments_id: BEGIN
2017-04-19 12:42:57,686: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:57,687: Using redshift connection "not_null_shippo_shipments_id".
2017-04-19 12:42:57,687: On not_null_shippo_shipments_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:42:57,755: SQL status: SELECT in 0.07 seconds
2017-04-19 12:42:57,755: On not_null_shippo_shipments_id: COMMIT
2017-04-19 12:42:57,766: 12:42:57 | 14 of 21 PASS not_null_shippo_shipments_id........................... [PASS in 0.10s]
2017-04-19 12:42:57,766: 12:42:57 | 15 of 21 START test relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_ [RUN]
2017-04-19 12:42:57,766: Compiling test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 12:42:57,769: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e15c0>]}
2017-04-19 12:42:57,771: executing node test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 12:42:57,772: Acquiring new redshift connection "relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_".
2017-04-19 12:42:57,772: Re-using an available connection from the pool.
2017-04-19 12:42:57,772: Using redshift connection "relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_".
2017-04-19 12:42:57,772: On relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_: BEGIN
2017-04-19 12:42:57,795: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:42:57,795: Using redshift connection "relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_".
2017-04-19 12:42:57,795: On relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_addresses"

),

child as (

    select
        address_return_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:43:00,384: SQL status: SELECT in 4.32 seconds
2017-04-19 12:43:00,384: On not_null_shippo_addresses_id: COMMIT
2017-04-19 12:43:00,395: 12:43:00 | 9 of 21 PASS not_null_shippo_addresses_id............................ [PASS in 4.35s]
2017-04-19 12:43:00,396: 12:43:00 | 16 of 21 START test not_null_shippo_shipments_created_at............. [RUN]
2017-04-19 12:43:00,396: Compiling test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:43:00,398: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e16d8>]}
2017-04-19 12:43:00,400: executing node test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:43:00,400: Acquiring new redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 12:43:00,401: Re-using an available connection from the pool.
2017-04-19 12:43:00,401: Using redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 12:43:00,401: On not_null_shippo_shipments_created_at: BEGIN
2017-04-19 12:43:00,422: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:43:00,422: Using redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 12:43:00,422: On not_null_shippo_shipments_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:43:00,467: SQL status: SELECT in 0.04 seconds
2017-04-19 12:43:00,467: On not_null_shippo_shipments_created_at: COMMIT
2017-04-19 12:43:00,478: 12:43:00 | 16 of 21 PASS not_null_shippo_shipments_created_at................... [PASS in 0.08s]
2017-04-19 12:43:00,478: 12:43:00 | 17 of 21 START test not_null_shippo_shipments_status................. [RUN]
2017-04-19 12:43:00,478: Compiling test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:43:00,480: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e1438>]}
2017-04-19 12:43:00,482: executing node test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:43:00,482: Acquiring new redshift connection "not_null_shippo_shipments_status".
2017-04-19 12:43:00,483: Re-using an available connection from the pool.
2017-04-19 12:43:00,483: Using redshift connection "not_null_shippo_shipments_status".
2017-04-19 12:43:00,483: On not_null_shippo_shipments_status: BEGIN
2017-04-19 12:43:00,505: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:43:00,505: Using redshift connection "not_null_shippo_shipments_status".
2017-04-19 12:43:00,505: On not_null_shippo_shipments_status: 

with validation as (

    select
        status as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:43:00,576: SQL status: SELECT in 0.07 seconds
2017-04-19 12:43:00,576: On not_null_shippo_shipments_status: COMMIT
2017-04-19 12:43:00,588: 12:43:00 | 17 of 21 PASS not_null_shippo_shipments_status....................... [PASS in 0.11s]
2017-04-19 12:43:00,589: 12:43:00 | 18 of 21 START test not_null_shippo_addresses_purpose................ [RUN]
2017-04-19 12:43:00,589: Compiling test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:43:00,591: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e14a8>]}
2017-04-19 12:43:00,593: executing node test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:43:00,594: Acquiring new redshift connection "not_null_shippo_addresses_purpose".
2017-04-19 12:43:00,594: Re-using an available connection from the pool.
2017-04-19 12:43:00,594: Using redshift connection "not_null_shippo_addresses_purpose".
2017-04-19 12:43:00,594: On not_null_shippo_addresses_purpose: BEGIN
2017-04-19 12:43:00,615: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:43:00,615: Using redshift connection "not_null_shippo_addresses_purpose".
2017-04-19 12:43:00,616: On not_null_shippo_addresses_purpose: 

with validation as (

    select
        purpose as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:43:04,582: SQL status: SELECT in 6.79 seconds
2017-04-19 12:43:04,582: On relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_: COMMIT
2017-04-19 12:43:04,583: SQL status: SELECT in 12.88 seconds
2017-04-19 12:43:04,583: On relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_: COMMIT
2017-04-19 12:43:04,583: SQL status: SELECT in 7.23 seconds
2017-04-19 12:43:04,583: On relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_: COMMIT
2017-04-19 12:43:04,595: 12:43:04 | 15 of 21 FAIL 36 relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_ [FAIL 36 in 6.83s]
2017-04-19 12:43:04,595: 12:43:04 | 19 of 21 START test not_null_shippo_shipments_state.................. [RUN]
2017-04-19 12:43:04,595: Compiling test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:43:04,595: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e14e0>]}
2017-04-19 12:43:04,597: 12:43:04 | 3 of 21 FAIL 36 relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_ [FAIL 36 in 13.28s]
2017-04-19 12:43:04,599: 12:43:04 | 10 of 21 FAIL 36 relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_ [FAIL 36 in 7.28s]
2017-04-19 12:43:04,599: 12:43:04 | 20 of 21 START test relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_ [RUN]
2017-04-19 12:43:04,600: 12:43:04 | 21 of 21 START test not_null_shippo_parcels_created_at............... [RUN]
2017-04-19 12:43:04,601: Compiling test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:43:04,601: Compiling test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:43:04,601: executing node test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:43:04,605: Acquiring new redshift connection "not_null_shippo_shipments_state".
2017-04-19 12:43:04,605: Re-using an available connection from the pool.
2017-04-19 12:43:04,605: Using redshift connection "not_null_shippo_shipments_state".
2017-04-19 12:43:04,606: On not_null_shippo_shipments_state: BEGIN
2017-04-19 12:43:04,606: executing node test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:43:04,606: Acquiring new redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 12:43:04,606: Re-using an available connection from the pool.
2017-04-19 12:43:04,607: Using redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 12:43:04,607: On not_null_shippo_parcels_created_at: BEGIN
2017-04-19 12:43:04,607: executing node test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:43:04,607: Acquiring new redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:43:04,607: Re-using an available connection from the pool.
2017-04-19 12:43:04,607: Using redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:43:04,608: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: BEGIN
2017-04-19 12:43:04,627: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:43:04,627: Using redshift connection "not_null_shippo_shipments_state".
2017-04-19 12:43:04,627: On not_null_shippo_shipments_state: 

with validation as (

    select
        state as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:43:04,629: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:43:04,629: Using redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 12:43:04,630: On not_null_shippo_parcels_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:43:04,631: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:43:04,631: Using redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:43:04,631: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_parcels"

),

child as (

    select
        parcel_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:43:04,680: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e14e0>]}
2017-04-19 12:43:04,701: SQL status: SELECT in 0.07 seconds
2017-04-19 12:43:04,702: On not_null_shippo_shipments_state: COMMIT
2017-04-19 12:43:04,712: 12:43:04 | 19 of 21 PASS not_null_shippo_shipments_state........................ [PASS in 0.12s]
2017-04-19 12:43:04,739: SQL status: SELECT in 0.11 seconds
2017-04-19 12:43:04,739: On not_null_shippo_parcels_created_at: COMMIT
2017-04-19 12:43:04,744: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26ef60>]}
2017-04-19 12:43:04,749: 12:43:04 | 21 of 21 PASS not_null_shippo_parcels_created_at..................... [PASS in 0.15s]
2017-04-19 12:43:04,784: SQL status: SELECT in 0.15 seconds
2017-04-19 12:43:04,784: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: COMMIT
2017-04-19 12:43:04,795: 12:43:04 | 20 of 21 FAIL 21 relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_ [FAIL 21 in 0.20s]
2017-04-19 12:43:04,813: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26ef60>]}
2017-04-19 12:43:04,883: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26ef60>]}
2017-04-19 12:43:04,955: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26ef60>]}
2017-04-19 12:43:05,401: SQL status: SELECT in 4.79 seconds
2017-04-19 12:43:05,402: On not_null_shippo_addresses_purpose: COMMIT
2017-04-19 12:43:05,412: 12:43:05 | 18 of 21 PASS not_null_shippo_addresses_purpose...................... [PASS in 4.82s]
2017-04-19 12:43:05,412: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210ef9b3-66d0-4461-b57c-cfb6bc2d6e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26eda0>]}
2017-04-19 12:43:05,563: 12:43:05 | 
2017-04-19 12:43:05,563: 12:43:05 | Finished running 21 tests in 14.24s.
2017-04-19 12:43:05,564: Connection 'master' was left open.
2017-04-19 12:43:05,564: Done. PASS=15 ERROR=6 SKIP=0 TOTAL=21
2017-04-19 12:43:05,564: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27c828>]}
2017-04-19 12:43:05,637: Flushing usage events
2017-04-19 12:44:15,045: Tracking: tracking
2017-04-19 12:44:15,045: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108cd2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108cd828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108cd978>]}
2017-04-19 12:44:15,143: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 12:44:15,187: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 12:44:15,188: Parsing materializations/incremental.sql
2017-04-19 12:44:15,206: Parsing materializations/table.sql
2017-04-19 12:44:15,214: Parsing materializations/view.sql
2017-04-19 12:44:15,220: Parsing materializations/wrapper.sql
2017-04-19 12:44:15,223: Parsing schema_tests/accepted_values.sql
2017-04-19 12:44:15,226: Parsing schema_tests/not_null.sql
2017-04-19 12:44:15,227: Parsing schema_tests/relationships.sql
2017-04-19 12:44:15,229: Parsing schema_tests/unique.sql
2017-04-19 12:44:15,234: Parsing model.shippo_test.shippo_addresses
2017-04-19 12:44:15,235: Parsing model.shippo_test.shippo_parcels
2017-04-19 12:44:15,237: Parsing model.shippo_test.shippo_shipments
2017-04-19 12:44:15,247: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:44:15,249: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:44:15,250: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:44:15,251: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:44:15,252: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:44:15,253: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:44:15,254: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:44:15,255: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:44:15,257: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:44:15,258: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:44:15,259: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:44:15,260: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 12:44:15,262: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 12:44:15,264: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 12:44:15,265: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:44:15,266: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:44:15,268: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 12:44:15,269: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:44:15,270: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 12:44:15,271: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:44:15,272: Parsing test.shippo_test.relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:44:15,274: Compiled 3 models, 21 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 12:44:15,275: Acquiring new redshift connection "master".
2017-04-19 12:44:15,275: Opening a new connection (0 currently allocated)
2017-04-19 12:44:15,399: Using redshift connection "master".
2017-04-19 12:44:15,399: On master: BEGIN
2017-04-19 12:44:15,420: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:15,421: Creating schema "analytics".
2017-04-19 12:44:15,421: Using redshift connection "master".
2017-04-19 12:44:15,421: On master: create schema if not exists "analytics"
2017-04-19 12:44:15,432: SQL status: CREATE SCHEMA in 0.01 seconds
2017-04-19 12:44:15,432: On master: COMMIT
2017-04-19 12:44:15,935: Concurrency: 4 threads (target='only')
2017-04-19 12:44:15,935: Using redshift connection "master".
2017-04-19 12:44:15,935: On master: BEGIN
2017-04-19 12:44:15,957: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:15,957: Using redshift connection "master".
2017-04-19 12:44:15,957: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:44:15,992: SQL status: SELECT in 0.03 seconds
2017-04-19 12:44:15,992: On master: COMMIT
2017-04-19 12:44:16,004: 
2017-04-19 12:44:16,004: 12:44:16 | Running 3 view models
2017-04-19 12:44:16,004: 12:44:16 | 
2017-04-19 12:44:16,004: Using redshift connection "master".
2017-04-19 12:44:16,004: On master: BEGIN
2017-04-19 12:44:16,025: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:16,026: On master: COMMIT
2017-04-19 12:44:16,036: 12:44:16 | 1 of 3 START view model analytics.shippo_addresses................... [RUN]
2017-04-19 12:44:16,036: Compiling model.shippo_test.shippo_addresses
2017-04-19 12:44:16,038: Acquiring new redshift connection "shippo_addresses".
2017-04-19 12:44:16,038: Opening a new connection (1 currently allocated)
2017-04-19 12:44:16,039: 12:44:16 | 2 of 3 START view model analytics.shippo_shipments................... [RUN]
2017-04-19 12:44:16,039: 12:44:16 | 3 of 3 START view model analytics.shippo_parcels..................... [RUN]
2017-04-19 12:44:16,039: Compiling model.shippo_test.shippo_shipments
2017-04-19 12:44:16,039: Compiling model.shippo_test.shippo_parcels
2017-04-19 12:44:16,041: Acquiring new redshift connection "shippo_shipments".
2017-04-19 12:44:16,042: Acquiring new redshift connection "shippo_parcels".
2017-04-19 12:44:16,131: Using redshift connection "shippo_addresses".
2017-04-19 12:44:16,132: Opening a new connection (2 currently allocated)
2017-04-19 12:44:16,132: On shippo_addresses: BEGIN
2017-04-19 12:44:16,154: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:16,154: Using redshift connection "shippo_addresses".
2017-04-19 12:44:16,154: On shippo_addresses: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:44:16,189: SQL status: SELECT in 0.03 seconds
2017-04-19 12:44:16,190: executing node model.shippo_test.shippo_addresses
2017-04-19 12:44:16,192: Using redshift connection "shippo_addresses".
2017-04-19 12:44:16,192: On shippo_addresses: -- Compiled by DBT

    

    create view "analytics"."shippo_addresses__dbt_tmp" as (
        select

    object_id as id,

    name,
    company,

    street1,
    street2,
    street3,
    street_no,

    city,
    state,
    zip,
    country,

    email,
    phone,

    is_residential,

    object_owner as owner,
    lower(object_purpose) as purpose,
    lower(object_source) as source,
    lower(object_state) as object_state,

    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.addresses
    );

    
2017-04-19 12:44:16,228: Using redshift connection "shippo_shipments".
2017-04-19 12:44:16,228: Opening a new connection (3 currently allocated)
2017-04-19 12:44:16,228: On shippo_shipments: BEGIN
2017-04-19 12:44:16,251: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:16,251: Using redshift connection "shippo_shipments".
2017-04-19 12:44:16,251: On shippo_shipments: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:44:16,280: SQL status: CREATE VIEW in 0.09 seconds
2017-04-19 12:44:16,281: On shippo_addresses: COMMIT
2017-04-19 12:44:16,301: SQL status: SELECT in 0.05 seconds
2017-04-19 12:44:16,303: executing node model.shippo_test.shippo_shipments
2017-04-19 12:44:16,304: Using redshift connection "shippo_shipments".
2017-04-19 12:44:16,304: On shippo_shipments: -- Compiled by DBT

    

    create view "analytics"."shippo_shipments__dbt_tmp" as (
        select

    object_id as id,

    address_from as address_from_id,
    address_return as address_return_id,
    address_to as address_to_id,
    parcel as parcel_id,

    insurance_amount::float,
    insurance_currency,

    rates_url,
    return_of,
    submission_date,
    lower(submission_type) as submission_type,
    customs_declaration,


    object_owner as owner,
    lower(object_state) as state,
    lower(object_purpose) as purpose,
    lower(object_status) as status,


    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments
    );

    
2017-04-19 12:44:16,319: Using redshift connection "shippo_parcels".
2017-04-19 12:44:16,319: On shippo_parcels: BEGIN
2017-04-19 12:44:16,341: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:16,341: Using redshift connection "shippo_parcels".
2017-04-19 12:44:16,341: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:44:16,376: SQL status: SELECT in 0.03 seconds
2017-04-19 12:44:16,378: executing node model.shippo_test.shippo_parcels
2017-04-19 12:44:16,379: Using redshift connection "shippo_parcels".
2017-04-19 12:44:16,379: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 12:44:17,184: SQL status: CREATE VIEW in 0.88 seconds
2017-04-19 12:44:17,184: SQL status: CREATE VIEW in 0.81 seconds
2017-04-19 12:44:17,379: Using redshift connection "shippo_addresses".
2017-04-19 12:44:17,379: On shippo_addresses: BEGIN
2017-04-19 12:44:17,402: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:17,402: Using redshift connection "shippo_addresses".
2017-04-19 12:44:17,402: On shippo_addresses: drop view if exists "analytics"."shippo_addresses" cascade
2017-04-19 12:44:17,423: SQL status: DROP VIEW in 0.02 seconds
2017-04-19 12:44:17,423: On shippo_addresses: COMMIT
2017-04-19 12:44:17,900: Using redshift connection "shippo_addresses".
2017-04-19 12:44:17,900: On shippo_addresses: BEGIN
2017-04-19 12:44:17,924: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:17,924: Using redshift connection "shippo_addresses".
2017-04-19 12:44:17,925: On shippo_addresses: alter table "analytics"."shippo_addresses__dbt_tmp" rename to "shippo_addresses"
2017-04-19 12:44:17,925: On shippo_shipments: COMMIT
2017-04-19 12:44:17,939: SQL status: ALTER TABLE in 0.01 seconds
2017-04-19 12:44:17,939: On shippo_addresses: COMMIT
2017-04-19 12:44:19,026: Using redshift connection "shippo_shipments".
2017-04-19 12:44:19,027: On shippo_shipments: BEGIN
2017-04-19 12:44:19,049: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:19,050: Using redshift connection "shippo_shipments".
2017-04-19 12:44:19,050: On shippo_shipments: drop view if exists "analytics"."shippo_shipments" cascade
2017-04-19 12:44:19,235: SQL status: DROP VIEW in 0.18 seconds
2017-04-19 12:44:19,235: On shippo_shipments: COMMIT
2017-04-19 12:44:19,548: 12:44:19 | 1 of 3 OK created view model analytics.shippo_addresses.............. [CREATE VIEW in 3.51s]
2017-04-19 12:44:19,548: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9a4943a-a273-43da-87e5-d52e2dd1dedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11097ab00>]}
2017-04-19 12:44:19,823: Using redshift connection "shippo_shipments".
2017-04-19 12:44:19,823: On shippo_shipments: BEGIN
2017-04-19 12:44:19,846: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:19,846: Using redshift connection "shippo_shipments".
2017-04-19 12:44:19,846: On shippo_shipments: alter table "analytics"."shippo_shipments__dbt_tmp" rename to "shippo_shipments"
2017-04-19 12:44:19,846: On shippo_parcels: COMMIT
2017-04-19 12:44:19,859: SQL status: ALTER TABLE in 0.01 seconds
2017-04-19 12:44:19,860: On shippo_shipments: COMMIT
2017-04-19 12:44:20,407: Using redshift connection "shippo_parcels".
2017-04-19 12:44:20,407: On shippo_parcels: BEGIN
2017-04-19 12:44:20,429: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:20,429: Using redshift connection "shippo_parcels".
2017-04-19 12:44:20,429: On shippo_parcels: drop view if exists "analytics"."shippo_parcels" cascade
2017-04-19 12:44:20,601: SQL status: DROP VIEW in 0.17 seconds
2017-04-19 12:44:20,601: On shippo_parcels: COMMIT
2017-04-19 12:44:20,675: 12:44:20 | 2 of 3 OK created view model analytics.shippo_shipments.............. [CREATE VIEW in 4.64s]
2017-04-19 12:44:20,675: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9a4943a-a273-43da-87e5-d52e2dd1dedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b1ba8>]}
2017-04-19 12:44:21,165: Using redshift connection "shippo_parcels".
2017-04-19 12:44:21,165: On shippo_parcels: BEGIN
2017-04-19 12:44:21,188: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:21,188: Using redshift connection "shippo_parcels".
2017-04-19 12:44:21,188: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 12:44:21,290: SQL status: ALTER TABLE in 0.10 seconds
2017-04-19 12:44:21,291: On shippo_parcels: COMMIT
2017-04-19 12:44:22,192: 12:44:22 | 3 of 3 OK created view model analytics.shippo_parcels................ [CREATE VIEW in 6.15s]
2017-04-19 12:44:22,193: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9a4943a-a273-43da-87e5-d52e2dd1dedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11097ab00>]}
2017-04-19 12:44:22,309: Using redshift connection "master".
2017-04-19 12:44:22,310: On master: BEGIN
2017-04-19 12:44:22,330: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:22,331: On master: COMMIT
2017-04-19 12:44:22,342: 12:44:22 | 
2017-04-19 12:44:22,343: 12:44:22 | Finished running 3 view models in 6.34s.
2017-04-19 12:44:22,343: Connection 'master' was left open.
2017-04-19 12:44:22,343: Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2017-04-19 12:44:22,344: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ce8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11097df60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110862d68>]}
2017-04-19 12:44:22,418: Flushing usage events
2017-04-19 12:44:25,591: Tracking: tracking
2017-04-19 12:44:25,591: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107562668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107562240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075625c0>]}
2017-04-19 12:44:25,670: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 12:44:25,717: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 12:44:25,718: Parsing materializations/incremental.sql
2017-04-19 12:44:25,734: Parsing materializations/table.sql
2017-04-19 12:44:25,742: Parsing materializations/view.sql
2017-04-19 12:44:25,745: Parsing materializations/wrapper.sql
2017-04-19 12:44:25,748: Parsing schema_tests/accepted_values.sql
2017-04-19 12:44:25,751: Parsing schema_tests/not_null.sql
2017-04-19 12:44:25,752: Parsing schema_tests/relationships.sql
2017-04-19 12:44:25,754: Parsing schema_tests/unique.sql
2017-04-19 12:44:25,758: Parsing model.shippo_test.shippo_addresses
2017-04-19 12:44:25,760: Parsing model.shippo_test.shippo_parcels
2017-04-19 12:44:25,761: Parsing model.shippo_test.shippo_shipments
2017-04-19 12:44:25,771: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:44:25,772: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:44:25,773: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:44:25,774: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:44:25,775: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:44:25,776: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:44:25,777: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:44:25,779: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:44:25,780: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:44:25,781: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:44:25,782: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:44:25,783: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 12:44:25,785: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 12:44:25,787: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 12:44:25,788: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:44:25,789: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:44:25,790: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 12:44:25,791: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:44:25,793: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 12:44:25,794: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:44:25,795: Parsing test.shippo_test.relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:44:25,797: Compiled 3 models, 21 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 12:44:25,799: Acquiring new redshift connection "master".
2017-04-19 12:44:25,799: Opening a new connection (0 currently allocated)
2017-04-19 12:44:25,890: Using redshift connection "master".
2017-04-19 12:44:25,890: On master: BEGIN
2017-04-19 12:44:25,912: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:25,912: Creating schema "analytics".
2017-04-19 12:44:25,913: Using redshift connection "master".
2017-04-19 12:44:25,913: On master: create schema if not exists "analytics"
2017-04-19 12:44:25,923: SQL status: CREATE SCHEMA in 0.01 seconds
2017-04-19 12:44:25,924: On master: COMMIT
2017-04-19 12:44:26,298: Concurrency: 4 threads (target='only')
2017-04-19 12:44:26,298: Using redshift connection "master".
2017-04-19 12:44:26,299: On master: BEGIN
2017-04-19 12:44:26,320: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,320: Using redshift connection "master".
2017-04-19 12:44:26,321: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:44:26,357: SQL status: SELECT in 0.04 seconds
2017-04-19 12:44:26,357: On master: COMMIT
2017-04-19 12:44:26,369: 
2017-04-19 12:44:26,369: 12:44:26 | Running 21 tests
2017-04-19 12:44:26,369: 12:44:26 | 
2017-04-19 12:44:26,369: 12:44:26 | 1 of 21 START test unique_shippo_parcels_id.......................... [RUN]
2017-04-19 12:44:26,369: Compiling test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:44:26,371: 12:44:26 | 2 of 21 START test not_null_shippo_parcels_state..................... [RUN]
2017-04-19 12:44:26,371: Compiling test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:44:26,373: 12:44:26 | 3 of 21 START test relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_ [RUN]
2017-04-19 12:44:26,373: Compiling test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 12:44:26,376: executing node test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 12:44:26,377: Acquiring new redshift connection "relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_".
2017-04-19 12:44:26,377: Opening a new connection (1 currently allocated)
2017-04-19 12:44:26,376: 12:44:26 | 4 of 21 START test not_null_shippo_shipments_id...................... [RUN]
2017-04-19 12:44:26,377: executing node test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:44:26,377: executing node test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:44:26,377: Compiling test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:44:26,378: Acquiring new redshift connection "unique_shippo_parcels_id".
2017-04-19 12:44:26,378: Acquiring new redshift connection "not_null_shippo_parcels_state".
2017-04-19 12:44:26,380: executing node test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:44:26,381: Acquiring new redshift connection "not_null_shippo_shipments_id".
2017-04-19 12:44:26,467: Using redshift connection "relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_".
2017-04-19 12:44:26,467: On relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_: BEGIN
2017-04-19 12:44:26,467: Opening a new connection (2 currently allocated)
2017-04-19 12:44:26,489: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,490: Using redshift connection "relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_".
2017-04-19 12:44:26,490: On relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_addresses"

),

child as (

    select
        address_from_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:44:26,554: Using redshift connection "unique_shippo_parcels_id".
2017-04-19 12:44:26,555: On unique_shippo_parcels_id: BEGIN
2017-04-19 12:44:26,555: Opening a new connection (3 currently allocated)
2017-04-19 12:44:26,577: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,577: Using redshift connection "unique_shippo_parcels_id".
2017-04-19 12:44:26,577: On unique_shippo_parcels_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_parcels"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 12:44:26,638: Using redshift connection "not_null_shippo_parcels_state".
2017-04-19 12:44:26,639: On not_null_shippo_parcels_state: BEGIN
2017-04-19 12:44:26,639: Opening a new connection (4 currently allocated)
2017-04-19 12:44:26,660: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,660: Using redshift connection "not_null_shippo_parcels_state".
2017-04-19 12:44:26,660: On not_null_shippo_parcels_state: 

with validation as (

    select
        state as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:26,702: SQL status: SELECT in 0.21 seconds
2017-04-19 12:44:26,703: On relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_: COMMIT
2017-04-19 12:44:26,709: SQL status: SELECT in 0.05 seconds
2017-04-19 12:44:26,709: On not_null_shippo_parcels_state: COMMIT
2017-04-19 12:44:26,729: Using redshift connection "not_null_shippo_shipments_id".
2017-04-19 12:44:26,730: On not_null_shippo_shipments_id: BEGIN
2017-04-19 12:44:26,730: 12:44:26 | 3 of 21 FAIL 36 relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_ [FAIL 36 in 0.36s]
2017-04-19 12:44:26,730: 12:44:26 | 2 of 21 PASS not_null_shippo_parcels_state........................... [PASS in 0.36s]
2017-04-19 12:44:26,730: 12:44:26 | 5 of 21 START test not_null_shippo_shipments_created_at.............. [RUN]
2017-04-19 12:44:26,731: Compiling test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:44:26,730: 12:44:26 | 6 of 21 START test not_null_shippo_addresses_id...................... [RUN]
2017-04-19 12:44:26,733: Compiling test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:44:26,735: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761b4a8>]}
2017-04-19 12:44:26,736: executing node test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:44:26,737: Acquiring new redshift connection "not_null_shippo_addresses_id".
2017-04-19 12:44:26,737: Re-using an available connection from the pool.
2017-04-19 12:44:26,737: Using redshift connection "not_null_shippo_addresses_id".
2017-04-19 12:44:26,737: On not_null_shippo_addresses_id: BEGIN
2017-04-19 12:44:26,738: executing node test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:44:26,739: Acquiring new redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 12:44:26,739: Re-using an available connection from the pool.
2017-04-19 12:44:26,739: Using redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 12:44:26,739: On not_null_shippo_shipments_created_at: BEGIN
2017-04-19 12:44:26,751: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,752: Using redshift connection "not_null_shippo_shipments_id".
2017-04-19 12:44:26,752: On not_null_shippo_shipments_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:26,758: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,759: Using redshift connection "not_null_shippo_addresses_id".
2017-04-19 12:44:26,759: On not_null_shippo_addresses_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:26,761: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,761: Using redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 12:44:26,761: On not_null_shippo_shipments_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:26,785: SQL status: SELECT in 0.21 seconds
2017-04-19 12:44:26,785: On unique_shippo_parcels_id: COMMIT
2017-04-19 12:44:26,796: 12:44:26 | 1 of 21 PASS unique_shippo_parcels_id................................ [PASS in 0.43s]
2017-04-19 12:44:26,796: 12:44:26 | 7 of 21 START test not_null_shippo_parcels_created_at................ [RUN]
2017-04-19 12:44:26,796: Compiling test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:44:26,798: executing node test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:44:26,799: Acquiring new redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 12:44:26,799: Re-using an available connection from the pool.
2017-04-19 12:44:26,799: Using redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 12:44:26,799: On not_null_shippo_parcels_created_at: BEGIN
2017-04-19 12:44:26,801: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612278>]}
2017-04-19 12:44:26,821: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,821: Using redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 12:44:26,822: On not_null_shippo_parcels_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:26,825: SQL status: SELECT in 0.06 seconds
2017-04-19 12:44:26,825: On not_null_shippo_shipments_created_at: COMMIT
2017-04-19 12:44:26,827: SQL status: SELECT in 0.07 seconds
2017-04-19 12:44:26,828: On not_null_shippo_addresses_id: COMMIT
2017-04-19 12:44:26,832: SQL status: SELECT in 0.08 seconds
2017-04-19 12:44:26,832: On not_null_shippo_shipments_id: COMMIT
2017-04-19 12:44:26,839: 12:44:26 | 6 of 21 PASS not_null_shippo_addresses_id............................ [PASS in 0.11s]
2017-04-19 12:44:26,840: 12:44:26 | 8 of 21 START test relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_ [RUN]
2017-04-19 12:44:26,840: Compiling test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 12:44:26,842: 12:44:26 | 5 of 21 PASS not_null_shippo_shipments_created_at.................... [PASS in 0.11s]
2017-04-19 12:44:26,842: 12:44:26 | 9 of 21 START test not_null_shippo_addresses_purpose................. [RUN]
2017-04-19 12:44:26,842: Compiling test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:44:26,844: executing node test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 12:44:26,844: Acquiring new redshift connection "relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_".
2017-04-19 12:44:26,845: Re-using an available connection from the pool.
2017-04-19 12:44:26,845: Using redshift connection "relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_".
2017-04-19 12:44:26,845: On relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_: BEGIN
2017-04-19 12:44:26,845: executing node test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:44:26,845: Acquiring new redshift connection "not_null_shippo_addresses_purpose".
2017-04-19 12:44:26,845: Re-using an available connection from the pool.
2017-04-19 12:44:26,845: Using redshift connection "not_null_shippo_addresses_purpose".
2017-04-19 12:44:26,846: On not_null_shippo_addresses_purpose: BEGIN
2017-04-19 12:44:26,846: 12:44:26 | 4 of 21 PASS not_null_shippo_shipments_id............................ [PASS in 0.47s]
2017-04-19 12:44:26,846: 12:44:26 | 10 of 21 START test not_null_shippo_addresses_object_state........... [RUN]
2017-04-19 12:44:26,846: Compiling test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 12:44:26,848: executing node test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 12:44:26,849: Acquiring new redshift connection "not_null_shippo_addresses_object_state".
2017-04-19 12:44:26,849: Re-using an available connection from the pool.
2017-04-19 12:44:26,849: Using redshift connection "not_null_shippo_addresses_object_state".
2017-04-19 12:44:26,849: On not_null_shippo_addresses_object_state: BEGIN
2017-04-19 12:44:26,864: SQL status: SELECT in 0.04 seconds
2017-04-19 12:44:26,865: On not_null_shippo_parcels_created_at: COMMIT
2017-04-19 12:44:26,867: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,867: Using redshift connection "relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_".
2017-04-19 12:44:26,867: On relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_addresses"

),

child as (

    select
        address_to_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:44:26,868: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,868: Using redshift connection "not_null_shippo_addresses_purpose".
2017-04-19 12:44:26,868: On not_null_shippo_addresses_purpose: 

with validation as (

    select
        purpose as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:26,870: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,871: Using redshift connection "not_null_shippo_addresses_object_state".
2017-04-19 12:44:26,871: On not_null_shippo_addresses_object_state: 

with validation as (

    select
        object_state as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:26,875: 12:44:26 | 7 of 21 PASS not_null_shippo_parcels_created_at...................... [PASS in 0.08s]
2017-04-19 12:44:26,876: 12:44:26 | 11 of 21 START test unique_shippo_addresses_id....................... [RUN]
2017-04-19 12:44:26,876: Compiling test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:44:26,878: executing node test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:44:26,878: Acquiring new redshift connection "unique_shippo_addresses_id".
2017-04-19 12:44:26,878: Re-using an available connection from the pool.
2017-04-19 12:44:26,879: Using redshift connection "unique_shippo_addresses_id".
2017-04-19 12:44:26,879: On unique_shippo_addresses_id: BEGIN
2017-04-19 12:44:26,919: SQL status: BEGIN in 0.04 seconds
2017-04-19 12:44:26,919: Using redshift connection "unique_shippo_addresses_id".
2017-04-19 12:44:26,919: On unique_shippo_addresses_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_addresses"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 12:44:26,948: SQL status: SELECT in 0.08 seconds
2017-04-19 12:44:26,948: On not_null_shippo_addresses_purpose: COMMIT
2017-04-19 12:44:26,950: SQL status: SELECT in 0.08 seconds
2017-04-19 12:44:26,950: On not_null_shippo_addresses_object_state: COMMIT
2017-04-19 12:44:26,958: 12:44:26 | 9 of 21 PASS not_null_shippo_addresses_purpose....................... [PASS in 0.12s]
2017-04-19 12:44:26,958: 12:44:26 | 12 of 21 START test not_null_shippo_addresses_created_at............. [RUN]
2017-04-19 12:44:26,958: Compiling test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:44:26,960: executing node test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:44:26,960: Acquiring new redshift connection "not_null_shippo_addresses_created_at".
2017-04-19 12:44:26,960: Re-using an available connection from the pool.
2017-04-19 12:44:26,960: Using redshift connection "not_null_shippo_addresses_created_at".
2017-04-19 12:44:26,961: On not_null_shippo_addresses_created_at: BEGIN
2017-04-19 12:44:26,961: 12:44:26 | 10 of 21 PASS not_null_shippo_addresses_object_state................. [PASS in 0.11s]
2017-04-19 12:44:26,961: 12:44:26 | 13 of 21 START test not_null_shippo_parcels_id....................... [RUN]
2017-04-19 12:44:26,961: Compiling test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:44:26,962: executing node test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:44:26,963: Acquiring new redshift connection "not_null_shippo_parcels_id".
2017-04-19 12:44:26,963: Re-using an available connection from the pool.
2017-04-19 12:44:26,963: Using redshift connection "not_null_shippo_parcels_id".
2017-04-19 12:44:26,963: On not_null_shippo_parcels_id: BEGIN
2017-04-19 12:44:26,982: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,982: Using redshift connection "not_null_shippo_addresses_created_at".
2017-04-19 12:44:26,982: On not_null_shippo_addresses_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:26,984: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:26,984: Using redshift connection "not_null_shippo_parcels_id".
2017-04-19 12:44:26,984: On not_null_shippo_parcels_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:27,031: SQL status: SELECT in 0.05 seconds
2017-04-19 12:44:27,032: On not_null_shippo_parcels_id: COMMIT
2017-04-19 12:44:27,043: 12:44:27 | 13 of 21 PASS not_null_shippo_parcels_id............................. [PASS in 0.08s]
2017-04-19 12:44:27,043: 12:44:27 | 14 of 21 START test not_null_shippo_shipments_purpose................ [RUN]
2017-04-19 12:44:27,043: Compiling test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:44:27,045: executing node test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:44:27,046: Acquiring new redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 12:44:27,046: Re-using an available connection from the pool.
2017-04-19 12:44:27,046: Using redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 12:44:27,046: On not_null_shippo_shipments_purpose: BEGIN
2017-04-19 12:44:27,073: SQL status: BEGIN in 0.03 seconds
2017-04-19 12:44:27,074: Using redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 12:44:27,074: On not_null_shippo_shipments_purpose: 

with validation as (

    select
        purpose as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:27,077: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760f5f8>]}
2017-04-19 12:44:27,120: SQL status: SELECT in 0.05 seconds
2017-04-19 12:44:27,120: On not_null_shippo_shipments_purpose: COMMIT
2017-04-19 12:44:27,131: 12:44:27 | 14 of 21 PASS not_null_shippo_shipments_purpose...................... [PASS in 0.09s]
2017-04-19 12:44:27,132: 12:44:27 | 15 of 21 START test not_null_shippo_shipments_status................. [RUN]
2017-04-19 12:44:27,132: Compiling test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:44:27,134: executing node test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:44:27,134: Acquiring new redshift connection "not_null_shippo_shipments_status".
2017-04-19 12:44:27,134: Re-using an available connection from the pool.
2017-04-19 12:44:27,135: Using redshift connection "not_null_shippo_shipments_status".
2017-04-19 12:44:27,135: On not_null_shippo_shipments_status: BEGIN
2017-04-19 12:44:27,139: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760f5f8>]}
2017-04-19 12:44:27,155: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:27,156: Using redshift connection "not_null_shippo_shipments_status".
2017-04-19 12:44:27,156: On not_null_shippo_shipments_status: 

with validation as (

    select
        status as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:27,164: SQL status: SELECT in 0.30 seconds
2017-04-19 12:44:27,164: On relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_: COMMIT
2017-04-19 12:44:27,176: 12:44:27 | 8 of 21 FAIL 36 relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_ [FAIL 36 in 0.34s]
2017-04-19 12:44:27,176: 12:44:27 | 16 of 21 START test unique_shippo_shipments_id....................... [RUN]
2017-04-19 12:44:27,176: Compiling test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:44:27,179: executing node test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:44:27,180: Acquiring new redshift connection "unique_shippo_shipments_id".
2017-04-19 12:44:27,180: Re-using an available connection from the pool.
2017-04-19 12:44:27,180: Using redshift connection "unique_shippo_shipments_id".
2017-04-19 12:44:27,180: On unique_shippo_shipments_id: BEGIN
2017-04-19 12:44:27,202: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:27,202: Using redshift connection "unique_shippo_shipments_id".
2017-04-19 12:44:27,202: On unique_shippo_shipments_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_shipments"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 12:44:27,204: SQL status: SELECT in 0.05 seconds
2017-04-19 12:44:27,204: On not_null_shippo_shipments_status: COMMIT
2017-04-19 12:44:27,205: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765ef28>]}
2017-04-19 12:44:27,215: 12:44:27 | 15 of 21 PASS not_null_shippo_shipments_status....................... [PASS in 0.08s]
2017-04-19 12:44:27,216: 12:44:27 | 17 of 21 START test not_null_shippo_shipments_state.................. [RUN]
2017-04-19 12:44:27,216: Compiling test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:44:27,218: executing node test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:44:27,218: Acquiring new redshift connection "not_null_shippo_shipments_state".
2017-04-19 12:44:27,218: Re-using an available connection from the pool.
2017-04-19 12:44:27,219: Using redshift connection "not_null_shippo_shipments_state".
2017-04-19 12:44:27,219: On not_null_shippo_shipments_state: BEGIN
2017-04-19 12:44:27,220: SQL status: SELECT in 0.30 seconds
2017-04-19 12:44:27,220: On unique_shippo_addresses_id: COMMIT
2017-04-19 12:44:27,231: 12:44:27 | 11 of 21 PASS unique_shippo_addresses_id............................. [PASS in 0.36s]
2017-04-19 12:44:27,231: 12:44:27 | 18 of 21 START test not_null_shippo_addresses_source................. [RUN]
2017-04-19 12:44:27,232: Compiling test.shippo_test.not_null_shippo_addresses_source
2017-04-19 12:44:27,234: executing node test.shippo_test.not_null_shippo_addresses_source
2017-04-19 12:44:27,234: Acquiring new redshift connection "not_null_shippo_addresses_source".
2017-04-19 12:44:27,234: Re-using an available connection from the pool.
2017-04-19 12:44:27,234: Using redshift connection "not_null_shippo_addresses_source".
2017-04-19 12:44:27,234: On not_null_shippo_addresses_source: BEGIN
2017-04-19 12:44:27,240: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:27,240: Using redshift connection "not_null_shippo_shipments_state".
2017-04-19 12:44:27,240: On not_null_shippo_shipments_state: 

with validation as (

    select
        state as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:27,255: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:27,255: Using redshift connection "not_null_shippo_addresses_source".
2017-04-19 12:44:27,255: On not_null_shippo_addresses_source: 

with validation as (

    select
        source as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:44:27,272: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765ef28>]}
2017-04-19 12:44:27,308: SQL status: SELECT in 0.07 seconds
2017-04-19 12:44:27,308: On not_null_shippo_shipments_state: COMMIT
2017-04-19 12:44:27,314: SQL status: SELECT in 0.06 seconds
2017-04-19 12:44:27,314: On not_null_shippo_addresses_source: COMMIT
2017-04-19 12:44:27,319: 12:44:27 | 17 of 21 PASS not_null_shippo_shipments_state........................ [PASS in 0.10s]
2017-04-19 12:44:27,319: 12:44:27 | 19 of 21 START test relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_ [RUN]
2017-04-19 12:44:27,319: Compiling test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 12:44:27,322: executing node test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 12:44:27,323: Acquiring new redshift connection "relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_".
2017-04-19 12:44:27,323: Re-using an available connection from the pool.
2017-04-19 12:44:27,323: Using redshift connection "relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_".
2017-04-19 12:44:27,323: On relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_: BEGIN
2017-04-19 12:44:27,325: 12:44:27 | 18 of 21 PASS not_null_shippo_addresses_source....................... [PASS in 0.09s]
2017-04-19 12:44:27,326: 12:44:27 | 20 of 21 START test relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_ [RUN]
2017-04-19 12:44:27,326: Compiling test.shippo_test.relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:44:27,328: executing node test.shippo_test.relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:44:27,329: Acquiring new redshift connection "relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:44:27,329: Re-using an available connection from the pool.
2017-04-19 12:44:27,329: Using redshift connection "relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:44:27,329: On relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_: BEGIN
2017-04-19 12:44:27,341: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765ef28>]}
2017-04-19 12:44:27,344: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:27,344: Using redshift connection "relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_".
2017-04-19 12:44:27,344: On relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_addresses"

),

child as (

    select
        address_return_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:44:27,360: SQL status: BEGIN in 0.03 seconds
2017-04-19 12:44:27,360: Using redshift connection "relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:44:27,360: On relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_parcels"

),

child as (

    select
        parcel_id as id

    from "analytics"."shippo_addresses"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:44:27,373: Postgres error: column "parcel_id" does not exist in shippo_addresses

2017-04-19 12:44:27,373: On relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_: ROLLBACK
2017-04-19 12:44:27,383: Error executing target/build/shippo_test/shippo/base/schema_test/relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_.sql
column "parcel_id" does not exist in shippo_addresses
2017-04-19 12:44:27,384: 12:44:27 | 20 of 21 ERROR relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_ [ERROR in 0.06s]
2017-04-19 12:44:27,384: 12:44:27 | 21 of 21 START test relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_ [RUN]
2017-04-19 12:44:27,384: Compiling test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:44:27,386: executing node test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:44:27,387: Acquiring new redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:44:27,387: Re-using an available connection from the pool.
2017-04-19 12:44:27,387: Using redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:44:27,387: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: BEGIN
2017-04-19 12:44:27,407: SQL status: SELECT in 0.20 seconds
2017-04-19 12:44:27,407: On unique_shippo_shipments_id: COMMIT
2017-04-19 12:44:27,408: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:44:27,408: Using redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:44:27,408: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_parcels"

),

child as (

    select
        parcel_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:44:27,412: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612e48>]}
2017-04-19 12:44:27,418: 12:44:27 | 16 of 21 PASS unique_shippo_shipments_id............................. [PASS in 0.24s]
2017-04-19 12:44:27,481: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612e48>]}
2017-04-19 12:44:27,548: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612e48>]}
2017-04-19 12:44:27,591: SQL status: SELECT in 0.25 seconds
2017-04-19 12:44:27,591: On relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_: COMMIT
2017-04-19 12:44:27,602: 12:44:27 | 19 of 21 FAIL 36 relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_ [FAIL 36 in 0.28s]
2017-04-19 12:44:27,607: SQL status: SELECT in 0.20 seconds
2017-04-19 12:44:27,607: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: COMMIT
2017-04-19 12:44:27,614: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612e48>]}
2017-04-19 12:44:27,618: 12:44:27 | 21 of 21 FAIL 21 relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_ [FAIL 21 in 0.23s]
2017-04-19 12:44:27,674: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612e48>]}
2017-04-19 12:44:27,756: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612e48>]}
2017-04-19 12:44:27,821: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612e48>]}
2017-04-19 12:44:27,887: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612e48>]}
2017-04-19 12:44:27,990: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612e48>]}
2017-04-19 12:44:28,059: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760f470>]}
2017-04-19 12:44:28,126: Error executing target/build/shippo_test/shippo/base/schema_test/relationships_shippo_addresses_id__parcel_id__ref_shippo_parcels_.sql
column "parcel_id" does not exist in shippo_addresses
2017-04-19 12:44:28,127: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760f470>]}
2017-04-19 12:44:28,217: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104517dd8>]}
2017-04-19 12:44:28,282: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104517dd8>]}
2017-04-19 12:44:28,880: SQL status: SELECT in 1.90 seconds
2017-04-19 12:44:28,880: On not_null_shippo_addresses_created_at: COMMIT
2017-04-19 12:44:28,891: 12:44:28 | 12 of 21 PASS not_null_shippo_addresses_created_at................... [PASS in 1.93s]
2017-04-19 12:44:28,891: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e974afef-20a9-40a6-8c00-20417cb6b2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760f470>]}
2017-04-19 12:44:29,050: 12:44:29 | 
2017-04-19 12:44:29,051: 12:44:29 | Finished running 21 tests in 2.68s.
2017-04-19 12:44:29,051: Connection 'master' was left open.
2017-04-19 12:44:29,052: Done. PASS=16 ERROR=5 SKIP=0 TOTAL=21
2017-04-19 12:44:29,052: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075528d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107552860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107552588>]}
2017-04-19 12:44:29,124: Flushing usage events
2017-04-19 12:45:07,188: Tracking: tracking
2017-04-19 12:45:07,188: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ab3ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ab35f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ab3978>]}
2017-04-19 12:45:07,286: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 12:45:07,331: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 12:45:07,332: Parsing materializations/incremental.sql
2017-04-19 12:45:07,349: Parsing materializations/table.sql
2017-04-19 12:45:07,358: Parsing materializations/view.sql
2017-04-19 12:45:07,362: Parsing materializations/wrapper.sql
2017-04-19 12:45:07,364: Parsing schema_tests/accepted_values.sql
2017-04-19 12:45:07,367: Parsing schema_tests/not_null.sql
2017-04-19 12:45:07,368: Parsing schema_tests/relationships.sql
2017-04-19 12:45:07,370: Parsing schema_tests/unique.sql
2017-04-19 12:45:07,375: Parsing model.shippo_test.shippo_addresses
2017-04-19 12:45:07,376: Parsing model.shippo_test.shippo_parcels
2017-04-19 12:45:07,377: Parsing model.shippo_test.shippo_shipments
2017-04-19 12:45:07,386: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:45:07,388: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:45:07,389: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:45:07,390: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:45:07,391: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:45:07,392: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:45:07,393: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:45:07,394: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:45:07,396: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:45:07,397: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:45:07,398: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:45:07,399: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 12:45:07,401: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 12:45:07,402: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 12:45:07,404: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:45:07,405: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:45:07,406: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 12:45:07,407: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:45:07,408: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 12:45:07,410: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:45:07,411: Compiled 3 models, 20 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 12:45:07,413: Acquiring new redshift connection "master".
2017-04-19 12:45:07,413: Opening a new connection (0 currently allocated)
2017-04-19 12:45:07,526: Using redshift connection "master".
2017-04-19 12:45:07,527: On master: BEGIN
2017-04-19 12:45:07,547: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:07,548: Creating schema "analytics".
2017-04-19 12:45:07,548: Using redshift connection "master".
2017-04-19 12:45:07,548: On master: create schema if not exists "analytics"
2017-04-19 12:45:07,559: SQL status: CREATE SCHEMA in 0.01 seconds
2017-04-19 12:45:07,559: On master: COMMIT
2017-04-19 12:45:07,974: Concurrency: 4 threads (target='only')
2017-04-19 12:45:07,974: Using redshift connection "master".
2017-04-19 12:45:07,974: On master: BEGIN
2017-04-19 12:45:07,996: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:07,996: Using redshift connection "master".
2017-04-19 12:45:07,996: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 12:45:08,031: SQL status: SELECT in 0.03 seconds
2017-04-19 12:45:08,032: On master: COMMIT
2017-04-19 12:45:08,043: 
2017-04-19 12:45:08,043: 12:45:08 | Running 20 tests
2017-04-19 12:45:08,043: 12:45:08 | 
2017-04-19 12:45:08,043: 12:45:08 | 1 of 20 START test not_null_shippo_addresses_id...................... [RUN]
2017-04-19 12:45:08,043: Compiling test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:45:08,045: 12:45:08 | 2 of 20 START test unique_shippo_addresses_id........................ [RUN]
2017-04-19 12:45:08,045: 12:45:08 | 3 of 20 START test not_null_shippo_shipments_purpose................. [RUN]
2017-04-19 12:45:08,046: Compiling test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:45:08,046: 12:45:08 | 4 of 20 START test unique_shippo_parcels_id.......................... [RUN]
2017-04-19 12:45:08,046: executing node test.shippo_test.not_null_shippo_addresses_id
2017-04-19 12:45:08,046: Compiling test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:45:08,051: Compiling test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:45:08,052: Acquiring new redshift connection "not_null_shippo_addresses_id".
2017-04-19 12:45:08,052: executing node test.shippo_test.unique_shippo_addresses_id
2017-04-19 12:45:08,055: Opening a new connection (1 currently allocated)
2017-04-19 12:45:08,056: executing node test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 12:45:08,056: Acquiring new redshift connection "unique_shippo_addresses_id".
2017-04-19 12:45:08,056: executing node test.shippo_test.unique_shippo_parcels_id
2017-04-19 12:45:08,057: Acquiring new redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 12:45:08,058: Acquiring new redshift connection "unique_shippo_parcels_id".
2017-04-19 12:45:08,142: Using redshift connection "not_null_shippo_addresses_id".
2017-04-19 12:45:08,142: Opening a new connection (2 currently allocated)
2017-04-19 12:45:08,142: On not_null_shippo_addresses_id: BEGIN
2017-04-19 12:45:08,165: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,165: Using redshift connection "not_null_shippo_addresses_id".
2017-04-19 12:45:08,165: On not_null_shippo_addresses_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:08,200: SQL status: SELECT in 0.03 seconds
2017-04-19 12:45:08,200: On not_null_shippo_addresses_id: COMMIT
2017-04-19 12:45:08,234: Using redshift connection "unique_shippo_addresses_id".
2017-04-19 12:45:08,234: On unique_shippo_addresses_id: BEGIN
2017-04-19 12:45:08,234: Opening a new connection (3 currently allocated)
2017-04-19 12:45:08,257: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,257: Using redshift connection "unique_shippo_addresses_id".
2017-04-19 12:45:08,257: On unique_shippo_addresses_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_addresses"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 12:45:08,316: Using redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 12:45:08,316: On not_null_shippo_shipments_purpose: BEGIN
2017-04-19 12:45:08,317: Opening a new connection (4 currently allocated)
2017-04-19 12:45:08,337: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,337: Using redshift connection "not_null_shippo_shipments_purpose".
2017-04-19 12:45:08,338: On not_null_shippo_shipments_purpose: 

with validation as (

    select
        purpose as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:08,378: SQL status: SELECT in 0.04 seconds
2017-04-19 12:45:08,378: On not_null_shippo_shipments_purpose: COMMIT
2017-04-19 12:45:08,411: Using redshift connection "unique_shippo_parcels_id".
2017-04-19 12:45:08,411: On unique_shippo_parcels_id: BEGIN
2017-04-19 12:45:08,412: 12:45:08 | 1 of 20 PASS not_null_shippo_addresses_id............................ [PASS in 0.37s]
2017-04-19 12:45:08,412: 12:45:08 | 5 of 20 START test not_null_shippo_shipments_status.................. [RUN]
2017-04-19 12:45:08,412: Compiling test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:45:08,414: 12:45:08 | 3 of 20 PASS not_null_shippo_shipments_purpose....................... [PASS in 0.37s]
2017-04-19 12:45:08,415: 12:45:08 | 6 of 20 START test not_null_shippo_parcels_id........................ [RUN]
2017-04-19 12:45:08,415: Compiling test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:45:08,416: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b6ed68>]}
2017-04-19 12:45:08,418: executing node test.shippo_test.not_null_shippo_shipments_status
2017-04-19 12:45:08,419: Acquiring new redshift connection "not_null_shippo_shipments_status".
2017-04-19 12:45:08,419: Re-using an available connection from the pool.
2017-04-19 12:45:08,419: Using redshift connection "not_null_shippo_shipments_status".
2017-04-19 12:45:08,419: On not_null_shippo_shipments_status: BEGIN
2017-04-19 12:45:08,420: executing node test.shippo_test.not_null_shippo_parcels_id
2017-04-19 12:45:08,420: Acquiring new redshift connection "not_null_shippo_parcels_id".
2017-04-19 12:45:08,421: Re-using an available connection from the pool.
2017-04-19 12:45:08,421: Using redshift connection "not_null_shippo_parcels_id".
2017-04-19 12:45:08,421: On not_null_shippo_parcels_id: BEGIN
2017-04-19 12:45:08,435: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,435: Using redshift connection "unique_shippo_parcels_id".
2017-04-19 12:45:08,435: On unique_shippo_parcels_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_parcels"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 12:45:08,439: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,439: Using redshift connection "not_null_shippo_shipments_status".
2017-04-19 12:45:08,439: On not_null_shippo_shipments_status: 

with validation as (

    select
        status as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:08,442: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,442: Using redshift connection "not_null_shippo_parcels_id".
2017-04-19 12:45:08,443: On not_null_shippo_parcels_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:08,483: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b67908>]}
2017-04-19 12:45:08,497: SQL status: SELECT in 0.05 seconds
2017-04-19 12:45:08,497: On not_null_shippo_parcels_id: COMMIT
2017-04-19 12:45:08,502: SQL status: SELECT in 0.06 seconds
2017-04-19 12:45:08,502: On not_null_shippo_shipments_status: COMMIT
2017-04-19 12:45:08,507: 12:45:08 | 6 of 20 PASS not_null_shippo_parcels_id.............................. [PASS in 0.09s]
2017-04-19 12:45:08,507: 12:45:08 | 7 of 20 START test not_null_shippo_shipments_id...................... [RUN]
2017-04-19 12:45:08,508: Compiling test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:45:08,509: executing node test.shippo_test.not_null_shippo_shipments_id
2017-04-19 12:45:08,510: Acquiring new redshift connection "not_null_shippo_shipments_id".
2017-04-19 12:45:08,510: Re-using an available connection from the pool.
2017-04-19 12:45:08,510: Using redshift connection "not_null_shippo_shipments_id".
2017-04-19 12:45:08,510: On not_null_shippo_shipments_id: BEGIN
2017-04-19 12:45:08,512: 12:45:08 | 5 of 20 PASS not_null_shippo_shipments_status........................ [PASS in 0.10s]
2017-04-19 12:45:08,512: 12:45:08 | 8 of 20 START test relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_ [RUN]
2017-04-19 12:45:08,512: Compiling test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 12:45:08,514: executing node test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 12:45:08,515: Acquiring new redshift connection "relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_".
2017-04-19 12:45:08,515: Re-using an available connection from the pool.
2017-04-19 12:45:08,515: Using redshift connection "relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_".
2017-04-19 12:45:08,515: On relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_: BEGIN
2017-04-19 12:45:08,531: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,531: Using redshift connection "not_null_shippo_shipments_id".
2017-04-19 12:45:08,532: On not_null_shippo_shipments_id: 

with validation as (

    select
        id as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:08,535: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,535: Using redshift connection "relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_".
2017-04-19 12:45:08,535: On relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_addresses"

),

child as (

    select
        address_return_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:45:08,559: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b67908>]}
2017-04-19 12:45:08,580: SQL status: SELECT in 0.05 seconds
2017-04-19 12:45:08,580: On not_null_shippo_shipments_id: COMMIT
2017-04-19 12:45:08,591: 12:45:08 | 7 of 20 PASS not_null_shippo_shipments_id............................ [PASS in 0.08s]
2017-04-19 12:45:08,591: 12:45:08 | 9 of 20 START test not_null_shippo_addresses_created_at.............. [RUN]
2017-04-19 12:45:08,591: Compiling test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:45:08,593: executing node test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 12:45:08,594: Acquiring new redshift connection "not_null_shippo_addresses_created_at".
2017-04-19 12:45:08,594: Re-using an available connection from the pool.
2017-04-19 12:45:08,594: Using redshift connection "not_null_shippo_addresses_created_at".
2017-04-19 12:45:08,594: On not_null_shippo_addresses_created_at: BEGIN
2017-04-19 12:45:08,615: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,615: Using redshift connection "not_null_shippo_addresses_created_at".
2017-04-19 12:45:08,615: On not_null_shippo_addresses_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:08,624: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b67908>]}
2017-04-19 12:45:08,652: SQL status: SELECT in 0.04 seconds
2017-04-19 12:45:08,652: On not_null_shippo_addresses_created_at: COMMIT
2017-04-19 12:45:08,663: 12:45:08 | 9 of 20 PASS not_null_shippo_addresses_created_at.................... [PASS in 0.07s]
2017-04-19 12:45:08,663: 12:45:08 | 10 of 20 START test not_null_shippo_addresses_source................. [RUN]
2017-04-19 12:45:08,663: Compiling test.shippo_test.not_null_shippo_addresses_source
2017-04-19 12:45:08,667: executing node test.shippo_test.not_null_shippo_addresses_source
2017-04-19 12:45:08,667: Acquiring new redshift connection "not_null_shippo_addresses_source".
2017-04-19 12:45:08,667: Re-using an available connection from the pool.
2017-04-19 12:45:08,667: Using redshift connection "not_null_shippo_addresses_source".
2017-04-19 12:45:08,667: On not_null_shippo_addresses_source: BEGIN
2017-04-19 12:45:08,690: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,690: Using redshift connection "not_null_shippo_addresses_source".
2017-04-19 12:45:08,690: On not_null_shippo_addresses_source: 

with validation as (

    select
        source as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:08,691: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b67908>]}
2017-04-19 12:45:08,698: SQL status: SELECT in 0.44 seconds
2017-04-19 12:45:08,699: On unique_shippo_addresses_id: COMMIT
2017-04-19 12:45:08,710: 12:45:08 | 2 of 20 PASS unique_shippo_addresses_id.............................. [PASS in 0.66s]
2017-04-19 12:45:08,710: 12:45:08 | 11 of 20 START test unique_shippo_shipments_id....................... [RUN]
2017-04-19 12:45:08,710: Compiling test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:45:08,712: executing node test.shippo_test.unique_shippo_shipments_id
2017-04-19 12:45:08,712: Acquiring new redshift connection "unique_shippo_shipments_id".
2017-04-19 12:45:08,712: Re-using an available connection from the pool.
2017-04-19 12:45:08,712: Using redshift connection "unique_shippo_shipments_id".
2017-04-19 12:45:08,713: On unique_shippo_shipments_id: BEGIN
2017-04-19 12:45:08,736: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,736: SQL status: SELECT in 0.05 seconds
2017-04-19 12:45:08,736: Using redshift connection "unique_shippo_shipments_id".
2017-04-19 12:45:08,736: On not_null_shippo_addresses_source: COMMIT
2017-04-19 12:45:08,736: On unique_shippo_shipments_id: 

with validation as (

    select
        id as unique_field

    from "analytics"."shippo_shipments"
    where id is not null

),

validation_errors as (

    select
        unique_field

    from validation
    group by unique_field
    having count(*) > 1

)

select count(*)
from validation_errors

2017-04-19 12:45:08,758: 12:45:08 | 10 of 20 PASS not_null_shippo_addresses_source....................... [PASS in 0.09s]
2017-04-19 12:45:08,758: 12:45:08 | 12 of 20 START test not_null_shippo_parcels_created_at............... [RUN]
2017-04-19 12:45:08,759: Compiling test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:45:08,762: executing node test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 12:45:08,762: Acquiring new redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 12:45:08,762: Re-using an available connection from the pool.
2017-04-19 12:45:08,763: Using redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 12:45:08,763: On not_null_shippo_parcels_created_at: BEGIN
2017-04-19 12:45:08,764: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b67908>]}
2017-04-19 12:45:08,784: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,784: Using redshift connection "not_null_shippo_parcels_created_at".
2017-04-19 12:45:08,784: On not_null_shippo_parcels_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:08,796: SQL status: SELECT in 0.36 seconds
2017-04-19 12:45:08,796: On unique_shippo_parcels_id: COMMIT
2017-04-19 12:45:08,798: SQL status: SELECT in 0.26 seconds
2017-04-19 12:45:08,798: On relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_: COMMIT
2017-04-19 12:45:08,807: 12:45:08 | 4 of 20 PASS unique_shippo_parcels_id................................ [PASS in 0.76s]
2017-04-19 12:45:08,807: 12:45:08 | 13 of 20 START test not_null_shippo_shipments_state.................. [RUN]
2017-04-19 12:45:08,807: Compiling test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:45:08,809: 12:45:08 | 8 of 20 FAIL 36 relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_ [FAIL 36 in 0.30s]
2017-04-19 12:45:08,809: 12:45:08 | 14 of 20 START test relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_ [RUN]
2017-04-19 12:45:08,809: Compiling test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 12:45:08,812: executing node test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 12:45:08,813: Acquiring new redshift connection "relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_".
2017-04-19 12:45:08,813: Re-using an available connection from the pool.
2017-04-19 12:45:08,813: Using redshift connection "relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_".
2017-04-19 12:45:08,813: On relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_: BEGIN
2017-04-19 12:45:08,813: executing node test.shippo_test.not_null_shippo_shipments_state
2017-04-19 12:45:08,814: Acquiring new redshift connection "not_null_shippo_shipments_state".
2017-04-19 12:45:08,814: Re-using an available connection from the pool.
2017-04-19 12:45:08,814: Using redshift connection "not_null_shippo_shipments_state".
2017-04-19 12:45:08,814: On not_null_shippo_shipments_state: BEGIN
2017-04-19 12:45:08,826: SQL status: SELECT in 0.04 seconds
2017-04-19 12:45:08,826: On not_null_shippo_parcels_created_at: COMMIT
2017-04-19 12:45:08,830: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63748>]}
2017-04-19 12:45:08,833: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,833: Using redshift connection "relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_".
2017-04-19 12:45:08,833: On relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_addresses"

),

child as (

    select
        address_to_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:45:08,836: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,836: Using redshift connection "not_null_shippo_shipments_state".
2017-04-19 12:45:08,837: On not_null_shippo_shipments_state: 

with validation as (

    select
        state as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:08,837: 12:45:08 | 12 of 20 PASS not_null_shippo_parcels_created_at..................... [PASS in 0.08s]
2017-04-19 12:45:08,837: 12:45:08 | 15 of 20 START test relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_ [RUN]
2017-04-19 12:45:08,838: Compiling test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:45:08,840: executing node test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 12:45:08,840: Acquiring new redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:45:08,840: Re-using an available connection from the pool.
2017-04-19 12:45:08,840: Using redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:45:08,841: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: BEGIN
2017-04-19 12:45:08,876: SQL status: BEGIN in 0.04 seconds
2017-04-19 12:45:08,876: Using redshift connection "relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_".
2017-04-19 12:45:08,876: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_parcels"

),

child as (

    select
        parcel_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:45:08,893: SQL status: SELECT in 0.06 seconds
2017-04-19 12:45:08,893: On not_null_shippo_shipments_state: COMMIT
2017-04-19 12:45:08,898: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63748>]}
2017-04-19 12:45:08,905: 12:45:08 | 13 of 20 PASS not_null_shippo_shipments_state........................ [PASS in 0.10s]
2017-04-19 12:45:08,905: 12:45:08 | 16 of 20 START test not_null_shippo_addresses_object_state........... [RUN]
2017-04-19 12:45:08,905: Compiling test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 12:45:08,907: executing node test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 12:45:08,908: Acquiring new redshift connection "not_null_shippo_addresses_object_state".
2017-04-19 12:45:08,908: Re-using an available connection from the pool.
2017-04-19 12:45:08,908: Using redshift connection "not_null_shippo_addresses_object_state".
2017-04-19 12:45:08,908: On not_null_shippo_addresses_object_state: BEGIN
2017-04-19 12:45:08,909: SQL status: SELECT in 0.17 seconds
2017-04-19 12:45:08,909: On unique_shippo_shipments_id: COMMIT
2017-04-19 12:45:08,920: 12:45:08 | 11 of 20 PASS unique_shippo_shipments_id............................. [PASS in 0.21s]
2017-04-19 12:45:08,921: 12:45:08 | 17 of 20 START test relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_ [RUN]
2017-04-19 12:45:08,921: Compiling test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 12:45:08,924: executing node test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 12:45:08,925: Acquiring new redshift connection "relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_".
2017-04-19 12:45:08,925: Re-using an available connection from the pool.
2017-04-19 12:45:08,925: Using redshift connection "relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_".
2017-04-19 12:45:08,925: On relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_: BEGIN
2017-04-19 12:45:08,930: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,930: Using redshift connection "not_null_shippo_addresses_object_state".
2017-04-19 12:45:08,930: On not_null_shippo_addresses_object_state: 

with validation as (

    select
        object_state as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:08,948: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:08,948: Using redshift connection "relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_".
2017-04-19 12:45:08,948: On relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_: 

with parent as (

    select
        id as id

    from "analytics"."shippo_addresses"

),

child as (

    select
        address_from_id as id

    from "analytics"."shippo_shipments"

)

select count(*)
from child
where id is not null
  and id not in (select id from parent)

2017-04-19 12:45:08,972: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63748>]}
2017-04-19 12:45:08,974: SQL status: SELECT in 0.04 seconds
2017-04-19 12:45:08,975: On not_null_shippo_addresses_object_state: COMMIT
2017-04-19 12:45:08,986: 12:45:08 | 16 of 20 PASS not_null_shippo_addresses_object_state................. [PASS in 0.08s]
2017-04-19 12:45:08,986: 12:45:08 | 18 of 20 START test not_null_shippo_shipments_created_at............. [RUN]
2017-04-19 12:45:08,986: Compiling test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:45:08,988: executing node test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 12:45:08,989: Acquiring new redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 12:45:08,989: Re-using an available connection from the pool.
2017-04-19 12:45:08,989: Using redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 12:45:08,989: On not_null_shippo_shipments_created_at: BEGIN
2017-04-19 12:45:09,012: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:09,012: Using redshift connection "not_null_shippo_shipments_created_at".
2017-04-19 12:45:09,012: On not_null_shippo_shipments_created_at: 

with validation as (

    select
        created_at as not_null_field

    from "analytics"."shippo_shipments"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:09,038: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63748>]}
2017-04-19 12:45:09,048: SQL status: SELECT in 0.04 seconds
2017-04-19 12:45:09,048: On not_null_shippo_shipments_created_at: COMMIT
2017-04-19 12:45:09,059: 12:45:09 | 18 of 20 PASS not_null_shippo_shipments_created_at................... [PASS in 0.07s]
2017-04-19 12:45:09,059: 12:45:09 | 19 of 20 START test not_null_shippo_addresses_purpose................ [RUN]
2017-04-19 12:45:09,059: Compiling test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:45:09,061: executing node test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 12:45:09,061: Acquiring new redshift connection "not_null_shippo_addresses_purpose".
2017-04-19 12:45:09,061: Re-using an available connection from the pool.
2017-04-19 12:45:09,062: Using redshift connection "not_null_shippo_addresses_purpose".
2017-04-19 12:45:09,062: On not_null_shippo_addresses_purpose: BEGIN
2017-04-19 12:45:09,084: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:09,084: Using redshift connection "not_null_shippo_addresses_purpose".
2017-04-19 12:45:09,084: On not_null_shippo_addresses_purpose: 

with validation as (

    select
        purpose as not_null_field

    from "analytics"."shippo_addresses"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:09,108: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63748>]}
2017-04-19 12:45:09,122: SQL status: SELECT in 0.04 seconds
2017-04-19 12:45:09,122: On not_null_shippo_addresses_purpose: COMMIT
2017-04-19 12:45:09,134: 12:45:09 | 19 of 20 PASS not_null_shippo_addresses_purpose...................... [PASS in 0.07s]
2017-04-19 12:45:09,134: 12:45:09 | 20 of 20 START test not_null_shippo_parcels_state.................... [RUN]
2017-04-19 12:45:09,134: Compiling test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:45:09,136: executing node test.shippo_test.not_null_shippo_parcels_state
2017-04-19 12:45:09,136: Acquiring new redshift connection "not_null_shippo_parcels_state".
2017-04-19 12:45:09,136: Re-using an available connection from the pool.
2017-04-19 12:45:09,136: Using redshift connection "not_null_shippo_parcels_state".
2017-04-19 12:45:09,136: On not_null_shippo_parcels_state: BEGIN
2017-04-19 12:45:09,161: SQL status: BEGIN in 0.02 seconds
2017-04-19 12:45:09,161: Using redshift connection "not_null_shippo_parcels_state".
2017-04-19 12:45:09,162: On not_null_shippo_parcels_state: 

with validation as (

    select
        state as not_null_field

    from "analytics"."shippo_parcels"

)

select count(*)
from validation
where not_null_field is null

2017-04-19 12:45:09,171: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63748>]}
2017-04-19 12:45:09,188: SQL status: SELECT in 0.36 seconds
2017-04-19 12:45:09,189: On relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_: COMMIT
2017-04-19 12:45:09,199: 12:45:09 | 14 of 20 FAIL 36 relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_ [FAIL 36 in 0.39s]
2017-04-19 12:45:09,206: SQL status: SELECT in 0.04 seconds
2017-04-19 12:45:09,206: On not_null_shippo_parcels_state: COMMIT
2017-04-19 12:45:09,217: 12:45:09 | 20 of 20 PASS not_null_shippo_parcels_state.......................... [PASS in 0.08s]
2017-04-19 12:45:09,236: SQL status: SELECT in 0.36 seconds
2017-04-19 12:45:09,237: On relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_: COMMIT
2017-04-19 12:45:09,240: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63748>]}
2017-04-19 12:45:09,247: 12:45:09 | 15 of 20 FAIL 21 relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_ [FAIL 21 in 0.41s]
2017-04-19 12:45:09,261: SQL status: SELECT in 0.31 seconds
2017-04-19 12:45:09,262: On relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_: COMMIT
2017-04-19 12:45:09,272: 12:45:09 | 17 of 20 FAIL 36 relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_ [FAIL 36 in 0.35s]
2017-04-19 12:45:09,305: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63748>]}
2017-04-19 12:45:09,372: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63748>]}
2017-04-19 12:45:09,440: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b6e048>]}
2017-04-19 12:45:09,511: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b6e048>]}
2017-04-19 12:45:09,575: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5aba8>]}
2017-04-19 12:45:09,651: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5aba8>]}
2017-04-19 12:45:09,737: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9545900c-e327-4f69-85b9-abe7439a2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5aba8>]}
2017-04-19 12:45:09,894: 12:45:09 | 
2017-04-19 12:45:09,894: 12:45:09 | Finished running 20 tests in 1.85s.
2017-04-19 12:45:09,895: Connection 'master' was left open.
2017-04-19 12:45:09,895: Done. PASS=16 ERROR=4 SKIP=0 TOTAL=20
2017-04-19 12:45:09,896: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa1a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa1f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa1ac8>]}
2017-04-19 12:45:09,960: Flushing usage events
2017-04-19 21:29:29,977: Tracking: tracking
2017-04-19 21:29:29,979: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ae6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ae438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134aeb38>]}
2017-04-19 21:29:30,286: Executing "git clone --depth 1 https://github.com/fishtown-analytics/shopify.git"
2017-04-19 21:29:30,569: Pulling new dependency shopify.
2017-04-19 21:29:30,569: Executing "git rev-parse HEAD"
2017-04-19 21:29:30,574:   Checking out branch master.
2017-04-19 21:29:30,575: Executing "git remote set-branches origin master"
2017-04-19 21:29:30,581: Executing "git fetch --depth 1 origin master"
2017-04-19 21:29:30,786: Executing "git reset --hard origin/master"
2017-04-19 21:29:30,795: Executing "git rev-parse HEAD"
2017-04-19 21:29:30,801:   Checked out at 7e3b86.
2017-04-19 21:29:30,851: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ae6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134984a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113498a58>]}
2017-04-19 21:29:30,960: Flushing usage events
2017-04-19 21:31:53,101: Tracking: tracking
2017-04-19 21:31:53,101: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ccac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ccc88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6cca20>]}
2017-04-19 21:31:53,239: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 21:31:53,291: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 21:31:53,338: Parsing materializations/incremental.sql
2017-04-19 21:31:53,356: Parsing materializations/table.sql
2017-04-19 21:31:53,365: Parsing materializations/view.sql
2017-04-19 21:31:53,369: Parsing materializations/wrapper.sql
2017-04-19 21:31:53,372: Parsing schema_tests/accepted_values.sql
2017-04-19 21:31:53,375: Parsing schema_tests/not_null.sql
2017-04-19 21:31:53,377: Parsing schema_tests/relationships.sql
2017-04-19 21:31:53,379: Parsing schema_tests/unique.sql
2017-04-19 21:31:53,386: Parsing model.shippo_test.shippo_addresses
2017-04-19 21:31:53,388: Parsing model.shippo_test.shippo_parcels
2017-04-19 21:31:53,389: Parsing model.shippo_test.shippo_shipments
2017-04-19 21:31:53,394: Parsing model.shopify.shopify_checkouts
2017-04-19 21:31:53,396: Parsing model.shopify.shopify_customers
2017-04-19 21:31:53,398: Parsing model.shopify.shopify_discount_codes
2017-04-19 21:31:53,399: Parsing model.shopify.shopify_order_items
2017-04-19 21:31:53,400: Parsing model.shopify.shopify_orders
2017-04-19 21:31:53,402: Parsing model.shopify.shopify_products
2017-04-19 21:31:53,404: Parsing model.shopify.shopify_refunds
2017-04-19 21:31:53,405: Parsing model.shopify.shopify_transactions
2017-04-19 21:31:53,407: Parsing model.shopify.shopify_orders_xf
2017-04-19 21:31:53,422: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 21:31:53,424: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 21:31:53,425: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 21:31:53,427: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 21:31:53,428: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 21:31:53,429: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 21:31:53,430: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 21:31:53,431: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 21:31:53,433: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 21:31:53,434: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 21:31:53,435: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 21:31:53,437: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 21:31:53,438: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 21:31:53,440: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 21:31:53,441: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 21:31:53,442: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 21:31:53,444: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 21:31:53,445: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 21:31:53,446: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 21:31:53,447: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 21:31:53,459: Parsing test.shopify.unique_shopify_orders_cart_token
2017-04-19 21:31:53,460: Parsing test.shopify.unique_shopify_orders_id
2017-04-19 21:31:53,461: Parsing test.shopify.not_null_shopify_orders_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 21:31:53,463: Parsing test.shopify.not_null_shopify_orders_id
2017-04-19 21:31:53,464: Parsing test.shopify.relationships_shopify_orders_id__customer_id__shopify_customers
2017-04-19 21:31:53,465: Parsing test.shopify.unique_shopify_checkouts_cart_token
2017-04-19 21:31:53,466: Parsing test.shopify.unique_shopify_checkouts_id
2017-04-19 21:31:53,468: Parsing test.shopify.not_null_shopify_checkouts_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 21:31:53,469: Parsing test.shopify.not_null_shopify_checkouts_id
2017-04-19 21:31:53,470: Parsing test.shopify.relationships_shopify_checkouts_id__customer_id__shopify_customers
2017-04-19 21:31:53,471: Parsing test.shopify.unique_shopify_customers_id
2017-04-19 21:31:53,472: Parsing test.shopify.not_null_shopify_customers_id
2017-04-19 21:31:53,474: Parsing test.shopify.not_null_shopify_discount_codes_order_id
2017-04-19 21:31:53,475: Parsing test.shopify.relationships_shopify_discount_codes_id__order_id__shopify_orders
2017-04-19 21:31:53,476: Parsing test.shopify.not_null_shopify_transactions_id
2017-04-19 21:31:53,477: Parsing test.shopify.not_null_shopify_transactions_order_id
2017-04-19 21:31:53,478: Parsing test.shopify.unique_shopify_transactions_id
2017-04-19 21:31:53,480: Parsing test.shopify.relationships_shopify_transactions_id__order_id__shopify_orders
2017-04-19 21:31:53,481: Parsing test.shopify.not_null_shopify_refunds_id
2017-04-19 21:31:53,482: Parsing test.shopify.not_null_shopify_refunds_order_id
2017-04-19 21:31:53,483: Parsing test.shopify.unique_shopify_refunds_id
2017-04-19 21:31:53,485: Parsing test.shopify.relationships_shopify_refunds_id__order_id__shopify_orders
2017-04-19 21:31:53,486: Parsing test.shopify.not_null_shopify_products_id
2017-04-19 21:31:53,487: Parsing test.shopify.unique_shopify_products_id
2017-04-19 21:31:53,489: Parsing test.shopify.not_null_shopify_order_items_id
2017-04-19 21:31:53,490: Parsing test.shopify.not_null_shopify_order_items_order_id
2017-04-19 21:31:53,491: Parsing test.shopify.unique_shopify_order_items_id
2017-04-19 21:31:53,492: Parsing test.shopify.relationships_shopify_order_items_id__order_id__shopify_orders
2017-04-19 21:31:53,493: Parsing test.shopify.relationships_shopify_order_items_id__product_id__shopify_products
2017-04-19 21:31:53,496: Compiled 12 models, 49 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 21:31:53,499: Acquiring new redshift connection "master".
2017-04-19 21:31:53,499: Opening a new connection (0 currently allocated)
2017-04-19 21:31:53,842: Using redshift connection "master".
2017-04-19 21:31:53,842: On master: BEGIN
2017-04-19 21:31:53,921: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:31:53,921: Creating schema "analytics".
2017-04-19 21:31:53,921: Using redshift connection "master".
2017-04-19 21:31:53,921: On master: create schema if not exists "analytics"
2017-04-19 21:31:53,955: SQL status: CREATE SCHEMA in 0.03 seconds
2017-04-19 21:31:53,955: On master: COMMIT
2017-04-19 21:31:54,283: Concurrency: 4 threads (target='only')
2017-04-19 21:31:54,283: Using redshift connection "master".
2017-04-19 21:31:54,284: On master: BEGIN
2017-04-19 21:31:54,352: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:31:54,353: Using redshift connection "master".
2017-04-19 21:31:54,353: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:54,408: SQL status: SELECT in 0.06 seconds
2017-04-19 21:31:54,409: On master: COMMIT
2017-04-19 21:31:54,449: 
2017-04-19 21:31:54,450: 21:31:54 | Running 12 view models
2017-04-19 21:31:54,450: 21:31:54 | 
2017-04-19 21:31:54,450: Using redshift connection "master".
2017-04-19 21:31:54,450: On master: BEGIN
2017-04-19 21:31:54,523: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:31:54,524: On master: COMMIT
2017-04-19 21:31:54,587: 21:31:54 | 1 of 12 START view model analytics.shopify_customers................. [RUN]
2017-04-19 21:31:54,588: Compiling model.shopify.shopify_customers
2017-04-19 21:31:54,590: Acquiring new redshift connection "shopify_customers".
2017-04-19 21:31:54,590: Opening a new connection (1 currently allocated)
2017-04-19 21:31:54,591: 21:31:54 | 2 of 12 START view model analytics.shippo_parcels.................... [RUN]
2017-04-19 21:31:54,591: Compiling model.shippo_test.shippo_parcels
2017-04-19 21:31:54,593: Acquiring new redshift connection "shippo_parcels".
2017-04-19 21:31:54,593: 21:31:54 | 3 of 12 START view model analytics.shopify_refunds................... [RUN]
2017-04-19 21:31:54,593: Compiling model.shopify.shopify_refunds
2017-04-19 21:31:54,595: Acquiring new redshift connection "shopify_refunds".
2017-04-19 21:31:54,595: 21:31:54 | 4 of 12 START view model analytics.shopify_checkouts................. [RUN]
2017-04-19 21:31:54,595: Compiling model.shopify.shopify_checkouts
2017-04-19 21:31:54,598: Acquiring new redshift connection "shopify_checkouts".
2017-04-19 21:31:54,928: Using redshift connection "shopify_customers".
2017-04-19 21:31:54,928: On shopify_customers: BEGIN
2017-04-19 21:31:54,928: Opening a new connection (2 currently allocated)
2017-04-19 21:31:54,999: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:31:54,999: Using redshift connection "shopify_customers".
2017-04-19 21:31:54,999: On shopify_customers: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:55,055: SQL status: SELECT in 0.06 seconds
2017-04-19 21:31:55,057: executing node model.shopify.shopify_customers
2017-04-19 21:31:55,059: Using redshift connection "shopify_customers".
2017-04-19 21:31:55,059: On shopify_customers: -- Compiled by DBT

    

    create view "analytics"."shopify_customers__dbt_tmp" as (
        select
  id,
  first_name,
  last_name,
  email,
  verified_email,
  default_address__id as default_address_id,
  note,
  state,
  tags,
  tax_exempt,
  created_at,
  updated_at
from
  shippo_chooze_shopify.customers
    );

    
2017-04-19 21:31:55,070: Using redshift connection "shippo_parcels".
2017-04-19 21:31:55,070: On shippo_parcels: BEGIN
2017-04-19 21:31:55,070: Opening a new connection (3 currently allocated)
2017-04-19 21:31:55,110: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:31:55,110: Using redshift connection "shippo_parcels".
2017-04-19 21:31:55,110: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:55,129: SQL status: CREATE VIEW in 0.07 seconds
2017-04-19 21:31:55,129: Using redshift connection "shopify_customers".
2017-04-19 21:31:55,129: On shopify_customers: alter table "analytics"."shopify_customers__dbt_tmp" rename to "shopify_customers"
2017-04-19 21:31:55,154: SQL status: SELECT in 0.04 seconds
2017-04-19 21:31:55,155: executing node model.shippo_test.shippo_parcels
2017-04-19 21:31:55,156: Using redshift connection "shippo_parcels".
2017-04-19 21:31:55,156: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 21:31:55,163: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 21:31:55,164: On shopify_customers: COMMIT
2017-04-19 21:31:55,180: SQL status: CREATE VIEW in 0.02 seconds
2017-04-19 21:31:55,180: On shippo_parcels: COMMIT
2017-04-19 21:31:55,453: Using redshift connection "shopify_refunds".
2017-04-19 21:31:55,453: On shopify_refunds: BEGIN
2017-04-19 21:31:55,453: Opening a new connection (4 currently allocated)
2017-04-19 21:31:55,564: SQL status: BEGIN in 0.11 seconds
2017-04-19 21:31:55,564: Using redshift connection "shopify_refunds".
2017-04-19 21:31:55,565: On shopify_refunds: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:55,623: SQL status: SELECT in 0.06 seconds
2017-04-19 21:31:55,625: executing node model.shopify.shopify_refunds
2017-04-19 21:31:55,626: Using redshift connection "shopify_refunds".
2017-04-19 21:31:55,626: On shopify_refunds: -- Compiled by DBT

    

    create view "analytics"."shopify_refunds__dbt_tmp" as (
        select

  id,
  order_id,
  user_id,
  restock,
  note,
  created_at

from
  shippo_chooze_shopify.order_refunds
    );

    
2017-04-19 21:31:55,773: Using redshift connection "shopify_checkouts".
2017-04-19 21:31:55,774: On shopify_checkouts: BEGIN
2017-04-19 21:31:55,774: 21:31:55 | 1 of 12 OK created view model analytics.shopify_customers............ [CREATE VIEW in 1.19s]
2017-04-19 21:31:55,774: 21:31:55 | 5 of 12 START view model analytics.shopify_orders.................... [RUN]
2017-04-19 21:31:55,774: Compiling model.shopify.shopify_orders
2017-04-19 21:31:55,777: Acquiring new redshift connection "shopify_orders".
2017-04-19 21:31:55,777: Re-using an available connection from the pool.
2017-04-19 21:31:55,778: Using redshift connection "shopify_orders".
2017-04-19 21:31:55,778: On shopify_orders: BEGIN
2017-04-19 21:31:55,778: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7d7208>]}
2017-04-19 21:31:55,846: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:31:55,846: Using redshift connection "shopify_orders".
2017-04-19 21:31:55,847: On shopify_orders: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:55,858: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:31:55,858: Using redshift connection "shopify_checkouts".
2017-04-19 21:31:55,858: On shopify_checkouts: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:55,887: Using redshift connection "shippo_parcels".
2017-04-19 21:31:55,887: On shippo_parcels: BEGIN
2017-04-19 21:31:55,900: SQL status: SELECT in 0.05 seconds
2017-04-19 21:31:55,902: executing node model.shopify.shopify_orders
2017-04-19 21:31:55,904: Using redshift connection "shopify_orders".
2017-04-19 21:31:55,904: On shopify_orders: -- Compiled by DBT

    

    create view "analytics"."shopify_orders__dbt_tmp" as (
        -- see shopify docs here:
-- https://help.shopify.com/api/reference/order

select
  -- ids
  id,
  customer__id as customer_id,
  checkout_id,
  nullif(cart_token, '') as cart_token,
  nullif(checkout_token, '') as checkout_token,
  nullif(token, '') as token,

  -- logical ids reported in the application
  "number",
  order_number,

  -- state
  financial_status,
  fulfillment_status,
  confirmed,

  -- cancellation information
  cancel_reason,
  cancelled_at,

  -- etc
  closed_at,
  processed_at,
  email,
  contact_email,
  name,
  note,
  tags,

  -- attribution
  browser_ip,
  source_name,
  landing_site,
  landing_site_ref,
  referring_site,

  -- financial
  currency,
  processing_method,

  -- numbers
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_price_usd,
  total_tax,
  total_weight,

  -- point of sale info
  user_id,
  location_id,

  -- address
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,

  -- audit
  created_at,
  updated_at

from
  shippo_chooze_shopify.orders

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 21:31:55,921: SQL status: SELECT in 0.06 seconds
2017-04-19 21:31:55,923: executing node model.shopify.shopify_checkouts
2017-04-19 21:31:55,924: Using redshift connection "shopify_checkouts".
2017-04-19 21:31:55,924: On shopify_checkouts: -- Compiled by DBT

    

    create view "analytics"."shopify_checkouts__dbt_tmp" as (
        select
  id,
  customer__id as customer_id,
  email,
  nullif(cart_token, '') as cart_token,
  nullif(token, '') as token,
  abandoned_checkout_url,
  name,
  completed_at,
  currency,
  gateway,
  landing_site,
  note,
  source_name,
  referring_site,
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_tax,
  total_weight,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  updated_at,
  created_at
from
  shippo_chooze_shopify.checkouts
    );

    
2017-04-19 21:31:55,929: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:31:55,929: Using redshift connection "shippo_parcels".
2017-04-19 21:31:55,929: On shippo_parcels: drop view if exists "analytics"."shippo_parcels" cascade
2017-04-19 21:31:55,945: Postgres error: column "landing_site_ref" does not exist in orders

2017-04-19 21:31:55,945: On shopify_orders: ROLLBACK
2017-04-19 21:31:55,947: SQL status: CREATE VIEW in 0.32 seconds
2017-04-19 21:31:55,948: Using redshift connection "shopify_refunds".
2017-04-19 21:31:55,948: On shopify_refunds: alter table "analytics"."shopify_refunds__dbt_tmp" rename to "shopify_refunds"
2017-04-19 21:31:55,981: Error executing target/build/shopify/base/shopify_orders.sql
column "landing_site_ref" does not exist in orders
2017-04-19 21:31:55,981: 21:31:55 | 5 of 12 ERROR creating view model analytics.shopify_orders........... [ERROR in 0.21s]
2017-04-19 21:31:55,981: 21:31:55 | 6 of 12 START view model analytics.shippo_shipments.................. [RUN]
2017-04-19 21:31:55,982: Compiling model.shippo_test.shippo_shipments
2017-04-19 21:31:55,984: Acquiring new redshift connection "shippo_shipments".
2017-04-19 21:31:55,984: Re-using an available connection from the pool.
2017-04-19 21:31:55,984: Using redshift connection "shippo_shipments".
2017-04-19 21:31:55,984: On shippo_shipments: BEGIN
2017-04-19 21:31:55,984: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b201908>]}
2017-04-19 21:31:56,023: SQL status: ALTER TABLE in 0.08 seconds
2017-04-19 21:31:56,023: On shopify_refunds: COMMIT
2017-04-19 21:31:56,060: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:31:56,060: Using redshift connection "shippo_shipments".
2017-04-19 21:31:56,060: On shippo_shipments: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:56,097: Error executing target/build/shopify/base/shopify_orders.sql
column "landing_site_ref" does not exist in orders
2017-04-19 21:31:56,112: SQL status: SELECT in 0.05 seconds
2017-04-19 21:31:56,114: executing node model.shippo_test.shippo_shipments
2017-04-19 21:31:56,115: Using redshift connection "shippo_shipments".
2017-04-19 21:31:56,115: On shippo_shipments: -- Compiled by DBT

    

    create view "analytics"."shippo_shipments__dbt_tmp" as (
        select

    object_id as id,

    address_from as address_from_id,
    address_return as address_return_id,
    address_to as address_to_id,
    parcel as parcel_id,

    insurance_amount::float,
    insurance_currency,

    rates_url,
    return_of,
    submission_date,
    lower(submission_type) as submission_type,
    customs_declaration,


    object_owner as owner,
    lower(object_state) as state,
    lower(object_purpose) as purpose,
    lower(object_status) as status,


    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments
    );

    
2017-04-19 21:31:56,253: SQL status: DROP VIEW in 0.32 seconds
2017-04-19 21:31:56,254: On shippo_parcels: COMMIT
2017-04-19 21:31:56,638: SQL status: CREATE VIEW in 0.52 seconds
2017-04-19 21:31:56,641: SQL status: CREATE VIEW in 0.72 seconds
2017-04-19 21:31:56,641: Using redshift connection "shopify_checkouts".
2017-04-19 21:31:56,642: On shopify_checkouts: alter table "analytics"."shopify_checkouts__dbt_tmp" rename to "shopify_checkouts"
2017-04-19 21:31:56,683: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:31:56,683: On shopify_checkouts: COMMIT
2017-04-19 21:31:56,715: 21:31:56 | 3 of 12 OK created view model analytics.shopify_refunds.............. [CREATE VIEW in 2.12s]
2017-04-19 21:31:56,715: 21:31:56 | 7 of 12 START view model analytics.shopify_transactions.............. [RUN]
2017-04-19 21:31:56,715: Compiling model.shopify.shopify_transactions
2017-04-19 21:31:56,717: Acquiring new redshift connection "shopify_transactions".
2017-04-19 21:31:56,717: Re-using an available connection from the pool.
2017-04-19 21:31:56,717: Using redshift connection "shopify_transactions".
2017-04-19 21:31:56,717: On shopify_transactions: BEGIN
2017-04-19 21:31:56,717: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b201b00>]}
2017-04-19 21:31:56,798: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:31:56,798: Using redshift connection "shopify_transactions".
2017-04-19 21:31:56,799: On shopify_transactions: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:56,817: Using redshift connection "shippo_parcels".
2017-04-19 21:31:56,817: On shippo_parcels: BEGIN
2017-04-19 21:31:56,856: SQL status: SELECT in 0.06 seconds
2017-04-19 21:31:56,858: executing node model.shopify.shopify_transactions
2017-04-19 21:31:56,858: Using redshift connection "shopify_transactions".
2017-04-19 21:31:56,858: On shopify_transactions: -- Compiled by DBT

    

    create view "analytics"."shopify_transactions__dbt_tmp" as (
        select

  id,
  parent_id,
  order_id,

  status,
  error_code,
  message,

  kind,
  amount,
  "authorization",
  currency,
  gateway,

  source_name,

  created_at

from
  shippo_chooze_shopify.transactions

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 21:31:56,860: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:31:56,860: Using redshift connection "shippo_parcels".
2017-04-19 21:31:56,860: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 21:31:56,860: On shippo_shipments: COMMIT
2017-04-19 21:31:56,884: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:31:56,884: On shippo_parcels: COMMIT
2017-04-19 21:31:57,764: SQL status: CREATE VIEW in 0.91 seconds
2017-04-19 21:31:57,764: Using redshift connection "shopify_transactions".
2017-04-19 21:31:57,764: On shopify_transactions: alter table "analytics"."shopify_transactions__dbt_tmp" rename to "shopify_transactions"
2017-04-19 21:31:57,799: 21:31:57 | 4 of 12 OK created view model analytics.shopify_checkouts............ [CREATE VIEW in 3.20s]
2017-04-19 21:31:57,799: 21:31:57 | 8 of 12 START view model analytics.shippo_addresses.................. [RUN]
2017-04-19 21:31:57,799: Compiling model.shippo_test.shippo_addresses
2017-04-19 21:31:57,801: Acquiring new redshift connection "shippo_addresses".
2017-04-19 21:31:57,801: Re-using an available connection from the pool.
2017-04-19 21:31:57,801: Using redshift connection "shippo_addresses".
2017-04-19 21:31:57,801: On shippo_addresses: BEGIN
2017-04-19 21:31:57,801: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b826400>]}
2017-04-19 21:31:57,882: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:31:57,882: Using redshift connection "shippo_addresses".
2017-04-19 21:31:57,882: On shippo_addresses: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:57,912: SQL status: ALTER TABLE in 0.15 seconds
2017-04-19 21:31:57,912: On shopify_transactions: COMMIT
2017-04-19 21:31:57,937: SQL status: SELECT in 0.05 seconds
2017-04-19 21:31:57,938: executing node model.shippo_test.shippo_addresses
2017-04-19 21:31:57,939: Using redshift connection "shippo_addresses".
2017-04-19 21:31:57,939: On shippo_addresses: -- Compiled by DBT

    

    create view "analytics"."shippo_addresses__dbt_tmp" as (
        select

    object_id as id,

    name,
    company,

    street1,
    street2,
    street3,
    street_no,

    city,
    state,
    zip,
    country,

    email,
    phone,

    is_residential,

    object_owner as owner,
    lower(object_purpose) as purpose,
    lower(object_source) as source,
    lower(object_state) as object_state,

    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.addresses
    );

    
2017-04-19 21:31:58,583: SQL status: CREATE VIEW in 0.64 seconds
2017-04-19 21:31:58,696: Using redshift connection "shippo_shipments".
2017-04-19 21:31:58,696: On shippo_shipments: BEGIN
2017-04-19 21:31:58,767: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:31:58,767: Using redshift connection "shippo_shipments".
2017-04-19 21:31:58,767: On shippo_shipments: drop view if exists "analytics"."shippo_shipments" cascade
2017-04-19 21:31:58,780: 21:31:58 | 2 of 12 OK created view model analytics.shippo_parcels............... [CREATE VIEW in 4.19s]
2017-04-19 21:31:58,781: 21:31:58 | 9 of 12 START view model analytics.shopify_order_items............... [RUN]
2017-04-19 21:31:58,781: Compiling model.shopify.shopify_order_items
2017-04-19 21:31:58,782: Acquiring new redshift connection "shopify_order_items".
2017-04-19 21:31:58,783: Re-using an available connection from the pool.
2017-04-19 21:31:58,783: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b826048>]}
2017-04-19 21:31:58,783: Using redshift connection "shopify_order_items".
2017-04-19 21:31:58,784: On shopify_order_items: BEGIN
2017-04-19 21:31:58,821: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:31:58,821: Using redshift connection "shopify_order_items".
2017-04-19 21:31:58,821: On shopify_order_items: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:58,877: SQL status: SELECT in 0.06 seconds
2017-04-19 21:31:58,878: executing node model.shopify.shopify_order_items
2017-04-19 21:31:58,878: Using redshift connection "shopify_order_items".
2017-04-19 21:31:58,878: On shopify_order_items: -- Compiled by DBT

    

    create view "analytics"."shopify_order_items__dbt_tmp" as (
        select

  id,
  product_id,
  _sdc_source_key_id as order_id,
  sku,
  name,
  title,
  vendor,
  quantity,
  pre_tax_price,
  price,
  taxable,
  gift_card,
  total_discount,
  grams

from
  shippo_chooze_shopify.orders__line_items
    );

    
2017-04-19 21:31:58,895: Postgres error: column "pre_tax_price" does not exist in orders__line_items

2017-04-19 21:31:58,895: On shopify_order_items: ROLLBACK
2017-04-19 21:31:58,914: Error executing target/build/shopify/base/shopify_order_items.sql
column "pre_tax_price" does not exist in orders__line_items
2017-04-19 21:31:58,914: 21:31:58 | 9 of 12 ERROR creating view model analytics.shopify_order_items...... [ERROR in 0.13s]
2017-04-19 21:31:58,914: 21:31:58 | 10 of 12 START view model analytics.shopify_discount_codes........... [RUN]
2017-04-19 21:31:58,914: Compiling model.shopify.shopify_discount_codes
2017-04-19 21:31:58,916: Acquiring new redshift connection "shopify_discount_codes".
2017-04-19 21:31:58,916: Re-using an available connection from the pool.
2017-04-19 21:31:58,916: Using redshift connection "shopify_discount_codes".
2017-04-19 21:31:58,916: On shopify_discount_codes: BEGIN
2017-04-19 21:31:58,916: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b229898>]}
2017-04-19 21:31:58,957: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:31:58,957: Using redshift connection "shopify_discount_codes".
2017-04-19 21:31:58,957: On shopify_discount_codes: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:58,995: SQL status: SELECT in 0.04 seconds
2017-04-19 21:31:58,996: executing node model.shopify.shopify_discount_codes
2017-04-19 21:31:58,997: Using redshift connection "shopify_discount_codes".
2017-04-19 21:31:58,997: On shopify_discount_codes: -- Compiled by DBT

    

    create view "analytics"."shopify_discount_codes__dbt_tmp" as (
        select

  _sdc_source_key_id as order_id,
  code,
  amount,
  type

from
  shippo_chooze_shopify.orders__discount_codes
    );

    
2017-04-19 21:31:59,012: Error executing target/build/shopify/base/shopify_order_items.sql
column "pre_tax_price" does not exist in orders__line_items
2017-04-19 21:31:59,167: 21:31:59 | 7 of 12 OK created view model analytics.shopify_transactions......... [CREATE VIEW in 2.45s]
2017-04-19 21:31:59,167: 21:31:59 | 11 of 12 START view model analytics.shopify_products................. [RUN]
2017-04-19 21:31:59,167: Compiling model.shopify.shopify_products
2017-04-19 21:31:59,168: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1cf588>]}
2017-04-19 21:31:59,169: Acquiring new redshift connection "shopify_products".
2017-04-19 21:31:59,171: Re-using an available connection from the pool.
2017-04-19 21:31:59,171: Using redshift connection "shopify_products".
2017-04-19 21:31:59,171: On shopify_products: BEGIN
2017-04-19 21:31:59,222: SQL status: DROP VIEW in 0.45 seconds
2017-04-19 21:31:59,222: On shippo_shipments: COMMIT
2017-04-19 21:31:59,256: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:31:59,256: Using redshift connection "shopify_products".
2017-04-19 21:31:59,256: On shopify_products: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:31:59,318: SQL status: SELECT in 0.06 seconds
2017-04-19 21:31:59,319: executing node model.shopify.shopify_products
2017-04-19 21:31:59,319: Using redshift connection "shopify_products".
2017-04-19 21:31:59,319: On shopify_products: -- Compiled by DBT

    

    create view "analytics"."shopify_products__dbt_tmp" as (
        select

  id,
  title,
  product_type,
  vendor,
  tags,
  handle,
  published_at,
  created_at,
  updated_at

from
  shippo_chooze_shopify.products
    );

    
2017-04-19 21:31:59,915: SQL status: CREATE VIEW in 0.92 seconds
2017-04-19 21:31:59,915: Using redshift connection "shopify_discount_codes".
2017-04-19 21:31:59,915: On shopify_discount_codes: alter table "analytics"."shopify_discount_codes__dbt_tmp" rename to "shopify_discount_codes"
2017-04-19 21:31:59,916: SQL status: CREATE VIEW in 0.60 seconds
2017-04-19 21:31:59,916: Using redshift connection "shopify_products".
2017-04-19 21:31:59,916: On shopify_products: alter table "analytics"."shopify_products__dbt_tmp" rename to "shopify_products"
2017-04-19 21:31:59,932: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:31:59,932: On shopify_discount_codes: COMMIT
2017-04-19 21:31:59,954: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:31:59,954: On shopify_products: COMMIT
2017-04-19 21:32:00,036: Using redshift connection "shippo_shipments".
2017-04-19 21:32:00,036: On shippo_shipments: BEGIN
2017-04-19 21:32:00,105: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:32:00,105: Using redshift connection "shippo_shipments".
2017-04-19 21:32:00,105: On shippo_shipments: alter table "analytics"."shippo_shipments__dbt_tmp" rename to "shippo_shipments"
2017-04-19 21:32:00,105: On shippo_addresses: COMMIT
2017-04-19 21:32:00,161: SQL status: ALTER TABLE in 0.06 seconds
2017-04-19 21:32:00,162: On shippo_shipments: COMMIT
2017-04-19 21:32:00,372: 21:32:00 | 10 of 12 OK created view model analytics.shopify_discount_codes...... [CREATE VIEW in 1.46s]
2017-04-19 21:32:00,373: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b285390>]}
2017-04-19 21:32:00,719: 21:32:00 | 11 of 12 OK created view model analytics.shopify_products............ [CREATE VIEW in 1.55s]
2017-04-19 21:32:00,719: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b229cc0>]}
2017-04-19 21:32:00,803: Using redshift connection "shippo_addresses".
2017-04-19 21:32:00,803: On shippo_addresses: BEGIN
2017-04-19 21:32:00,880: 21:32:00 | 6 of 12 OK created view model analytics.shippo_shipments............. [CREATE VIEW in 4.90s]
2017-04-19 21:32:00,881: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b1f60>]}
2017-04-19 21:32:00,883: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:32:00,884: Using redshift connection "shippo_addresses".
2017-04-19 21:32:00,884: On shippo_addresses: drop view if exists "analytics"."shippo_addresses" cascade
2017-04-19 21:32:00,959: SQL status: DROP VIEW in 0.08 seconds
2017-04-19 21:32:00,960: On shippo_addresses: COMMIT
2017-04-19 21:32:01,445: Using redshift connection "shippo_addresses".
2017-04-19 21:32:01,445: On shippo_addresses: BEGIN
2017-04-19 21:32:01,524: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:32:01,524: Using redshift connection "shippo_addresses".
2017-04-19 21:32:01,524: On shippo_addresses: alter table "analytics"."shippo_addresses__dbt_tmp" rename to "shippo_addresses"
2017-04-19 21:32:01,564: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:32:01,564: On shippo_addresses: COMMIT
2017-04-19 21:32:01,860: 21:32:01 | 8 of 12 OK created view model analytics.shippo_addresses............. [CREATE VIEW in 4.06s]
2017-04-19 21:32:01,860: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8382698-4e96-4a40-a913-84c298df167b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b1f60>]}
2017-04-19 21:32:01,967: 21:32:01 | 12 of 12 SKIP relation analytics.shopify_orders_xf................... [SKIP]
2017-04-19 21:32:02,033: Using redshift connection "master".
2017-04-19 21:32:02,033: On master: BEGIN
2017-04-19 21:32:02,106: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:32:02,106: On master: COMMIT
2017-04-19 21:32:02,139: 21:32:02 | 
2017-04-19 21:32:02,140: 21:32:02 | Finished running 12 view models in 7.69s.
2017-04-19 21:32:02,140: Connection 'master' was left open.
2017-04-19 21:32:02,140: Done. PASS=9 ERROR=2 SKIP=1 TOTAL=12
2017-04-19 21:32:02,141: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b285390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ade8630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b229898>]}
2017-04-19 21:32:02,244: Flushing usage events
2017-04-19 21:37:35,890: Tracking: tracking
2017-04-19 21:37:35,890: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104604ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046049b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104604f60>]}
2017-04-19 21:37:36,031: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 21:37:36,076: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 21:37:36,122: Parsing materializations/incremental.sql
2017-04-19 21:37:36,138: Parsing materializations/table.sql
2017-04-19 21:37:36,145: Parsing materializations/view.sql
2017-04-19 21:37:36,149: Parsing materializations/wrapper.sql
2017-04-19 21:37:36,152: Parsing schema_tests/accepted_values.sql
2017-04-19 21:37:36,154: Parsing schema_tests/not_null.sql
2017-04-19 21:37:36,155: Parsing schema_tests/relationships.sql
2017-04-19 21:37:36,157: Parsing schema_tests/unique.sql
2017-04-19 21:37:36,162: Parsing model.shippo_test.shippo_addresses
2017-04-19 21:37:36,163: Parsing model.shippo_test.shippo_parcels
2017-04-19 21:37:36,164: Parsing model.shippo_test.shippo_shipments
2017-04-19 21:37:36,166: Parsing model.shippo_test.shopify_orders_base
2017-04-19 21:37:36,170: Parsing model.shopify.shopify_checkouts
2017-04-19 21:37:36,172: Parsing model.shopify.shopify_customers
2017-04-19 21:37:36,173: Parsing model.shopify.shopify_discount_codes
2017-04-19 21:37:36,174: Parsing model.shopify.shopify_order_items
2017-04-19 21:37:36,175: Parsing model.shopify.shopify_orders
2017-04-19 21:37:36,177: Parsing model.shopify.shopify_products
2017-04-19 21:37:36,179: Parsing model.shopify.shopify_refunds
2017-04-19 21:37:36,180: Parsing model.shopify.shopify_transactions
2017-04-19 21:37:36,181: Parsing model.shopify.shopify_orders_xf
2017-04-19 21:37:36,194: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 21:37:36,197: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 21:37:36,198: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 21:37:36,200: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 21:37:36,201: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 21:37:36,203: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 21:37:36,204: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 21:37:36,205: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 21:37:36,207: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 21:37:36,208: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 21:37:36,209: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 21:37:36,211: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 21:37:36,212: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 21:37:36,214: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 21:37:36,215: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 21:37:36,216: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 21:37:36,218: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 21:37:36,219: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 21:37:36,220: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 21:37:36,221: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 21:37:36,234: Parsing test.shopify.unique_shopify_orders_cart_token
2017-04-19 21:37:36,235: Parsing test.shopify.unique_shopify_orders_id
2017-04-19 21:37:36,236: Parsing test.shopify.not_null_shopify_orders_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 21:37:36,237: Parsing test.shopify.not_null_shopify_orders_id
2017-04-19 21:37:36,238: Parsing test.shopify.relationships_shopify_orders_id__customer_id__shopify_customers
2017-04-19 21:37:36,240: Parsing test.shopify.unique_shopify_checkouts_cart_token
2017-04-19 21:37:36,242: Parsing test.shopify.unique_shopify_checkouts_id
2017-04-19 21:37:36,243: Parsing test.shopify.not_null_shopify_checkouts_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 21:37:36,245: Parsing test.shopify.not_null_shopify_checkouts_id
2017-04-19 21:37:36,246: Parsing test.shopify.relationships_shopify_checkouts_id__customer_id__shopify_customers
2017-04-19 21:37:36,247: Parsing test.shopify.unique_shopify_customers_id
2017-04-19 21:37:36,249: Parsing test.shopify.not_null_shopify_customers_id
2017-04-19 21:37:36,250: Parsing test.shopify.not_null_shopify_discount_codes_order_id
2017-04-19 21:37:36,251: Parsing test.shopify.relationships_shopify_discount_codes_id__order_id__shopify_orders
2017-04-19 21:37:36,253: Parsing test.shopify.not_null_shopify_transactions_id
2017-04-19 21:37:36,254: Parsing test.shopify.not_null_shopify_transactions_order_id
2017-04-19 21:37:36,255: Parsing test.shopify.unique_shopify_transactions_id
2017-04-19 21:37:36,256: Parsing test.shopify.relationships_shopify_transactions_id__order_id__shopify_orders
2017-04-19 21:37:36,258: Parsing test.shopify.not_null_shopify_refunds_id
2017-04-19 21:37:36,259: Parsing test.shopify.not_null_shopify_refunds_order_id
2017-04-19 21:37:36,260: Parsing test.shopify.unique_shopify_refunds_id
2017-04-19 21:37:36,261: Parsing test.shopify.relationships_shopify_refunds_id__order_id__shopify_orders
2017-04-19 21:37:36,263: Parsing test.shopify.not_null_shopify_products_id
2017-04-19 21:37:36,264: Parsing test.shopify.unique_shopify_products_id
2017-04-19 21:37:36,265: Parsing test.shopify.not_null_shopify_order_items_id
2017-04-19 21:37:36,290: Parsing test.shopify.not_null_shopify_order_items_order_id
2017-04-19 21:37:36,292: Parsing test.shopify.unique_shopify_order_items_id
2017-04-19 21:37:36,293: Parsing test.shopify.relationships_shopify_order_items_id__order_id__shopify_orders
2017-04-19 21:37:36,295: Parsing test.shopify.relationships_shopify_order_items_id__product_id__shopify_products
2017-04-19 21:37:36,298: Compiled 13 models, 49 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 21:37:36,302: Acquiring new redshift connection "master".
2017-04-19 21:37:36,302: Opening a new connection (0 currently allocated)
2017-04-19 21:37:36,635: Using redshift connection "master".
2017-04-19 21:37:36,635: On master: BEGIN
2017-04-19 21:37:36,711: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:36,711: Creating schema "analytics".
2017-04-19 21:37:36,712: Using redshift connection "master".
2017-04-19 21:37:36,712: On master: create schema if not exists "analytics"
2017-04-19 21:37:36,749: SQL status: CREATE SCHEMA in 0.04 seconds
2017-04-19 21:37:36,749: On master: COMMIT
2017-04-19 21:37:37,225: Concurrency: 4 threads (target='only')
2017-04-19 21:37:37,225: Using redshift connection "master".
2017-04-19 21:37:37,225: On master: BEGIN
2017-04-19 21:37:37,296: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:37:37,297: Using redshift connection "master".
2017-04-19 21:37:37,297: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:37,382: SQL status: SELECT in 0.09 seconds
2017-04-19 21:37:37,383: On master: COMMIT
2017-04-19 21:37:37,426: 
2017-04-19 21:37:37,426: 21:37:37 | Running 13 view models
2017-04-19 21:37:37,426: 21:37:37 | 
2017-04-19 21:37:37,426: Using redshift connection "master".
2017-04-19 21:37:37,427: On master: BEGIN
2017-04-19 21:37:37,509: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:37,509: On master: COMMIT
2017-04-19 21:37:37,544: 21:37:37 | 1 of 13 START view model analytics.shopify_discount_codes............ [RUN]
2017-04-19 21:37:37,544: Compiling model.shopify.shopify_discount_codes
2017-04-19 21:37:37,547: Acquiring new redshift connection "shopify_discount_codes".
2017-04-19 21:37:37,547: 21:37:37 | 2 of 13 START view model analytics.shippo_parcels.................... [RUN]
2017-04-19 21:37:37,547: Compiling model.shippo_test.shippo_parcels
2017-04-19 21:37:37,549: Acquiring new redshift connection "shippo_parcels".
2017-04-19 21:37:37,549: 21:37:37 | 3 of 13 START view model analytics.shopify_products.................. [RUN]
2017-04-19 21:37:37,549: 21:37:37 | 4 of 13 START view model analytics.shopify_refunds................... [RUN]
2017-04-19 21:37:37,549: Opening a new connection (1 currently allocated)
2017-04-19 21:37:37,549: Compiling model.shopify.shopify_products
2017-04-19 21:37:37,550: Compiling model.shopify.shopify_refunds
2017-04-19 21:37:37,552: Acquiring new redshift connection "shopify_products".
2017-04-19 21:37:37,553: Acquiring new redshift connection "shopify_refunds".
2017-04-19 21:37:37,861: Using redshift connection "shopify_discount_codes".
2017-04-19 21:37:37,862: Opening a new connection (2 currently allocated)
2017-04-19 21:37:37,862: On shopify_discount_codes: BEGIN
2017-04-19 21:37:37,945: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:37,945: Using redshift connection "shopify_discount_codes".
2017-04-19 21:37:37,945: On shopify_discount_codes: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:38,009: SQL status: SELECT in 0.06 seconds
2017-04-19 21:37:38,010: executing node model.shopify.shopify_discount_codes
2017-04-19 21:37:38,012: Using redshift connection "shopify_discount_codes".
2017-04-19 21:37:38,012: On shopify_discount_codes: -- Compiled by DBT

    

    create view "analytics"."shopify_discount_codes__dbt_tmp" as (
        select

  _sdc_source_key_id as order_id,
  code,
  amount,
  type

from
  shippo_chooze_shopify.orders__discount_codes
    );

    
2017-04-19 21:37:38,126: SQL status: CREATE VIEW in 0.11 seconds
2017-04-19 21:37:38,126: On shopify_discount_codes: COMMIT
2017-04-19 21:37:38,147: Using redshift connection "shippo_parcels".
2017-04-19 21:37:38,147: On shippo_parcels: BEGIN
2017-04-19 21:37:38,147: Opening a new connection (3 currently allocated)
2017-04-19 21:37:38,215: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:37:38,215: Using redshift connection "shippo_parcels".
2017-04-19 21:37:38,216: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:38,283: SQL status: SELECT in 0.07 seconds
2017-04-19 21:37:38,284: executing node model.shippo_test.shippo_parcels
2017-04-19 21:37:38,285: Using redshift connection "shippo_parcels".
2017-04-19 21:37:38,285: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 21:37:38,327: SQL status: CREATE VIEW in 0.04 seconds
2017-04-19 21:37:38,465: Using redshift connection "shopify_products".
2017-04-19 21:37:38,466: On shopify_products: BEGIN
2017-04-19 21:37:38,466: Opening a new connection (4 currently allocated)
2017-04-19 21:37:38,539: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:37:38,539: Using redshift connection "shopify_products".
2017-04-19 21:37:38,539: On shopify_products: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:38,581: Using redshift connection "shopify_discount_codes".
2017-04-19 21:37:38,582: On shopify_discount_codes: BEGIN
2017-04-19 21:37:38,604: SQL status: SELECT in 0.06 seconds
2017-04-19 21:37:38,605: executing node model.shopify.shopify_products
2017-04-19 21:37:38,606: Using redshift connection "shopify_products".
2017-04-19 21:37:38,606: On shopify_products: -- Compiled by DBT

    

    create view "analytics"."shopify_products__dbt_tmp" as (
        select

  id,
  title,
  product_type,
  vendor,
  tags,
  handle,
  published_at,
  created_at,
  updated_at

from
  shippo_chooze_shopify.products
    );

    
2017-04-19 21:37:38,663: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:38,664: Using redshift connection "shopify_discount_codes".
2017-04-19 21:37:38,664: On shopify_discount_codes: drop view if exists "analytics"."shopify_discount_codes" cascade
2017-04-19 21:37:38,683: SQL status: CREATE VIEW in 0.08 seconds
2017-04-19 21:37:38,695: Using redshift connection "shopify_refunds".
2017-04-19 21:37:38,695: On shopify_refunds: BEGIN
2017-04-19 21:37:38,709: SQL status: DROP VIEW in 0.05 seconds
2017-04-19 21:37:38,710: On shopify_discount_codes: COMMIT
2017-04-19 21:37:38,737: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:37:38,737: Using redshift connection "shopify_refunds".
2017-04-19 21:37:38,738: On shopify_refunds: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:38,776: SQL status: SELECT in 0.04 seconds
2017-04-19 21:37:38,778: executing node model.shopify.shopify_refunds
2017-04-19 21:37:38,778: Using redshift connection "shopify_refunds".
2017-04-19 21:37:38,779: On shopify_refunds: -- Compiled by DBT

    

    create view "analytics"."shopify_refunds__dbt_tmp" as (
        select

  id,
  order_id,
  user_id,
  restock,
  note,
  created_at

from
  shippo_chooze_shopify.order_refunds
    );

    
2017-04-19 21:37:38,804: SQL status: CREATE VIEW in 0.03 seconds
2017-04-19 21:37:39,031: Using redshift connection "shopify_discount_codes".
2017-04-19 21:37:39,031: On shopify_discount_codes: BEGIN
2017-04-19 21:37:39,111: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:39,111: Using redshift connection "shopify_discount_codes".
2017-04-19 21:37:39,112: On shopify_discount_codes: alter table "analytics"."shopify_discount_codes__dbt_tmp" rename to "shopify_discount_codes"
2017-04-19 21:37:39,112: On shippo_parcels: COMMIT
2017-04-19 21:37:39,158: SQL status: ALTER TABLE in 0.05 seconds
2017-04-19 21:37:39,158: On shopify_discount_codes: COMMIT
2017-04-19 21:37:39,682: Using redshift connection "shippo_parcels".
2017-04-19 21:37:39,682: On shippo_parcels: BEGIN
2017-04-19 21:37:39,753: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:37:39,753: Using redshift connection "shippo_parcels".
2017-04-19 21:37:39,753: On shippo_parcels: drop view if exists "analytics"."shippo_parcels" cascade
2017-04-19 21:37:40,022: SQL status: DROP VIEW in 0.27 seconds
2017-04-19 21:37:40,023: On shippo_parcels: COMMIT
2017-04-19 21:37:40,244: 21:37:40 | 1 of 13 OK created view model analytics.shopify_discount_codes....... [CREATE VIEW in 2.70s]
2017-04-19 21:37:40,244: 21:37:40 | 5 of 13 START view model analytics.shippo_shipments.................. [RUN]
2017-04-19 21:37:40,244: Compiling model.shippo_test.shippo_shipments
2017-04-19 21:37:40,247: Acquiring new redshift connection "shippo_shipments".
2017-04-19 21:37:40,247: Re-using an available connection from the pool.
2017-04-19 21:37:40,247: Using redshift connection "shippo_shipments".
2017-04-19 21:37:40,247: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104701b00>]}
2017-04-19 21:37:40,247: On shippo_shipments: BEGIN
2017-04-19 21:37:40,337: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:37:40,337: Using redshift connection "shippo_shipments".
2017-04-19 21:37:40,337: On shippo_shipments: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:40,433: SQL status: SELECT in 0.10 seconds
2017-04-19 21:37:40,435: executing node model.shippo_test.shippo_shipments
2017-04-19 21:37:40,436: Using redshift connection "shippo_shipments".
2017-04-19 21:37:40,436: On shippo_shipments: -- Compiled by DBT

    

    create view "analytics"."shippo_shipments__dbt_tmp" as (
        select

    object_id as id,

    address_from as address_from_id,
    address_return as address_return_id,
    address_to as address_to_id,
    parcel as parcel_id,

    insurance_amount::float,
    insurance_currency,

    rates_url,
    return_of,
    submission_date,
    lower(submission_type) as submission_type,
    customs_declaration,


    object_owner as owner,
    lower(object_state) as state,
    lower(object_purpose) as purpose,
    lower(object_status) as status,


    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments
    );

    
2017-04-19 21:37:40,611: Using redshift connection "shippo_parcels".
2017-04-19 21:37:40,611: On shippo_parcels: BEGIN
2017-04-19 21:37:40,619: SQL status: CREATE VIEW in 0.18 seconds
2017-04-19 21:37:40,686: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:40,686: Using redshift connection "shippo_parcels".
2017-04-19 21:37:40,687: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 21:37:40,687: On shopify_products: COMMIT
2017-04-19 21:37:40,719: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 21:37:40,720: On shippo_parcels: COMMIT
2017-04-19 21:37:41,340: Using redshift connection "shopify_products".
2017-04-19 21:37:41,341: On shopify_products: BEGIN
2017-04-19 21:37:41,412: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:37:41,412: Using redshift connection "shopify_products".
2017-04-19 21:37:41,412: On shopify_products: drop view if exists "analytics"."shopify_products" cascade
2017-04-19 21:37:41,513: 21:37:41 | 2 of 13 OK created view model analytics.shippo_parcels............... [CREATE VIEW in 3.97s]
2017-04-19 21:37:41,513: 21:37:41 | 6 of 13 START view model analytics.shopify_customers................. [RUN]
2017-04-19 21:37:41,513: Compiling model.shopify.shopify_customers
2017-04-19 21:37:41,513: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c5d5c0>]}
2017-04-19 21:37:41,516: Acquiring new redshift connection "shopify_customers".
2017-04-19 21:37:41,517: Re-using an available connection from the pool.
2017-04-19 21:37:41,517: Using redshift connection "shopify_customers".
2017-04-19 21:37:41,517: On shopify_customers: BEGIN
2017-04-19 21:37:41,559: SQL status: DROP VIEW in 0.15 seconds
2017-04-19 21:37:41,559: On shopify_products: COMMIT
2017-04-19 21:37:41,586: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:37:41,587: Using redshift connection "shopify_customers".
2017-04-19 21:37:41,587: On shopify_customers: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:41,682: SQL status: SELECT in 0.10 seconds
2017-04-19 21:37:41,684: executing node model.shopify.shopify_customers
2017-04-19 21:37:41,685: Using redshift connection "shopify_customers".
2017-04-19 21:37:41,685: On shopify_customers: -- Compiled by DBT

    

    create view "analytics"."shopify_customers__dbt_tmp" as (
        select
  id,
  first_name,
  last_name,
  email,
  verified_email,
  default_address__id as default_address_id,
  note,
  state,
  tags,
  tax_exempt,
  created_at,
  updated_at
from
  shippo_chooze_shopify.customers
    );

    
2017-04-19 21:37:42,242: SQL status: CREATE VIEW in 0.56 seconds
2017-04-19 21:37:42,309: Using redshift connection "shopify_products".
2017-04-19 21:37:42,310: On shopify_products: BEGIN
2017-04-19 21:37:42,379: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:37:42,379: Using redshift connection "shopify_products".
2017-04-19 21:37:42,379: On shopify_products: alter table "analytics"."shopify_products__dbt_tmp" rename to "shopify_products"
2017-04-19 21:37:42,380: On shopify_refunds: COMMIT
2017-04-19 21:37:42,417: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:37:42,417: On shopify_products: COMMIT
2017-04-19 21:37:43,881: Using redshift connection "shopify_refunds".
2017-04-19 21:37:43,881: On shopify_refunds: BEGIN
2017-04-19 21:37:43,922: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:37:43,922: Using redshift connection "shopify_refunds".
2017-04-19 21:37:43,923: On shopify_refunds: drop view if exists "analytics"."shopify_refunds" cascade
2017-04-19 21:37:44,124: SQL status: DROP VIEW in 0.20 seconds
2017-04-19 21:37:44,124: On shopify_refunds: COMMIT
2017-04-19 21:37:44,597: 21:37:44 | 3 of 13 OK created view model analytics.shopify_products............. [CREATE VIEW in 7.05s]
2017-04-19 21:37:44,598: 21:37:44 | 7 of 13 START view model analytics.shopify_order_items............... [RUN]
2017-04-19 21:37:44,598: Compiling model.shopify.shopify_order_items
2017-04-19 21:37:44,600: Acquiring new redshift connection "shopify_order_items".
2017-04-19 21:37:44,600: Re-using an available connection from the pool.
2017-04-19 21:37:44,600: Using redshift connection "shopify_order_items".
2017-04-19 21:37:44,600: On shopify_order_items: BEGIN
2017-04-19 21:37:44,601: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa2cc0>]}
2017-04-19 21:37:44,684: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:44,684: Using redshift connection "shopify_order_items".
2017-04-19 21:37:44,684: On shopify_order_items: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:44,741: SQL status: SELECT in 0.06 seconds
2017-04-19 21:37:44,743: executing node model.shopify.shopify_order_items
2017-04-19 21:37:44,744: Using redshift connection "shopify_order_items".
2017-04-19 21:37:44,744: On shopify_order_items: -- Compiled by DBT

    

    create view "analytics"."shopify_order_items__dbt_tmp" as (
        select

  id,
  product_id,
  _sdc_source_key_id as order_id,
  sku,
  name,
  title,
  vendor,
  quantity,
  pre_tax_price,
  price,
  taxable,
  gift_card,
  total_discount,
  grams

from
  shippo_chooze_shopify.orders__line_items
    );

    
2017-04-19 21:37:44,787: Postgres error: column "pre_tax_price" does not exist in orders__line_items

2017-04-19 21:37:44,787: On shopify_order_items: ROLLBACK
2017-04-19 21:37:44,825: Error executing target/build/shopify/base/shopify_order_items.sql
column "pre_tax_price" does not exist in orders__line_items
2017-04-19 21:37:44,826: 21:37:44 | 7 of 13 ERROR creating view model analytics.shopify_order_items...... [ERROR in 0.23s]
2017-04-19 21:37:44,826: 21:37:44 | 8 of 13 START view model analytics.shopify_transactions.............. [RUN]
2017-04-19 21:37:44,826: Compiling model.shopify.shopify_transactions
2017-04-19 21:37:44,828: Acquiring new redshift connection "shopify_transactions".
2017-04-19 21:37:44,829: Re-using an available connection from the pool.
2017-04-19 21:37:44,829: Using redshift connection "shopify_transactions".
2017-04-19 21:37:44,829: On shopify_transactions: BEGIN
2017-04-19 21:37:44,829: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041019b0>]}
2017-04-19 21:37:44,911: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:44,911: Using redshift connection "shopify_transactions".
2017-04-19 21:37:44,911: On shopify_transactions: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:44,971: SQL status: SELECT in 0.06 seconds
2017-04-19 21:37:44,973: executing node model.shopify.shopify_transactions
2017-04-19 21:37:44,974: Using redshift connection "shopify_transactions".
2017-04-19 21:37:44,974: On shopify_transactions: -- Compiled by DBT

    

    create view "analytics"."shopify_transactions__dbt_tmp" as (
        select

  id,
  parent_id,
  order_id,

  status,
  error_code,
  message,

  kind,
  amount,
  "authorization",
  currency,
  gateway,

  source_name,

  created_at

from
  shippo_chooze_shopify.transactions

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 21:37:45,020: Using redshift connection "shopify_refunds".
2017-04-19 21:37:45,020: On shopify_refunds: BEGIN
2017-04-19 21:37:45,025: Error executing target/build/shopify/base/shopify_order_items.sql
column "pre_tax_price" does not exist in orders__line_items
2017-04-19 21:37:45,078: SQL status: BEGIN in 0.06 seconds
2017-04-19 21:37:45,078: Using redshift connection "shopify_refunds".
2017-04-19 21:37:45,078: On shopify_refunds: alter table "analytics"."shopify_refunds__dbt_tmp" rename to "shopify_refunds"
2017-04-19 21:37:45,078: On shippo_shipments: COMMIT
2017-04-19 21:37:45,090: SQL status: CREATE VIEW in 0.12 seconds
2017-04-19 21:37:45,102: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:37:45,103: On shopify_refunds: COMMIT
2017-04-19 21:37:45,724: 21:37:45 | 4 of 13 OK created view model analytics.shopify_refunds.............. [CREATE VIEW in 8.17s]
2017-04-19 21:37:45,724: 21:37:45 | 9 of 13 START view model analytics.shopify_checkouts................. [RUN]
2017-04-19 21:37:45,724: Compiling model.shopify.shopify_checkouts
2017-04-19 21:37:45,727: Acquiring new redshift connection "shopify_checkouts".
2017-04-19 21:37:45,727: Re-using an available connection from the pool.
2017-04-19 21:37:45,727: Using redshift connection "shopify_checkouts".
2017-04-19 21:37:45,727: On shopify_checkouts: BEGIN
2017-04-19 21:37:45,728: Using redshift connection "shippo_shipments".
2017-04-19 21:37:45,728: On shippo_shipments: BEGIN
2017-04-19 21:37:45,728: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104164390>]}
2017-04-19 21:37:45,770: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:37:45,770: Using redshift connection "shopify_checkouts".
2017-04-19 21:37:45,770: On shopify_checkouts: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:45,819: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:37:45,819: Using redshift connection "shippo_shipments".
2017-04-19 21:37:45,819: On shippo_shipments: drop view if exists "analytics"."shippo_shipments" cascade
2017-04-19 21:37:45,820: SQL status: SELECT in 0.05 seconds
2017-04-19 21:37:45,821: executing node model.shopify.shopify_checkouts
2017-04-19 21:37:45,823: Using redshift connection "shopify_checkouts".
2017-04-19 21:37:45,823: On shopify_checkouts: -- Compiled by DBT

    

    create view "analytics"."shopify_checkouts__dbt_tmp" as (
        select
  id,
  customer__id as customer_id,
  email,
  nullif(cart_token, '') as cart_token,
  nullif(token, '') as token,
  abandoned_checkout_url,
  name,
  completed_at,
  currency,
  gateway,
  landing_site,
  note,
  source_name,
  referring_site,
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_tax,
  total_weight,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  updated_at,
  created_at
from
  shippo_chooze_shopify.checkouts
    );

    
2017-04-19 21:37:45,865: SQL status: DROP VIEW in 0.05 seconds
2017-04-19 21:37:45,865: On shippo_shipments: COMMIT
2017-04-19 21:37:46,543: SQL status: CREATE VIEW in 0.72 seconds
2017-04-19 21:37:46,645: Using redshift connection "shippo_shipments".
2017-04-19 21:37:46,645: On shippo_shipments: BEGIN
2017-04-19 21:37:46,737: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:37:46,737: Using redshift connection "shippo_shipments".
2017-04-19 21:37:46,737: On shippo_shipments: alter table "analytics"."shippo_shipments__dbt_tmp" rename to "shippo_shipments"
2017-04-19 21:37:46,737: On shopify_customers: COMMIT
2017-04-19 21:37:46,787: SQL status: ALTER TABLE in 0.05 seconds
2017-04-19 21:37:46,787: On shippo_shipments: COMMIT
2017-04-19 21:37:47,260: Using redshift connection "shopify_customers".
2017-04-19 21:37:47,260: On shopify_customers: BEGIN
2017-04-19 21:37:47,337: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:47,337: Using redshift connection "shopify_customers".
2017-04-19 21:37:47,337: On shopify_customers: drop view if exists "analytics"."shopify_customers" cascade
2017-04-19 21:37:47,344: 21:37:47 | 5 of 13 OK created view model analytics.shippo_shipments............. [CREATE VIEW in 7.10s]
2017-04-19 21:37:47,344: 21:37:47 | 10 of 13 START view model analytics.shippo_addresses................. [RUN]
2017-04-19 21:37:47,344: Compiling model.shippo_test.shippo_addresses
2017-04-19 21:37:47,347: Acquiring new redshift connection "shippo_addresses".
2017-04-19 21:37:47,347: Re-using an available connection from the pool.
2017-04-19 21:37:47,347: Using redshift connection "shippo_addresses".
2017-04-19 21:37:47,347: On shippo_addresses: BEGIN
2017-04-19 21:37:47,347: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ad160>]}
2017-04-19 21:37:47,409: SQL status: DROP VIEW in 0.07 seconds
2017-04-19 21:37:47,410: On shopify_customers: COMMIT
2017-04-19 21:37:47,432: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:47,432: Using redshift connection "shippo_addresses".
2017-04-19 21:37:47,432: On shippo_addresses: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:47,542: SQL status: SELECT in 0.11 seconds
2017-04-19 21:37:47,544: executing node model.shippo_test.shippo_addresses
2017-04-19 21:37:47,545: Using redshift connection "shippo_addresses".
2017-04-19 21:37:47,545: On shippo_addresses: -- Compiled by DBT

    

    create view "analytics"."shippo_addresses__dbt_tmp" as (
        select

    object_id as id,

    name,
    company,

    street1,
    street2,
    street3,
    street_no,

    city,
    state,
    zip,
    country,

    email,
    phone,

    is_residential,

    object_owner as owner,
    lower(object_purpose) as purpose,
    lower(object_source) as source,
    lower(object_state) as object_state,

    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.addresses
    );

    
2017-04-19 21:37:48,182: SQL status: CREATE VIEW in 0.64 seconds
2017-04-19 21:37:48,182: Using redshift connection "shopify_customers".
2017-04-19 21:37:48,183: On shopify_customers: BEGIN
2017-04-19 21:37:48,277: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:37:48,277: Using redshift connection "shopify_customers".
2017-04-19 21:37:48,277: On shopify_customers: alter table "analytics"."shopify_customers__dbt_tmp" rename to "shopify_customers"
2017-04-19 21:37:48,278: On shopify_transactions: COMMIT
2017-04-19 21:37:48,322: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:37:48,323: On shopify_customers: COMMIT
2017-04-19 21:37:48,898: Using redshift connection "shopify_transactions".
2017-04-19 21:37:48,899: On shopify_transactions: BEGIN
2017-04-19 21:37:48,922: 21:37:48 | 6 of 13 OK created view model analytics.shopify_customers............ [CREATE VIEW in 7.41s]
2017-04-19 21:37:48,922: 21:37:48 | 11 of 13 START view model analytics.shopify_orders_base.............. [RUN]
2017-04-19 21:37:48,923: Compiling model.shippo_test.shopify_orders_base
2017-04-19 21:37:48,924: Acquiring new redshift connection "shopify_orders_base".
2017-04-19 21:37:48,925: Re-using an available connection from the pool.
2017-04-19 21:37:48,925: Using redshift connection "shopify_orders_base".
2017-04-19 21:37:48,925: On shopify_orders_base: BEGIN
2017-04-19 21:37:48,925: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ad8d0>]}
2017-04-19 21:37:48,972: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:37:48,972: Using redshift connection "shopify_transactions".
2017-04-19 21:37:48,972: On shopify_transactions: drop view if exists "analytics"."shopify_transactions" cascade
2017-04-19 21:37:48,996: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:37:48,996: Using redshift connection "shopify_orders_base".
2017-04-19 21:37:48,996: On shopify_orders_base: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:49,012: SQL status: DROP VIEW in 0.04 seconds
2017-04-19 21:37:49,012: On shopify_transactions: COMMIT
2017-04-19 21:37:49,078: SQL status: SELECT in 0.08 seconds
2017-04-19 21:37:49,080: executing node model.shippo_test.shopify_orders_base
2017-04-19 21:37:49,081: Using redshift connection "shopify_orders_base".
2017-04-19 21:37:49,082: On shopify_orders_base: -- Compiled by DBT

    

    create view "analytics"."shopify_orders_base__dbt_tmp" as (
        select
  -- ids
  id,
  customer__id,
  checkout_id,
  cart_token,
  checkout_token,
  token,

  -- logical ids reported in the application
  "number",
  order_number,

  -- state
  financial_status,
  fulfillment_status,
  confirmed,

  -- cancellation information
  cancel_reason,
  cancelled_at,

  -- etc
  closed_at,
  processed_at,
  email,
  contact_email,
  name,
  note,
  tags,

  -- attribution
  browser_ip,
  source_name,
  landing_site,
  null::varchar as landing_site_ref,
  referring_site,

  -- financial
  currency,
  processing_method,

  -- numbers
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_price_usd,
  total_tax,
  total_weight,

  -- point of sale info
  user_id,
  location_id,

  -- address
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,

  -- audit
  created_at,
  updated_at

from
  shippo_chooze_shopify.orders
    );

    
2017-04-19 21:37:49,615: SQL status: CREATE VIEW in 0.53 seconds
2017-04-19 21:37:49,615: Using redshift connection "shopify_orders_base".
2017-04-19 21:37:49,615: On shopify_orders_base: alter table "analytics"."shopify_orders_base__dbt_tmp" rename to "shopify_orders_base"
2017-04-19 21:37:49,616: Using redshift connection "shopify_transactions".
2017-04-19 21:37:49,616: On shopify_transactions: BEGIN
2017-04-19 21:37:49,664: SQL status: ALTER TABLE in 0.05 seconds
2017-04-19 21:37:49,664: On shopify_orders_base: COMMIT
2017-04-19 21:37:49,692: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:49,692: Using redshift connection "shopify_transactions".
2017-04-19 21:37:49,692: On shopify_transactions: alter table "analytics"."shopify_transactions__dbt_tmp" rename to "shopify_transactions"
2017-04-19 21:37:49,692: On shopify_checkouts: COMMIT
2017-04-19 21:37:49,748: SQL status: ALTER TABLE in 0.06 seconds
2017-04-19 21:37:49,749: On shopify_transactions: COMMIT
2017-04-19 21:37:50,232: 21:37:50 | 11 of 13 OK created view model analytics.shopify_orders_base......... [CREATE VIEW in 1.31s]
2017-04-19 21:37:50,233: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc8358>]}
2017-04-19 21:37:51,234: Using redshift connection "shopify_checkouts".
2017-04-19 21:37:51,234: On shopify_checkouts: BEGIN
2017-04-19 21:37:51,235: 21:37:51 | 8 of 13 OK created view model analytics.shopify_transactions......... [CREATE VIEW in 6.41s]
2017-04-19 21:37:51,235: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103edf7f0>]}
2017-04-19 21:37:51,287: SQL status: BEGIN in 0.05 seconds
2017-04-19 21:37:51,288: Using redshift connection "shopify_checkouts".
2017-04-19 21:37:51,288: On shopify_checkouts: drop view if exists "analytics"."shopify_checkouts" cascade
2017-04-19 21:37:51,429: SQL status: DROP VIEW in 0.14 seconds
2017-04-19 21:37:51,429: On shopify_checkouts: COMMIT
2017-04-19 21:37:51,868: Using redshift connection "shopify_checkouts".
2017-04-19 21:37:51,868: On shopify_checkouts: BEGIN
2017-04-19 21:37:51,913: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:37:51,913: Using redshift connection "shopify_checkouts".
2017-04-19 21:37:51,913: On shopify_checkouts: alter table "analytics"."shopify_checkouts__dbt_tmp" rename to "shopify_checkouts"
2017-04-19 21:37:51,914: On shippo_addresses: COMMIT
2017-04-19 21:37:51,937: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:37:51,937: On shopify_checkouts: COMMIT
2017-04-19 21:37:52,465: Using redshift connection "shippo_addresses".
2017-04-19 21:37:52,465: On shippo_addresses: BEGIN
2017-04-19 21:37:52,552: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:37:52,552: Using redshift connection "shippo_addresses".
2017-04-19 21:37:52,552: On shippo_addresses: drop view if exists "analytics"."shippo_addresses" cascade
2017-04-19 21:37:52,780: SQL status: DROP VIEW in 0.23 seconds
2017-04-19 21:37:52,780: On shippo_addresses: COMMIT
2017-04-19 21:37:52,801: 21:37:52 | 9 of 13 OK created view model analytics.shopify_checkouts............ [CREATE VIEW in 7.08s]
2017-04-19 21:37:52,802: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041016a0>]}
2017-04-19 21:37:53,094: Using redshift connection "shippo_addresses".
2017-04-19 21:37:53,094: On shippo_addresses: BEGIN
2017-04-19 21:37:53,178: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:53,179: Using redshift connection "shippo_addresses".
2017-04-19 21:37:53,179: On shippo_addresses: alter table "analytics"."shippo_addresses__dbt_tmp" rename to "shippo_addresses"
2017-04-19 21:37:53,229: SQL status: ALTER TABLE in 0.05 seconds
2017-04-19 21:37:53,229: On shippo_addresses: COMMIT
2017-04-19 21:37:53,587: 21:37:53 | 10 of 13 OK created view model analytics.shippo_addresses............ [CREATE VIEW in 6.24s]
2017-04-19 21:37:53,587: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104164208>]}
2017-04-19 21:37:53,694: 21:37:53 | 12 of 13 START view model analytics.shopify_orders................... [RUN]
2017-04-19 21:37:53,695: Compiling model.shopify.shopify_orders
2017-04-19 21:37:53,698: Acquiring new redshift connection "shopify_orders".
2017-04-19 21:37:53,698: Re-using an available connection from the pool.
2017-04-19 21:37:53,698: Using redshift connection "shopify_orders".
2017-04-19 21:37:53,698: On shopify_orders: BEGIN
2017-04-19 21:37:53,782: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:37:53,783: Using redshift connection "shopify_orders".
2017-04-19 21:37:53,783: On shopify_orders: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:37:53,845: SQL status: SELECT in 0.06 seconds
2017-04-19 21:37:53,847: executing node model.shopify.shopify_orders
2017-04-19 21:37:53,848: Using redshift connection "shopify_orders".
2017-04-19 21:37:53,849: On shopify_orders: -- Compiled by DBT

    

    create view "analytics"."shopify_orders__dbt_tmp" as (
        -- see shopify docs here:
-- https://help.shopify.com/api/reference/order

select
  -- ids
  id,
  customer__id as customer_id,
  checkout_id,
  nullif(cart_token, '') as cart_token,
  nullif(checkout_token, '') as checkout_token,
  nullif(token, '') as token,

  -- logical ids reported in the application
  "number",
  order_number,

  -- state
  financial_status,
  fulfillment_status,
  confirmed,

  -- cancellation information
  cancel_reason,
  cancelled_at,

  -- etc
  closed_at,
  processed_at,
  email,
  contact_email,
  name,
  note,
  tags,

  -- attribution
  browser_ip,
  source_name,
  landing_site,
  landing_site_ref,
  referring_site,

  -- financial
  currency,
  processing_method,

  -- numbers
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_price_usd,
  total_tax,
  total_weight,

  -- point of sale info
  user_id,
  location_id,

  -- address
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,

  -- audit
  created_at,
  updated_at

from
  "analytics"."shopify_orders_base"

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 21:37:53,903: Postgres error: column "test" does not exist in shopify_orders_base

2017-04-19 21:37:53,903: On shopify_orders: ROLLBACK
2017-04-19 21:37:53,946: Error executing target/build/shopify/base/shopify_orders.sql
column "test" does not exist in shopify_orders_base
2017-04-19 21:37:53,946: 21:37:53 | 12 of 13 ERROR creating view model analytics.shopify_orders.......... [ERROR in 0.25s]
2017-04-19 21:37:53,946: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4a636e-522b-40e0-b6cf-0a567b95810b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045de860>]}
2017-04-19 21:37:54,118: Error executing target/build/shopify/base/shopify_orders.sql
column "test" does not exist in shopify_orders_base
2017-04-19 21:37:54,119: 21:37:54 | 13 of 13 SKIP relation analytics.shopify_orders_xf................... [SKIP]
2017-04-19 21:37:54,207: Using redshift connection "master".
2017-04-19 21:37:54,207: On master: BEGIN
2017-04-19 21:37:54,275: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:37:54,275: On master: COMMIT
2017-04-19 21:37:54,312: 21:37:54 | 
2017-04-19 21:37:54,312: 21:37:54 | Finished running 13 view models in 16.89s.
2017-04-19 21:37:54,313: Connection 'master' was left open.
2017-04-19 21:37:54,313: Done. PASS=10 ERROR=2 SKIP=1 TOTAL=13
2017-04-19 21:37:54,314: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104106f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040cf780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040cf5f8>]}
2017-04-19 21:37:54,406: Flushing usage events
2017-04-19 21:38:31,111: Tracking: tracking
2017-04-19 21:38:31,111: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b22a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b227f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b229e8>]}
2017-04-19 21:38:31,236: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 21:38:31,283: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 21:38:31,328: Parsing materializations/incremental.sql
2017-04-19 21:38:31,343: Parsing materializations/table.sql
2017-04-19 21:38:31,353: Parsing materializations/view.sql
2017-04-19 21:38:31,356: Parsing materializations/wrapper.sql
2017-04-19 21:38:31,359: Parsing schema_tests/accepted_values.sql
2017-04-19 21:38:31,361: Parsing schema_tests/not_null.sql
2017-04-19 21:38:31,363: Parsing schema_tests/relationships.sql
2017-04-19 21:38:31,364: Parsing schema_tests/unique.sql
2017-04-19 21:38:31,370: Parsing model.shippo_test.shippo_addresses
2017-04-19 21:38:31,371: Parsing model.shippo_test.shippo_parcels
2017-04-19 21:38:31,372: Parsing model.shippo_test.shippo_shipments
2017-04-19 21:38:31,374: Parsing model.shippo_test.shopify_orders_base
2017-04-19 21:38:31,381: Parsing model.shopify.shopify_checkouts
2017-04-19 21:38:31,383: Parsing model.shopify.shopify_customers
2017-04-19 21:38:31,384: Parsing model.shopify.shopify_discount_codes
2017-04-19 21:38:31,385: Parsing model.shopify.shopify_order_items
2017-04-19 21:38:31,387: Parsing model.shopify.shopify_orders
2017-04-19 21:38:31,389: Parsing model.shopify.shopify_products
2017-04-19 21:38:31,390: Parsing model.shopify.shopify_refunds
2017-04-19 21:38:31,391: Parsing model.shopify.shopify_transactions
2017-04-19 21:38:31,393: Parsing model.shopify.shopify_orders_xf
2017-04-19 21:38:31,406: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 21:38:31,407: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 21:38:31,408: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 21:38:31,410: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 21:38:31,411: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 21:38:31,412: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 21:38:31,413: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 21:38:31,414: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 21:38:31,416: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 21:38:31,417: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 21:38:31,418: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 21:38:31,420: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 21:38:31,421: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 21:38:31,423: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 21:38:31,424: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 21:38:31,425: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 21:38:31,427: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 21:38:31,428: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 21:38:31,429: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 21:38:31,430: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 21:38:31,442: Parsing test.shopify.unique_shopify_orders_cart_token
2017-04-19 21:38:31,444: Parsing test.shopify.unique_shopify_orders_id
2017-04-19 21:38:31,445: Parsing test.shopify.not_null_shopify_orders_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 21:38:31,446: Parsing test.shopify.not_null_shopify_orders_id
2017-04-19 21:38:31,447: Parsing test.shopify.relationships_shopify_orders_id__customer_id__shopify_customers
2017-04-19 21:38:31,449: Parsing test.shopify.unique_shopify_checkouts_cart_token
2017-04-19 21:38:31,450: Parsing test.shopify.unique_shopify_checkouts_id
2017-04-19 21:38:31,451: Parsing test.shopify.not_null_shopify_checkouts_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 21:38:31,452: Parsing test.shopify.not_null_shopify_checkouts_id
2017-04-19 21:38:31,453: Parsing test.shopify.relationships_shopify_checkouts_id__customer_id__shopify_customers
2017-04-19 21:38:31,455: Parsing test.shopify.unique_shopify_customers_id
2017-04-19 21:38:31,456: Parsing test.shopify.not_null_shopify_customers_id
2017-04-19 21:38:31,457: Parsing test.shopify.not_null_shopify_discount_codes_order_id
2017-04-19 21:38:31,458: Parsing test.shopify.relationships_shopify_discount_codes_id__order_id__shopify_orders
2017-04-19 21:38:31,460: Parsing test.shopify.not_null_shopify_transactions_id
2017-04-19 21:38:31,461: Parsing test.shopify.not_null_shopify_transactions_order_id
2017-04-19 21:38:31,462: Parsing test.shopify.unique_shopify_transactions_id
2017-04-19 21:38:31,463: Parsing test.shopify.relationships_shopify_transactions_id__order_id__shopify_orders
2017-04-19 21:38:31,465: Parsing test.shopify.not_null_shopify_refunds_id
2017-04-19 21:38:31,466: Parsing test.shopify.not_null_shopify_refunds_order_id
2017-04-19 21:38:31,467: Parsing test.shopify.unique_shopify_refunds_id
2017-04-19 21:38:31,468: Parsing test.shopify.relationships_shopify_refunds_id__order_id__shopify_orders
2017-04-19 21:38:31,469: Parsing test.shopify.not_null_shopify_products_id
2017-04-19 21:38:31,471: Parsing test.shopify.unique_shopify_products_id
2017-04-19 21:38:31,472: Parsing test.shopify.not_null_shopify_order_items_id
2017-04-19 21:38:31,473: Parsing test.shopify.not_null_shopify_order_items_order_id
2017-04-19 21:38:31,474: Parsing test.shopify.unique_shopify_order_items_id
2017-04-19 21:38:31,476: Parsing test.shopify.relationships_shopify_order_items_id__order_id__shopify_orders
2017-04-19 21:38:31,477: Parsing test.shopify.relationships_shopify_order_items_id__product_id__shopify_products
2017-04-19 21:38:31,479: Compiled 13 models, 49 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 21:38:31,482: Acquiring new redshift connection "master".
2017-04-19 21:38:31,483: Opening a new connection (0 currently allocated)
2017-04-19 21:38:31,811: Using redshift connection "master".
2017-04-19 21:38:31,811: On master: BEGIN
2017-04-19 21:38:31,897: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:38:31,898: Creating schema "analytics".
2017-04-19 21:38:31,898: Using redshift connection "master".
2017-04-19 21:38:31,898: On master: create schema if not exists "analytics"
2017-04-19 21:38:31,941: SQL status: CREATE SCHEMA in 0.04 seconds
2017-04-19 21:38:31,941: On master: COMMIT
2017-04-19 21:38:32,521: Concurrency: 4 threads (target='only')
2017-04-19 21:38:32,521: Using redshift connection "master".
2017-04-19 21:38:32,521: On master: BEGIN
2017-04-19 21:38:32,610: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:38:32,610: Using redshift connection "master".
2017-04-19 21:38:32,610: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:32,709: SQL status: SELECT in 0.10 seconds
2017-04-19 21:38:32,709: On master: COMMIT
2017-04-19 21:38:32,755: 
2017-04-19 21:38:32,755: 21:38:32 | Running 13 view models
2017-04-19 21:38:32,755: 21:38:32 | 
2017-04-19 21:38:32,755: Using redshift connection "master".
2017-04-19 21:38:32,755: On master: BEGIN
2017-04-19 21:38:32,854: SQL status: BEGIN in 0.10 seconds
2017-04-19 21:38:32,854: On master: COMMIT
2017-04-19 21:38:32,930: 21:38:32 | 1 of 13 START view model analytics.shopify_discount_codes............ [RUN]
2017-04-19 21:38:32,930: Compiling model.shopify.shopify_discount_codes
2017-04-19 21:38:32,932: Acquiring new redshift connection "shopify_discount_codes".
2017-04-19 21:38:32,932: Opening a new connection (1 currently allocated)
2017-04-19 21:38:32,932: 21:38:32 | 2 of 13 START view model analytics.shopify_order_items............... [RUN]
2017-04-19 21:38:32,933: Compiling model.shopify.shopify_order_items
2017-04-19 21:38:32,933: 21:38:32 | 3 of 13 START view model analytics.shopify_checkouts................. [RUN]
2017-04-19 21:38:32,933: 21:38:32 | 4 of 13 START view model analytics.shopify_transactions.............. [RUN]
2017-04-19 21:38:32,935: Acquiring new redshift connection "shopify_order_items".
2017-04-19 21:38:32,935: Compiling model.shopify.shopify_checkouts
2017-04-19 21:38:32,935: Compiling model.shopify.shopify_transactions
2017-04-19 21:38:32,937: Acquiring new redshift connection "shopify_checkouts".
2017-04-19 21:38:32,939: Acquiring new redshift connection "shopify_transactions".
2017-04-19 21:38:33,095: Using redshift connection "shopify_discount_codes".
2017-04-19 21:38:33,095: On shopify_discount_codes: BEGIN
2017-04-19 21:38:33,096: Opening a new connection (2 currently allocated)
2017-04-19 21:38:33,134: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:33,134: Using redshift connection "shopify_discount_codes".
2017-04-19 21:38:33,135: On shopify_discount_codes: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:33,182: SQL status: SELECT in 0.05 seconds
2017-04-19 21:38:33,184: executing node model.shopify.shopify_discount_codes
2017-04-19 21:38:33,185: Using redshift connection "shopify_discount_codes".
2017-04-19 21:38:33,185: On shopify_discount_codes: -- Compiled by DBT

    

    create view "analytics"."shopify_discount_codes__dbt_tmp" as (
        select

  _sdc_source_key_id as order_id,
  code,
  amount,
  type

from
  shippo_chooze_shopify.orders__discount_codes
    );

    
2017-04-19 21:38:33,272: SQL status: CREATE VIEW in 0.09 seconds
2017-04-19 21:38:33,272: On shopify_discount_codes: COMMIT
2017-04-19 21:38:33,279: Using redshift connection "shopify_order_items".
2017-04-19 21:38:33,280: On shopify_order_items: BEGIN
2017-04-19 21:38:33,280: Opening a new connection (3 currently allocated)
2017-04-19 21:38:33,328: SQL status: BEGIN in 0.05 seconds
2017-04-19 21:38:33,328: Using redshift connection "shopify_order_items".
2017-04-19 21:38:33,328: On shopify_order_items: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:33,378: SQL status: SELECT in 0.05 seconds
2017-04-19 21:38:33,380: executing node model.shopify.shopify_order_items
2017-04-19 21:38:33,381: Using redshift connection "shopify_order_items".
2017-04-19 21:38:33,381: On shopify_order_items: -- Compiled by DBT

    

    create view "analytics"."shopify_order_items__dbt_tmp" as (
        select

  id,
  product_id,
  _sdc_source_key_id as order_id,
  sku,
  name,
  title,
  vendor,
  quantity,
  pre_tax_price,
  price,
  taxable,
  gift_card,
  total_discount,
  grams

from
  shippo_chooze_shopify.orders__line_items
    );

    
2017-04-19 21:38:33,401: Postgres error: column "pre_tax_price" does not exist in orders__line_items

2017-04-19 21:38:33,401: On shopify_order_items: ROLLBACK
2017-04-19 21:38:33,422: Error executing target/build/shopify/base/shopify_order_items.sql
column "pre_tax_price" does not exist in orders__line_items
2017-04-19 21:38:33,584: Using redshift connection "shopify_checkouts".
2017-04-19 21:38:33,585: On shopify_checkouts: BEGIN
2017-04-19 21:38:33,585: Opening a new connection (4 currently allocated)
2017-04-19 21:38:33,654: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:38:33,654: Using redshift connection "shopify_checkouts".
2017-04-19 21:38:33,654: On shopify_checkouts: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:33,716: SQL status: SELECT in 0.06 seconds
2017-04-19 21:38:33,718: executing node model.shopify.shopify_checkouts
2017-04-19 21:38:33,720: Using redshift connection "shopify_checkouts".
2017-04-19 21:38:33,720: On shopify_checkouts: -- Compiled by DBT

    

    create view "analytics"."shopify_checkouts__dbt_tmp" as (
        select
  id,
  customer__id as customer_id,
  email,
  nullif(cart_token, '') as cart_token,
  nullif(token, '') as token,
  abandoned_checkout_url,
  name,
  completed_at,
  currency,
  gateway,
  landing_site,
  note,
  source_name,
  referring_site,
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_tax,
  total_weight,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  updated_at,
  created_at
from
  shippo_chooze_shopify.checkouts
    );

    
2017-04-19 21:38:33,756: Using redshift connection "shopify_transactions".
2017-04-19 21:38:33,756: On shopify_transactions: BEGIN
2017-04-19 21:38:33,756: 21:38:33 | 2 of 13 ERROR creating view model analytics.shopify_order_items...... [ERROR in 0.82s]
2017-04-19 21:38:33,757: 21:38:33 | 5 of 13 START view model analytics.shopify_customers................. [RUN]
2017-04-19 21:38:33,757: Compiling model.shopify.shopify_customers
2017-04-19 21:38:33,759: Acquiring new redshift connection "shopify_customers".
2017-04-19 21:38:33,759: Re-using an available connection from the pool.
2017-04-19 21:38:33,759: Using redshift connection "shopify_customers".
2017-04-19 21:38:33,759: On shopify_customers: BEGIN
2017-04-19 21:38:33,760: Using redshift connection "shopify_discount_codes".
2017-04-19 21:38:33,760: On shopify_discount_codes: BEGIN
2017-04-19 21:38:33,760: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c39eb8>]}
2017-04-19 21:38:33,797: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:33,798: Using redshift connection "shopify_transactions".
2017-04-19 21:38:33,798: On shopify_transactions: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:33,806: SQL status: BEGIN in 0.05 seconds
2017-04-19 21:38:33,806: Using redshift connection "shopify_customers".
2017-04-19 21:38:33,806: On shopify_customers: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:33,806: SQL status: BEGIN in 0.05 seconds
2017-04-19 21:38:33,806: Using redshift connection "shopify_discount_codes".
2017-04-19 21:38:33,806: On shopify_discount_codes: drop view if exists "analytics"."shopify_discount_codes" cascade
2017-04-19 21:38:33,811: SQL status: CREATE VIEW in 0.09 seconds
2017-04-19 21:38:33,844: SQL status: DROP VIEW in 0.04 seconds
2017-04-19 21:38:33,845: On shopify_discount_codes: COMMIT
2017-04-19 21:38:33,855: SQL status: SELECT in 0.06 seconds
2017-04-19 21:38:33,856: executing node model.shopify.shopify_transactions
2017-04-19 21:38:33,857: Using redshift connection "shopify_transactions".
2017-04-19 21:38:33,857: On shopify_transactions: -- Compiled by DBT

    

    create view "analytics"."shopify_transactions__dbt_tmp" as (
        select

  id,
  parent_id,
  order_id,

  status,
  error_code,
  message,

  kind,
  amount,
  "authorization",
  currency,
  gateway,

  source_name,

  created_at

from
  shippo_chooze_shopify.transactions

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 21:38:33,862: SQL status: SELECT in 0.06 seconds
2017-04-19 21:38:33,864: executing node model.shopify.shopify_customers
2017-04-19 21:38:33,865: Using redshift connection "shopify_customers".
2017-04-19 21:38:33,865: On shopify_customers: -- Compiled by DBT

    

    create view "analytics"."shopify_customers__dbt_tmp" as (
        select
  id,
  first_name,
  last_name,
  email,
  verified_email,
  default_address__id as default_address_id,
  note,
  state,
  tags,
  tax_exempt,
  created_at,
  updated_at
from
  shippo_chooze_shopify.customers
    );

    
2017-04-19 21:38:33,885: Error executing target/build/shopify/base/shopify_order_items.sql
column "pre_tax_price" does not exist in orders__line_items
2017-04-19 21:38:33,925: SQL status: CREATE VIEW in 0.06 seconds
2017-04-19 21:38:34,053: SQL status: CREATE VIEW in 0.20 seconds
2017-04-19 21:38:34,221: Using redshift connection "shopify_discount_codes".
2017-04-19 21:38:34,221: On shopify_discount_codes: BEGIN
2017-04-19 21:38:34,261: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:34,261: Using redshift connection "shopify_discount_codes".
2017-04-19 21:38:34,261: On shopify_discount_codes: alter table "analytics"."shopify_discount_codes__dbt_tmp" rename to "shopify_discount_codes"
2017-04-19 21:38:34,261: On shopify_checkouts: COMMIT
2017-04-19 21:38:34,284: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:38:34,284: On shopify_discount_codes: COMMIT
2017-04-19 21:38:34,876: Using redshift connection "shopify_checkouts".
2017-04-19 21:38:34,876: On shopify_checkouts: BEGIN
2017-04-19 21:38:34,941: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:38:34,942: Using redshift connection "shopify_checkouts".
2017-04-19 21:38:34,942: On shopify_checkouts: drop view if exists "analytics"."shopify_checkouts" cascade
2017-04-19 21:38:35,097: 21:38:35 | 1 of 13 OK created view model analytics.shopify_discount_codes....... [CREATE VIEW in 2.17s]
2017-04-19 21:38:35,097: 21:38:35 | 6 of 13 START view model analytics.shippo_shipments.................. [RUN]
2017-04-19 21:38:35,097: Compiling model.shippo_test.shippo_shipments
2017-04-19 21:38:35,099: Acquiring new redshift connection "shippo_shipments".
2017-04-19 21:38:35,100: Re-using an available connection from the pool.
2017-04-19 21:38:35,100: Using redshift connection "shippo_shipments".
2017-04-19 21:38:35,100: On shippo_shipments: BEGIN
2017-04-19 21:38:35,100: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865cd68>]}
2017-04-19 21:38:35,129: SQL status: DROP VIEW in 0.19 seconds
2017-04-19 21:38:35,129: On shopify_checkouts: COMMIT
2017-04-19 21:38:35,140: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:35,140: Using redshift connection "shippo_shipments".
2017-04-19 21:38:35,140: On shippo_shipments: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:35,201: SQL status: SELECT in 0.06 seconds
2017-04-19 21:38:35,202: executing node model.shippo_test.shippo_shipments
2017-04-19 21:38:35,203: Using redshift connection "shippo_shipments".
2017-04-19 21:38:35,203: On shippo_shipments: -- Compiled by DBT

    

    create view "analytics"."shippo_shipments__dbt_tmp" as (
        select

    object_id as id,

    address_from as address_from_id,
    address_return as address_return_id,
    address_to as address_to_id,
    parcel as parcel_id,

    insurance_amount::float,
    insurance_currency,

    rates_url,
    return_of,
    submission_date,
    lower(submission_type) as submission_type,
    customs_declaration,


    object_owner as owner,
    lower(object_state) as state,
    lower(object_purpose) as purpose,
    lower(object_status) as status,


    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments
    );

    
2017-04-19 21:38:35,365: SQL status: CREATE VIEW in 0.16 seconds
2017-04-19 21:38:35,429: Using redshift connection "shopify_checkouts".
2017-04-19 21:38:35,429: On shopify_checkouts: BEGIN
2017-04-19 21:38:35,520: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:38:35,520: Using redshift connection "shopify_checkouts".
2017-04-19 21:38:35,520: On shopify_checkouts: alter table "analytics"."shopify_checkouts__dbt_tmp" rename to "shopify_checkouts"
2017-04-19 21:38:35,521: On shopify_customers: COMMIT
2017-04-19 21:38:35,563: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:38:35,563: On shopify_checkouts: COMMIT
2017-04-19 21:38:36,105: Using redshift connection "shopify_customers".
2017-04-19 21:38:36,105: On shopify_customers: BEGIN
2017-04-19 21:38:36,142: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:36,142: Using redshift connection "shopify_customers".
2017-04-19 21:38:36,142: On shopify_customers: drop view if exists "analytics"."shopify_customers" cascade
2017-04-19 21:38:36,175: SQL status: DROP VIEW in 0.03 seconds
2017-04-19 21:38:36,176: On shopify_customers: COMMIT
2017-04-19 21:38:36,514: 21:38:36 | 3 of 13 OK created view model analytics.shopify_checkouts............ [CREATE VIEW in 3.58s]
2017-04-19 21:38:36,515: 21:38:36 | 7 of 13 START view model analytics.shippo_parcels.................... [RUN]
2017-04-19 21:38:36,515: Compiling model.shippo_test.shippo_parcels
2017-04-19 21:38:36,517: Acquiring new redshift connection "shippo_parcels".
2017-04-19 21:38:36,518: Re-using an available connection from the pool.
2017-04-19 21:38:36,518: Using redshift connection "shippo_parcels".
2017-04-19 21:38:36,518: On shippo_parcels: BEGIN
2017-04-19 21:38:36,518: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c39dd8>]}
2017-04-19 21:38:36,586: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:38:36,586: Using redshift connection "shippo_parcels".
2017-04-19 21:38:36,587: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:36,638: SQL status: SELECT in 0.05 seconds
2017-04-19 21:38:36,640: executing node model.shippo_test.shippo_parcels
2017-04-19 21:38:36,641: Using redshift connection "shippo_parcels".
2017-04-19 21:38:36,641: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 21:38:37,009: SQL status: CREATE VIEW in 0.37 seconds
2017-04-19 21:38:37,243: Using redshift connection "shopify_customers".
2017-04-19 21:38:37,243: On shopify_customers: BEGIN
2017-04-19 21:38:37,287: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:37,288: Using redshift connection "shopify_customers".
2017-04-19 21:38:37,288: On shopify_customers: alter table "analytics"."shopify_customers__dbt_tmp" rename to "shopify_customers"
2017-04-19 21:38:37,288: On shopify_transactions: COMMIT
2017-04-19 21:38:37,311: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:38:37,311: On shopify_customers: COMMIT
2017-04-19 21:38:37,743: Using redshift connection "shopify_transactions".
2017-04-19 21:38:37,744: On shopify_transactions: BEGIN
2017-04-19 21:38:37,806: 21:38:37 | 5 of 13 OK created view model analytics.shopify_customers............ [CREATE VIEW in 4.05s]
2017-04-19 21:38:37,806: 21:38:37 | 8 of 13 START view model analytics.shippo_addresses.................. [RUN]
2017-04-19 21:38:37,806: Compiling model.shippo_test.shippo_addresses
2017-04-19 21:38:37,809: Acquiring new redshift connection "shippo_addresses".
2017-04-19 21:38:37,809: Re-using an available connection from the pool.
2017-04-19 21:38:37,809: Using redshift connection "shippo_addresses".
2017-04-19 21:38:37,809: On shippo_addresses: BEGIN
2017-04-19 21:38:37,809: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:38:37,810: Using redshift connection "shopify_transactions".
2017-04-19 21:38:37,810: On shopify_transactions: drop view if exists "analytics"."shopify_transactions" cascade
2017-04-19 21:38:37,810: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7b780>]}
2017-04-19 21:38:37,850: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:37,850: Using redshift connection "shippo_addresses".
2017-04-19 21:38:37,850: On shippo_addresses: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:37,872: SQL status: DROP VIEW in 0.06 seconds
2017-04-19 21:38:37,872: On shopify_transactions: COMMIT
2017-04-19 21:38:37,891: SQL status: SELECT in 0.04 seconds
2017-04-19 21:38:37,892: executing node model.shippo_test.shippo_addresses
2017-04-19 21:38:37,893: Using redshift connection "shippo_addresses".
2017-04-19 21:38:37,893: On shippo_addresses: -- Compiled by DBT

    

    create view "analytics"."shippo_addresses__dbt_tmp" as (
        select

    object_id as id,

    name,
    company,

    street1,
    street2,
    street3,
    street_no,

    city,
    state,
    zip,
    country,

    email,
    phone,

    is_residential,

    object_owner as owner,
    lower(object_purpose) as purpose,
    lower(object_source) as source,
    lower(object_state) as object_state,

    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.addresses
    );

    
2017-04-19 21:38:38,489: SQL status: CREATE VIEW in 0.60 seconds
2017-04-19 21:38:38,564: Using redshift connection "shopify_transactions".
2017-04-19 21:38:38,564: On shopify_transactions: BEGIN
2017-04-19 21:38:38,603: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:38,604: Using redshift connection "shopify_transactions".
2017-04-19 21:38:38,604: On shopify_transactions: alter table "analytics"."shopify_transactions__dbt_tmp" rename to "shopify_transactions"
2017-04-19 21:38:38,604: On shippo_shipments: COMMIT
2017-04-19 21:38:38,683: SQL status: ALTER TABLE in 0.08 seconds
2017-04-19 21:38:38,683: On shopify_transactions: COMMIT
2017-04-19 21:38:39,137: Using redshift connection "shippo_shipments".
2017-04-19 21:38:39,137: On shippo_shipments: BEGIN
2017-04-19 21:38:39,180: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:39,180: Using redshift connection "shippo_shipments".
2017-04-19 21:38:39,180: On shippo_shipments: drop view if exists "analytics"."shippo_shipments" cascade
2017-04-19 21:38:39,224: SQL status: DROP VIEW in 0.04 seconds
2017-04-19 21:38:39,225: On shippo_shipments: COMMIT
2017-04-19 21:38:39,226: 21:38:39 | 4 of 13 OK created view model analytics.shopify_transactions......... [CREATE VIEW in 6.29s]
2017-04-19 21:38:39,226: 21:38:39 | 9 of 13 START view model analytics.shopify_orders_base............... [RUN]
2017-04-19 21:38:39,226: Compiling model.shippo_test.shopify_orders_base
2017-04-19 21:38:39,228: Acquiring new redshift connection "shopify_orders_base".
2017-04-19 21:38:39,228: Re-using an available connection from the pool.
2017-04-19 21:38:39,228: Using redshift connection "shopify_orders_base".
2017-04-19 21:38:39,228: On shopify_orders_base: BEGIN
2017-04-19 21:38:39,229: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108306588>]}
2017-04-19 21:38:39,271: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:39,271: Using redshift connection "shopify_orders_base".
2017-04-19 21:38:39,271: On shopify_orders_base: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:39,326: SQL status: SELECT in 0.05 seconds
2017-04-19 21:38:39,328: executing node model.shippo_test.shopify_orders_base
2017-04-19 21:38:39,329: Using redshift connection "shopify_orders_base".
2017-04-19 21:38:39,329: On shopify_orders_base: -- Compiled by DBT

    

    create view "analytics"."shopify_orders_base__dbt_tmp" as (
        select
  -- ids
  id,
  customer__id,
  checkout_id,
  cart_token,
  checkout_token,
  token,

  -- logical ids reported in the application
  "number",
  order_number,

  -- state
  financial_status,
  fulfillment_status,
  confirmed,

  -- cancellation information
  cancel_reason,
  cancelled_at,

  -- etc
  closed_at,
  processed_at,
  email,
  contact_email,
  name,
  note,
  tags,

  -- attribution
  browser_ip,
  source_name,
  landing_site,
  null::varchar as landing_site_ref,
  referring_site,

  -- financial
  currency,
  processing_method,

  -- numbers
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_price_usd,
  total_tax,
  total_weight,

  -- point of sale info
  user_id,
  location_id,

  -- address
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,

  -- audit
  created_at,
  updated_at,
  test

from
  shippo_chooze_shopify.orders
    );

    
2017-04-19 21:38:40,099: Using redshift connection "shippo_shipments".
2017-04-19 21:38:40,099: On shippo_shipments: BEGIN
2017-04-19 21:38:40,139: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:40,139: Using redshift connection "shippo_shipments".
2017-04-19 21:38:40,140: On shippo_shipments: alter table "analytics"."shippo_shipments__dbt_tmp" rename to "shippo_shipments"
2017-04-19 21:38:40,140: On shippo_parcels: COMMIT
2017-04-19 21:38:40,612: SQL status: ALTER TABLE in 0.47 seconds
2017-04-19 21:38:40,612: On shippo_shipments: COMMIT
2017-04-19 21:38:40,617: SQL status: CREATE VIEW in 1.29 seconds
2017-04-19 21:38:41,020: Using redshift connection "shippo_parcels".
2017-04-19 21:38:41,020: On shippo_parcels: BEGIN
2017-04-19 21:38:41,021: 21:38:41 | 6 of 13 OK created view model analytics.shippo_shipments............. [CREATE VIEW in 5.92s]
2017-04-19 21:38:41,021: 21:38:41 | 10 of 13 START view model analytics.shopify_products................. [RUN]
2017-04-19 21:38:41,021: Compiling model.shopify.shopify_products
2017-04-19 21:38:41,021: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108306a90>]}
2017-04-19 21:38:41,023: Acquiring new redshift connection "shopify_products".
2017-04-19 21:38:41,025: Re-using an available connection from the pool.
2017-04-19 21:38:41,025: Using redshift connection "shopify_products".
2017-04-19 21:38:41,025: On shopify_products: BEGIN
2017-04-19 21:38:41,072: SQL status: BEGIN in 0.05 seconds
2017-04-19 21:38:41,072: Using redshift connection "shopify_products".
2017-04-19 21:38:41,072: On shopify_products: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:41,093: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:38:41,093: Using redshift connection "shippo_parcels".
2017-04-19 21:38:41,093: On shippo_parcels: drop view if exists "analytics"."shippo_parcels" cascade
2017-04-19 21:38:41,131: SQL status: SELECT in 0.06 seconds
2017-04-19 21:38:41,132: executing node model.shopify.shopify_products
2017-04-19 21:38:41,133: Using redshift connection "shopify_products".
2017-04-19 21:38:41,133: On shopify_products: -- Compiled by DBT

    

    create view "analytics"."shopify_products__dbt_tmp" as (
        select

  id,
  title,
  product_type,
  vendor,
  tags,
  handle,
  published_at,
  created_at,
  updated_at

from
  shippo_chooze_shopify.products
    );

    
2017-04-19 21:38:41,143: SQL status: DROP VIEW in 0.05 seconds
2017-04-19 21:38:41,143: On shippo_parcels: COMMIT
2017-04-19 21:38:41,737: SQL status: CREATE VIEW in 0.60 seconds
2017-04-19 21:38:42,341: Using redshift connection "shippo_parcels".
2017-04-19 21:38:42,341: On shippo_parcels: BEGIN
2017-04-19 21:38:42,409: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:38:42,409: Using redshift connection "shippo_parcels".
2017-04-19 21:38:42,409: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 21:38:42,410: On shippo_addresses: COMMIT
2017-04-19 21:38:42,445: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:38:42,446: On shippo_parcels: COMMIT
2017-04-19 21:38:43,207: Using redshift connection "shippo_addresses".
2017-04-19 21:38:43,207: On shippo_addresses: BEGIN
2017-04-19 21:38:43,256: SQL status: BEGIN in 0.05 seconds
2017-04-19 21:38:43,256: Using redshift connection "shippo_addresses".
2017-04-19 21:38:43,256: On shippo_addresses: drop view if exists "analytics"."shippo_addresses" cascade
2017-04-19 21:38:43,280: SQL status: DROP VIEW in 0.02 seconds
2017-04-19 21:38:43,280: On shippo_addresses: COMMIT
2017-04-19 21:38:43,580: 21:38:43 | 7 of 13 OK created view model analytics.shippo_parcels............... [CREATE VIEW in 7.07s]
2017-04-19 21:38:43,581: 21:38:43 | 11 of 13 START view model analytics.shopify_refunds.................. [RUN]
2017-04-19 21:38:43,581: Compiling model.shopify.shopify_refunds
2017-04-19 21:38:43,581: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f4208>]}
2017-04-19 21:38:43,583: Acquiring new redshift connection "shopify_refunds".
2017-04-19 21:38:43,585: Re-using an available connection from the pool.
2017-04-19 21:38:43,585: Using redshift connection "shopify_refunds".
2017-04-19 21:38:43,585: On shopify_refunds: BEGIN
2017-04-19 21:38:43,664: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:38:43,664: Using redshift connection "shopify_refunds".
2017-04-19 21:38:43,664: On shopify_refunds: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:43,751: SQL status: SELECT in 0.09 seconds
2017-04-19 21:38:43,752: executing node model.shopify.shopify_refunds
2017-04-19 21:38:43,753: Using redshift connection "shopify_refunds".
2017-04-19 21:38:43,753: On shopify_refunds: -- Compiled by DBT

    

    create view "analytics"."shopify_refunds__dbt_tmp" as (
        select

  id,
  order_id,
  user_id,
  restock,
  note,
  created_at

from
  shippo_chooze_shopify.order_refunds
    );

    
2017-04-19 21:38:43,796: Using redshift connection "shippo_addresses".
2017-04-19 21:38:43,796: On shippo_addresses: BEGIN
2017-04-19 21:38:43,817: SQL status: CREATE VIEW in 0.06 seconds
2017-04-19 21:38:43,837: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:43,838: Using redshift connection "shippo_addresses".
2017-04-19 21:38:43,838: On shippo_addresses: alter table "analytics"."shippo_addresses__dbt_tmp" rename to "shippo_addresses"
2017-04-19 21:38:43,838: On shopify_orders_base: COMMIT
2017-04-19 21:38:43,859: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:38:43,859: On shippo_addresses: COMMIT
2017-04-19 21:38:44,973: Using redshift connection "shopify_orders_base".
2017-04-19 21:38:44,973: On shopify_orders_base: BEGIN
2017-04-19 21:38:44,973: 21:38:44 | 8 of 13 OK created view model analytics.shippo_addresses............. [CREATE VIEW in 7.17s]
2017-04-19 21:38:44,974: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f49b0>]}
2017-04-19 21:38:45,021: SQL status: BEGIN in 0.05 seconds
2017-04-19 21:38:45,021: Using redshift connection "shopify_orders_base".
2017-04-19 21:38:45,021: On shopify_orders_base: drop view if exists "analytics"."shopify_orders_base" cascade
2017-04-19 21:38:45,132: SQL status: DROP VIEW in 0.11 seconds
2017-04-19 21:38:45,132: On shopify_orders_base: COMMIT
2017-04-19 21:38:45,731: Using redshift connection "shopify_orders_base".
2017-04-19 21:38:45,731: On shopify_orders_base: BEGIN
2017-04-19 21:38:45,776: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:45,776: Using redshift connection "shopify_orders_base".
2017-04-19 21:38:45,776: On shopify_orders_base: alter table "analytics"."shopify_orders_base__dbt_tmp" rename to "shopify_orders_base"
2017-04-19 21:38:45,776: On shopify_products: COMMIT
2017-04-19 21:38:45,850: SQL status: ALTER TABLE in 0.07 seconds
2017-04-19 21:38:45,850: On shopify_orders_base: COMMIT
2017-04-19 21:38:46,653: Using redshift connection "shopify_products".
2017-04-19 21:38:46,653: On shopify_products: BEGIN
2017-04-19 21:38:46,697: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:46,697: Using redshift connection "shopify_products".
2017-04-19 21:38:46,698: On shopify_products: drop view if exists "analytics"."shopify_products" cascade
2017-04-19 21:38:46,855: SQL status: DROP VIEW in 0.16 seconds
2017-04-19 21:38:46,855: On shopify_products: COMMIT
2017-04-19 21:38:46,955: 21:38:46 | 9 of 13 OK created view model analytics.shopify_orders_base.......... [CREATE VIEW in 7.73s]
2017-04-19 21:38:46,955: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082eecc0>]}
2017-04-19 21:38:47,471: Using redshift connection "shopify_products".
2017-04-19 21:38:47,472: On shopify_products: BEGIN
2017-04-19 21:38:47,514: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:38:47,515: Using redshift connection "shopify_products".
2017-04-19 21:38:47,515: On shopify_products: alter table "analytics"."shopify_products__dbt_tmp" rename to "shopify_products"
2017-04-19 21:38:47,515: On shopify_refunds: COMMIT
2017-04-19 21:38:47,537: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:38:47,537: On shopify_products: COMMIT
2017-04-19 21:38:48,598: Using redshift connection "shopify_refunds".
2017-04-19 21:38:48,598: On shopify_refunds: BEGIN
2017-04-19 21:38:48,602: 21:38:48 | 10 of 13 OK created view model analytics.shopify_products............ [CREATE VIEW in 7.58s]
2017-04-19 21:38:48,602: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834eb70>]}
2017-04-19 21:38:48,668: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:38:48,668: Using redshift connection "shopify_refunds".
2017-04-19 21:38:48,668: On shopify_refunds: drop view if exists "analytics"."shopify_refunds" cascade
2017-04-19 21:38:48,710: SQL status: DROP VIEW in 0.04 seconds
2017-04-19 21:38:48,710: On shopify_refunds: COMMIT
2017-04-19 21:38:49,200: Using redshift connection "shopify_refunds".
2017-04-19 21:38:49,201: On shopify_refunds: BEGIN
2017-04-19 21:38:49,270: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:38:49,271: Using redshift connection "shopify_refunds".
2017-04-19 21:38:49,271: On shopify_refunds: alter table "analytics"."shopify_refunds__dbt_tmp" rename to "shopify_refunds"
2017-04-19 21:38:49,338: SQL status: ALTER TABLE in 0.07 seconds
2017-04-19 21:38:49,339: On shopify_refunds: COMMIT
2017-04-19 21:38:50,236: 21:38:50 | 11 of 13 OK created view model analytics.shopify_refunds............. [CREATE VIEW in 6.66s]
2017-04-19 21:38:50,237: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c2be0>]}
2017-04-19 21:38:50,404: 21:38:50 | 12 of 13 START view model analytics.shopify_orders................... [RUN]
2017-04-19 21:38:50,404: Compiling model.shopify.shopify_orders
2017-04-19 21:38:50,407: Acquiring new redshift connection "shopify_orders".
2017-04-19 21:38:50,407: Re-using an available connection from the pool.
2017-04-19 21:38:50,407: Using redshift connection "shopify_orders".
2017-04-19 21:38:50,407: On shopify_orders: BEGIN
2017-04-19 21:38:50,484: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:38:50,484: Using redshift connection "shopify_orders".
2017-04-19 21:38:50,485: On shopify_orders: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:50,573: SQL status: SELECT in 0.09 seconds
2017-04-19 21:38:50,575: executing node model.shopify.shopify_orders
2017-04-19 21:38:50,576: Using redshift connection "shopify_orders".
2017-04-19 21:38:50,576: On shopify_orders: -- Compiled by DBT

    

    create view "analytics"."shopify_orders__dbt_tmp" as (
        -- see shopify docs here:
-- https://help.shopify.com/api/reference/order

select
  -- ids
  id,
  customer__id as customer_id,
  checkout_id,
  nullif(cart_token, '') as cart_token,
  nullif(checkout_token, '') as checkout_token,
  nullif(token, '') as token,

  -- logical ids reported in the application
  "number",
  order_number,

  -- state
  financial_status,
  fulfillment_status,
  confirmed,

  -- cancellation information
  cancel_reason,
  cancelled_at,

  -- etc
  closed_at,
  processed_at,
  email,
  contact_email,
  name,
  note,
  tags,

  -- attribution
  browser_ip,
  source_name,
  landing_site,
  landing_site_ref,
  referring_site,

  -- financial
  currency,
  processing_method,

  -- numbers
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_price_usd,
  total_tax,
  total_weight,

  -- point of sale info
  user_id,
  location_id,

  -- address
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,

  -- audit
  created_at,
  updated_at

from
  "analytics"."shopify_orders_base"

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 21:38:51,874: SQL status: CREATE VIEW in 1.30 seconds
2017-04-19 21:38:51,874: Using redshift connection "shopify_orders".
2017-04-19 21:38:51,875: On shopify_orders: alter table "analytics"."shopify_orders__dbt_tmp" rename to "shopify_orders"
2017-04-19 21:38:51,916: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:38:51,916: On shopify_orders: COMMIT
2017-04-19 21:38:52,489: 21:38:52 | 12 of 13 OK created view model analytics.shopify_orders.............. [CREATE VIEW in 2.09s]
2017-04-19 21:38:52,490: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f4fd0>]}
2017-04-19 21:38:52,598: 21:38:52 | 13 of 13 START view model analytics.shopify_orders_xf................ [RUN]
2017-04-19 21:38:52,599: Compiling model.shopify.shopify_orders_xf
2017-04-19 21:38:52,601: Acquiring new redshift connection "shopify_orders_xf".
2017-04-19 21:38:52,601: Re-using an available connection from the pool.
2017-04-19 21:38:52,601: Using redshift connection "shopify_orders_xf".
2017-04-19 21:38:52,601: On shopify_orders_xf: BEGIN
2017-04-19 21:38:52,670: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:38:52,670: Using redshift connection "shopify_orders_xf".
2017-04-19 21:38:52,670: On shopify_orders_xf: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:38:52,754: SQL status: SELECT in 0.08 seconds
2017-04-19 21:38:52,756: executing node model.shopify.shopify_orders_xf
2017-04-19 21:38:52,757: Using redshift connection "shopify_orders_xf".
2017-04-19 21:38:52,757: On shopify_orders_xf: -- Compiled by DBT

    

    create view "analytics"."shopify_orders_xf__dbt_tmp" as (
        

with orders as (

  select * from "analytics"."shopify_orders"

)

select
  *,
  row_number() over (partition by customer_id order by created_at) as order_seq_number,
  case
    when row_number() over (partition by customer_id order by created_at) = 1 then 'new'
    else 'repeat'
  end as new_vs_repeat,
  case
    when cancelled_at is not null then true
    else false
  end as cancelled
from orders
    );

    
2017-04-19 21:38:53,615: SQL status: CREATE VIEW in 0.86 seconds
2017-04-19 21:38:53,616: Using redshift connection "shopify_orders_xf".
2017-04-19 21:38:53,616: On shopify_orders_xf: alter table "analytics"."shopify_orders_xf__dbt_tmp" rename to "shopify_orders_xf"
2017-04-19 21:38:53,653: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:38:53,653: On shopify_orders_xf: COMMIT
2017-04-19 21:38:53,910: 21:38:53 | 13 of 13 OK created view model analytics.shopify_orders_xf........... [CREATE VIEW in 1.31s]
2017-04-19 21:38:53,911: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6198d4f6-1d9d-4f59-9bc5-e6acf622b66a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108366160>]}
2017-04-19 21:38:54,107: Using redshift connection "master".
2017-04-19 21:38:54,107: On master: BEGIN
2017-04-19 21:38:54,191: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:38:54,191: On master: COMMIT
2017-04-19 21:38:54,234: 21:38:54 | 
2017-04-19 21:38:54,234: 21:38:54 | Finished running 13 view models in 21.48s.
2017-04-19 21:38:54,234: Connection 'master' was left open.
2017-04-19 21:38:54,235: Done. PASS=12 ERROR=1 SKIP=0 TOTAL=13
2017-04-19 21:38:54,235: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fe0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fe710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834eb70>]}
2017-04-19 21:38:54,349: Flushing usage events
2017-04-19 21:43:01,071: Tracking: tracking
2017-04-19 21:43:01,071: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccea58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cce7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cce9e8>]}
2017-04-19 21:43:01,440: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 21:43:01,487: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 21:43:01,536: Parsing materializations/incremental.sql
2017-04-19 21:43:01,554: Parsing materializations/table.sql
2017-04-19 21:43:01,564: Parsing materializations/view.sql
2017-04-19 21:43:01,569: Parsing materializations/wrapper.sql
2017-04-19 21:43:01,572: Parsing schema_tests/accepted_values.sql
2017-04-19 21:43:01,574: Parsing schema_tests/not_null.sql
2017-04-19 21:43:01,576: Parsing schema_tests/relationships.sql
2017-04-19 21:43:01,578: Parsing schema_tests/unique.sql
2017-04-19 21:43:01,585: Parsing model.shippo_test.shippo_addresses
2017-04-19 21:43:01,586: Parsing model.shippo_test.shippo_parcels
2017-04-19 21:43:01,588: Parsing model.shippo_test.shippo_shipments
2017-04-19 21:43:01,589: Parsing model.shippo_test.shopify_order_items_base
2017-04-19 21:43:01,590: Parsing model.shippo_test.shopify_orders_base
2017-04-19 21:43:01,597: Parsing model.shopify.shopify_checkouts
2017-04-19 21:43:01,599: Parsing model.shopify.shopify_customers
2017-04-19 21:43:01,601: Parsing model.shopify.shopify_discount_codes
2017-04-19 21:43:01,603: Parsing model.shopify.shopify_order_items
2017-04-19 21:43:01,605: Parsing model.shopify.shopify_orders
2017-04-19 21:43:01,608: Parsing model.shopify.shopify_products
2017-04-19 21:43:01,609: Parsing model.shopify.shopify_refunds
2017-04-19 21:43:01,611: Parsing model.shopify.shopify_transactions
2017-04-19 21:43:01,612: Parsing model.shopify.shopify_orders_xf
2017-04-19 21:43:01,629: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 21:43:01,631: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 21:43:01,632: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 21:43:01,633: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 21:43:01,635: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 21:43:01,636: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 21:43:01,637: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 21:43:01,639: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 21:43:01,640: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 21:43:01,641: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 21:43:01,643: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 21:43:01,645: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 21:43:01,647: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 21:43:01,649: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 21:43:01,651: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 21:43:01,653: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 21:43:01,654: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 21:43:01,656: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 21:43:01,657: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 21:43:01,659: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 21:43:01,675: Parsing test.shopify.unique_shopify_orders_cart_token
2017-04-19 21:43:01,676: Parsing test.shopify.unique_shopify_orders_id
2017-04-19 21:43:01,678: Parsing test.shopify.not_null_shopify_orders_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 21:43:01,679: Parsing test.shopify.not_null_shopify_orders_id
2017-04-19 21:43:01,681: Parsing test.shopify.relationships_shopify_orders_id__customer_id__shopify_customers
2017-04-19 21:43:01,683: Parsing test.shopify.unique_shopify_checkouts_cart_token
2017-04-19 21:43:01,685: Parsing test.shopify.unique_shopify_checkouts_id
2017-04-19 21:43:01,686: Parsing test.shopify.not_null_shopify_checkouts_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 21:43:01,688: Parsing test.shopify.not_null_shopify_checkouts_id
2017-04-19 21:43:01,689: Parsing test.shopify.relationships_shopify_checkouts_id__customer_id__shopify_customers
2017-04-19 21:43:01,691: Parsing test.shopify.unique_shopify_customers_id
2017-04-19 21:43:01,692: Parsing test.shopify.not_null_shopify_customers_id
2017-04-19 21:43:01,694: Parsing test.shopify.not_null_shopify_discount_codes_order_id
2017-04-19 21:43:01,695: Parsing test.shopify.relationships_shopify_discount_codes_id__order_id__shopify_orders
2017-04-19 21:43:01,698: Parsing test.shopify.not_null_shopify_transactions_id
2017-04-19 21:43:01,699: Parsing test.shopify.not_null_shopify_transactions_order_id
2017-04-19 21:43:01,701: Parsing test.shopify.unique_shopify_transactions_id
2017-04-19 21:43:01,702: Parsing test.shopify.relationships_shopify_transactions_id__order_id__shopify_orders
2017-04-19 21:43:01,704: Parsing test.shopify.not_null_shopify_refunds_id
2017-04-19 21:43:01,705: Parsing test.shopify.not_null_shopify_refunds_order_id
2017-04-19 21:43:01,707: Parsing test.shopify.unique_shopify_refunds_id
2017-04-19 21:43:01,708: Parsing test.shopify.relationships_shopify_refunds_id__order_id__shopify_orders
2017-04-19 21:43:01,710: Parsing test.shopify.not_null_shopify_products_id
2017-04-19 21:43:01,711: Parsing test.shopify.unique_shopify_products_id
2017-04-19 21:43:01,713: Parsing test.shopify.not_null_shopify_order_items_id
2017-04-19 21:43:01,714: Parsing test.shopify.not_null_shopify_order_items_order_id
2017-04-19 21:43:01,716: Parsing test.shopify.unique_shopify_order_items_id
2017-04-19 21:43:01,717: Parsing test.shopify.relationships_shopify_order_items_id__order_id__shopify_orders
2017-04-19 21:43:01,719: Parsing test.shopify.relationships_shopify_order_items_id__product_id__shopify_products
2017-04-19 21:43:01,723: Compiled 14 models, 49 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 21:43:01,727: Acquiring new redshift connection "master".
2017-04-19 21:43:01,727: Opening a new connection (0 currently allocated)
2017-04-19 21:43:01,970: Using redshift connection "master".
2017-04-19 21:43:01,970: On master: BEGIN
2017-04-19 21:43:02,041: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:02,042: Creating schema "analytics".
2017-04-19 21:43:02,042: Using redshift connection "master".
2017-04-19 21:43:02,042: On master: create schema if not exists "analytics"
2017-04-19 21:43:02,076: SQL status: CREATE SCHEMA in 0.03 seconds
2017-04-19 21:43:02,077: On master: COMMIT
2017-04-19 21:43:02,398: Concurrency: 4 threads (target='only')
2017-04-19 21:43:02,399: Using redshift connection "master".
2017-04-19 21:43:02,399: On master: BEGIN
2017-04-19 21:43:02,466: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:02,466: Using redshift connection "master".
2017-04-19 21:43:02,467: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:02,550: SQL status: SELECT in 0.08 seconds
2017-04-19 21:43:02,550: On master: COMMIT
2017-04-19 21:43:02,582: 
2017-04-19 21:43:02,582: 21:43:02 | Running 14 view models
2017-04-19 21:43:02,582: 21:43:02 | 
2017-04-19 21:43:02,582: Using redshift connection "master".
2017-04-19 21:43:02,582: On master: BEGIN
2017-04-19 21:43:02,651: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:02,679: On master: COMMIT
2017-04-19 21:43:02,717: 21:43:02 | 1 of 14 START view model analytics.shopify_transactions.............. [RUN]
2017-04-19 21:43:02,717: Compiling model.shopify.shopify_transactions
2017-04-19 21:43:02,719: Acquiring new redshift connection "shopify_transactions".
2017-04-19 21:43:02,719: Opening a new connection (1 currently allocated)
2017-04-19 21:43:02,717: 21:43:02 | 2 of 14 START view model analytics.shippo_addresses.................. [RUN]
2017-04-19 21:43:02,717: 21:43:02 | 3 of 14 START view model analytics.shopify_order_items_base.......... [RUN]
2017-04-19 21:43:02,720: Compiling model.shippo_test.shippo_addresses
2017-04-19 21:43:02,717: 21:43:02 | 4 of 14 START view model analytics.shippo_parcels.................... [RUN]
2017-04-19 21:43:02,720: Compiling model.shippo_test.shopify_order_items_base
2017-04-19 21:43:02,722: Acquiring new redshift connection "shippo_addresses".
2017-04-19 21:43:02,722: Compiling model.shippo_test.shippo_parcels
2017-04-19 21:43:02,723: Acquiring new redshift connection "shopify_order_items_base".
2017-04-19 21:43:02,724: Acquiring new redshift connection "shippo_parcels".
2017-04-19 21:43:02,851: Using redshift connection "shopify_transactions".
2017-04-19 21:43:02,851: On shopify_transactions: BEGIN
2017-04-19 21:43:02,851: Opening a new connection (2 currently allocated)
2017-04-19 21:43:02,888: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:02,888: Using redshift connection "shopify_transactions".
2017-04-19 21:43:02,888: On shopify_transactions: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:02,929: SQL status: SELECT in 0.04 seconds
2017-04-19 21:43:02,931: executing node model.shopify.shopify_transactions
2017-04-19 21:43:02,932: Using redshift connection "shopify_transactions".
2017-04-19 21:43:02,932: On shopify_transactions: -- Compiled by DBT

    

    create view "analytics"."shopify_transactions__dbt_tmp" as (
        select

  id,
  parent_id,
  order_id,

  status,
  error_code,
  message,

  kind,
  amount,
  "authorization",
  currency,
  gateway,

  source_name,

  created_at

from
  shippo_chooze_shopify.transactions

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 21:43:03,079: SQL status: CREATE VIEW in 0.15 seconds
2017-04-19 21:43:03,079: On shopify_transactions: COMMIT
2017-04-19 21:43:03,122: Using redshift connection "shippo_addresses".
2017-04-19 21:43:03,122: On shippo_addresses: BEGIN
2017-04-19 21:43:03,123: Opening a new connection (3 currently allocated)
2017-04-19 21:43:03,194: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:03,195: Using redshift connection "shippo_addresses".
2017-04-19 21:43:03,195: On shippo_addresses: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:03,249: SQL status: SELECT in 0.05 seconds
2017-04-19 21:43:03,251: executing node model.shippo_test.shippo_addresses
2017-04-19 21:43:03,252: Using redshift connection "shippo_addresses".
2017-04-19 21:43:03,252: On shippo_addresses: -- Compiled by DBT

    

    create view "analytics"."shippo_addresses__dbt_tmp" as (
        select

    object_id as id,

    name,
    company,

    street1,
    street2,
    street3,
    street_no,

    city,
    state,
    zip,
    country,

    email,
    phone,

    is_residential,

    object_owner as owner,
    lower(object_purpose) as purpose,
    lower(object_source) as source,
    lower(object_state) as object_state,

    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.addresses
    );

    
2017-04-19 21:43:03,430: Using redshift connection "shopify_order_items_base".
2017-04-19 21:43:03,430: Opening a new connection (4 currently allocated)
2017-04-19 21:43:03,430: On shopify_order_items_base: BEGIN
2017-04-19 21:43:03,466: SQL status: CREATE VIEW in 0.21 seconds
2017-04-19 21:43:03,514: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:43:03,514: Using redshift connection "shopify_order_items_base".
2017-04-19 21:43:03,514: On shopify_order_items_base: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:03,570: Using redshift connection "shippo_parcels".
2017-04-19 21:43:03,570: On shippo_parcels: BEGIN
2017-04-19 21:43:03,578: SQL status: SELECT in 0.06 seconds
2017-04-19 21:43:03,580: executing node model.shippo_test.shopify_order_items_base
2017-04-19 21:43:03,580: Using redshift connection "shopify_order_items_base".
2017-04-19 21:43:03,581: On shopify_order_items_base: -- Compiled by DBT

    

    create view "analytics"."shopify_order_items_base__dbt_tmp" as (
        select

    id,
    product_id,
    _sdc_source_key_id,
    sku,
    name,
    title,
    vendor,
    quantity,
    null::float as pre_tax_price,
    price,
    taxable,
    gift_card,
    total_discount,
    grams

from
    shippo_chooze_shopify.orders__line_items
    );

    
2017-04-19 21:43:03,607: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:03,608: Using redshift connection "shippo_parcels".
2017-04-19 21:43:03,608: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:03,639: Using redshift connection "shopify_transactions".
2017-04-19 21:43:03,640: On shopify_transactions: BEGIN
2017-04-19 21:43:03,651: SQL status: SELECT in 0.04 seconds
2017-04-19 21:43:03,652: executing node model.shippo_test.shippo_parcels
2017-04-19 21:43:03,653: Using redshift connection "shippo_parcels".
2017-04-19 21:43:03,653: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 21:43:03,678: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:03,678: Using redshift connection "shopify_transactions".
2017-04-19 21:43:03,678: On shopify_transactions: drop view if exists "analytics"."shopify_transactions" cascade
2017-04-19 21:43:03,679: SQL status: CREATE VIEW in 0.03 seconds
2017-04-19 21:43:03,685: SQL status: CREATE VIEW in 0.10 seconds
2017-04-19 21:43:03,685: Using redshift connection "shopify_order_items_base".
2017-04-19 21:43:03,685: On shopify_order_items_base: alter table "analytics"."shopify_order_items_base__dbt_tmp" rename to "shopify_order_items_base"
2017-04-19 21:43:03,701: SQL status: DROP VIEW in 0.02 seconds
2017-04-19 21:43:03,701: On shopify_transactions: COMMIT
2017-04-19 21:43:03,727: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:43:03,728: On shopify_order_items_base: COMMIT
2017-04-19 21:43:04,158: Using redshift connection "shopify_transactions".
2017-04-19 21:43:04,158: On shopify_transactions: BEGIN
2017-04-19 21:43:04,195: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:04,195: Using redshift connection "shopify_transactions".
2017-04-19 21:43:04,195: On shopify_transactions: alter table "analytics"."shopify_transactions__dbt_tmp" rename to "shopify_transactions"
2017-04-19 21:43:04,196: On shippo_addresses: COMMIT
2017-04-19 21:43:04,217: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:43:04,217: On shopify_transactions: COMMIT
2017-04-19 21:43:04,263: 21:43:04 | 3 of 14 OK created view model analytics.shopify_order_items_base..... [CREATE VIEW in 1.55s]
2017-04-19 21:43:04,263: 21:43:04 | 5 of 14 START view model analytics.shippo_shipments.................. [RUN]
2017-04-19 21:43:04,263: Compiling model.shippo_test.shippo_shipments
2017-04-19 21:43:04,265: Acquiring new redshift connection "shippo_shipments".
2017-04-19 21:43:04,266: Re-using an available connection from the pool.
2017-04-19 21:43:04,266: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de6e10>]}
2017-04-19 21:43:04,266: Using redshift connection "shippo_shipments".
2017-04-19 21:43:04,268: On shippo_shipments: BEGIN
2017-04-19 21:43:04,355: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:43:04,355: Using redshift connection "shippo_shipments".
2017-04-19 21:43:04,355: On shippo_shipments: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:04,414: SQL status: SELECT in 0.06 seconds
2017-04-19 21:43:04,416: executing node model.shippo_test.shippo_shipments
2017-04-19 21:43:04,417: Using redshift connection "shippo_shipments".
2017-04-19 21:43:04,417: On shippo_shipments: -- Compiled by DBT

    

    create view "analytics"."shippo_shipments__dbt_tmp" as (
        select

    object_id as id,

    address_from as address_from_id,
    address_return as address_return_id,
    address_to as address_to_id,
    parcel as parcel_id,

    insurance_amount::float,
    insurance_currency,

    rates_url,
    return_of,
    submission_date,
    lower(submission_type) as submission_type,
    customs_declaration,


    object_owner as owner,
    lower(object_state) as state,
    lower(object_purpose) as purpose,
    lower(object_status) as status,


    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments
    );

    
2017-04-19 21:43:04,801: Using redshift connection "shippo_addresses".
2017-04-19 21:43:04,801: On shippo_addresses: BEGIN
2017-04-19 21:43:04,870: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:04,870: Using redshift connection "shippo_addresses".
2017-04-19 21:43:04,871: On shippo_addresses: drop view if exists "analytics"."shippo_addresses" cascade
2017-04-19 21:43:05,237: SQL status: DROP VIEW in 0.37 seconds
2017-04-19 21:43:05,237: On shippo_addresses: COMMIT
2017-04-19 21:43:05,446: SQL status: CREATE VIEW in 1.03 seconds
2017-04-19 21:43:05,509: 21:43:05 | 1 of 14 OK created view model analytics.shopify_transactions......... [CREATE VIEW in 2.79s]
2017-04-19 21:43:05,510: 21:43:05 | 6 of 14 START view model analytics.shopify_customers................. [RUN]
2017-04-19 21:43:05,510: Compiling model.shopify.shopify_customers
2017-04-19 21:43:05,512: Acquiring new redshift connection "shopify_customers".
2017-04-19 21:43:05,512: Re-using an available connection from the pool.
2017-04-19 21:43:05,512: Using redshift connection "shopify_customers".
2017-04-19 21:43:05,512: On shopify_customers: BEGIN
2017-04-19 21:43:05,512: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068047f0>]}
2017-04-19 21:43:05,554: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:05,554: Using redshift connection "shopify_customers".
2017-04-19 21:43:05,554: On shopify_customers: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:05,591: SQL status: SELECT in 0.04 seconds
2017-04-19 21:43:05,592: executing node model.shopify.shopify_customers
2017-04-19 21:43:05,593: Using redshift connection "shopify_customers".
2017-04-19 21:43:05,593: On shopify_customers: -- Compiled by DBT

    

    create view "analytics"."shopify_customers__dbt_tmp" as (
        select
  id,
  first_name,
  last_name,
  email,
  verified_email,
  default_address__id as default_address_id,
  note,
  state,
  tags,
  tax_exempt,
  created_at,
  updated_at
from
  shippo_chooze_shopify.customers
    );

    
2017-04-19 21:43:05,814: SQL status: CREATE VIEW in 0.22 seconds
2017-04-19 21:43:05,897: Using redshift connection "shippo_addresses".
2017-04-19 21:43:05,897: On shippo_addresses: BEGIN
2017-04-19 21:43:05,966: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:05,966: Using redshift connection "shippo_addresses".
2017-04-19 21:43:05,966: On shippo_addresses: alter table "analytics"."shippo_addresses__dbt_tmp" rename to "shippo_addresses"
2017-04-19 21:43:05,966: On shippo_parcels: COMMIT
2017-04-19 21:43:06,010: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:43:06,011: On shippo_addresses: COMMIT
2017-04-19 21:43:06,402: Using redshift connection "shippo_parcels".
2017-04-19 21:43:06,402: On shippo_parcels: BEGIN
2017-04-19 21:43:06,444: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:06,444: Using redshift connection "shippo_parcels".
2017-04-19 21:43:06,444: On shippo_parcels: drop view if exists "analytics"."shippo_parcels" cascade
2017-04-19 21:43:06,626: SQL status: DROP VIEW in 0.18 seconds
2017-04-19 21:43:06,627: On shippo_parcels: COMMIT
2017-04-19 21:43:07,085: 21:43:07 | 2 of 14 OK created view model analytics.shippo_addresses............. [CREATE VIEW in 4.37s]
2017-04-19 21:43:07,085: 21:43:07 | 7 of 14 START view model analytics.shopify_discount_codes............ [RUN]
2017-04-19 21:43:07,085: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e4358>]}
2017-04-19 21:43:07,085: Compiling model.shopify.shopify_discount_codes
2017-04-19 21:43:07,089: Acquiring new redshift connection "shopify_discount_codes".
2017-04-19 21:43:07,089: Re-using an available connection from the pool.
2017-04-19 21:43:07,090: Using redshift connection "shopify_discount_codes".
2017-04-19 21:43:07,090: On shopify_discount_codes: BEGIN
2017-04-19 21:43:07,162: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:07,162: Using redshift connection "shopify_discount_codes".
2017-04-19 21:43:07,162: On shopify_discount_codes: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:07,243: SQL status: SELECT in 0.08 seconds
2017-04-19 21:43:07,244: executing node model.shopify.shopify_discount_codes
2017-04-19 21:43:07,245: Using redshift connection "shopify_discount_codes".
2017-04-19 21:43:07,245: On shopify_discount_codes: -- Compiled by DBT

    

    create view "analytics"."shopify_discount_codes__dbt_tmp" as (
        select

  _sdc_source_key_id as order_id,
  code,
  amount,
  type

from
  shippo_chooze_shopify.orders__discount_codes
    );

    
2017-04-19 21:43:08,055: SQL status: CREATE VIEW in 0.81 seconds
2017-04-19 21:43:08,088: Using redshift connection "shippo_parcels".
2017-04-19 21:43:08,088: On shippo_parcels: BEGIN
2017-04-19 21:43:08,127: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:08,128: Using redshift connection "shippo_parcels".
2017-04-19 21:43:08,128: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 21:43:08,128: On shippo_shipments: COMMIT
2017-04-19 21:43:08,151: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:43:08,151: On shippo_parcels: COMMIT
2017-04-19 21:43:08,662: Using redshift connection "shippo_shipments".
2017-04-19 21:43:08,662: On shippo_shipments: BEGIN
2017-04-19 21:43:08,689: 21:43:08 | 4 of 14 OK created view model analytics.shippo_parcels............... [CREATE VIEW in 5.97s]
2017-04-19 21:43:08,690: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106828588>]}
2017-04-19 21:43:08,689: 21:43:08 | 8 of 14 START view model analytics.shopify_products.................. [RUN]
2017-04-19 21:43:08,692: Compiling model.shopify.shopify_products
2017-04-19 21:43:08,694: Acquiring new redshift connection "shopify_products".
2017-04-19 21:43:08,694: Re-using an available connection from the pool.
2017-04-19 21:43:08,694: Using redshift connection "shopify_products".
2017-04-19 21:43:08,695: On shopify_products: BEGIN
2017-04-19 21:43:08,727: SQL status: BEGIN in 0.03 seconds
2017-04-19 21:43:08,727: Using redshift connection "shopify_products".
2017-04-19 21:43:08,728: On shopify_products: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:08,752: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:43:08,753: Using redshift connection "shippo_shipments".
2017-04-19 21:43:08,753: On shippo_shipments: drop view if exists "analytics"."shippo_shipments" cascade
2017-04-19 21:43:08,778: SQL status: SELECT in 0.05 seconds
2017-04-19 21:43:08,779: executing node model.shopify.shopify_products
2017-04-19 21:43:08,780: Using redshift connection "shopify_products".
2017-04-19 21:43:08,780: On shopify_products: -- Compiled by DBT

    

    create view "analytics"."shopify_products__dbt_tmp" as (
        select

  id,
  title,
  product_type,
  vendor,
  tags,
  handle,
  published_at,
  created_at,
  updated_at

from
  shippo_chooze_shopify.products
    );

    
2017-04-19 21:43:09,347: SQL status: DROP VIEW in 0.59 seconds
2017-04-19 21:43:09,348: On shippo_shipments: COMMIT
2017-04-19 21:43:09,374: SQL status: CREATE VIEW in 0.59 seconds
2017-04-19 21:43:09,889: Using redshift connection "shippo_shipments".
2017-04-19 21:43:09,890: On shippo_shipments: BEGIN
2017-04-19 21:43:09,973: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:43:09,973: Using redshift connection "shippo_shipments".
2017-04-19 21:43:09,973: On shippo_shipments: alter table "analytics"."shippo_shipments__dbt_tmp" rename to "shippo_shipments"
2017-04-19 21:43:09,973: On shopify_customers: COMMIT
2017-04-19 21:43:10,040: SQL status: ALTER TABLE in 0.07 seconds
2017-04-19 21:43:10,040: On shippo_shipments: COMMIT
2017-04-19 21:43:10,889: Using redshift connection "shopify_customers".
2017-04-19 21:43:10,889: On shopify_customers: BEGIN
2017-04-19 21:43:10,928: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:10,928: Using redshift connection "shopify_customers".
2017-04-19 21:43:10,928: On shopify_customers: drop view if exists "analytics"."shopify_customers" cascade
2017-04-19 21:43:11,422: SQL status: DROP VIEW in 0.49 seconds
2017-04-19 21:43:11,422: On shopify_customers: COMMIT
2017-04-19 21:43:11,756: 21:43:11 | 5 of 14 OK created view model analytics.shippo_shipments............. [CREATE VIEW in 7.49s]
2017-04-19 21:43:11,756: 21:43:11 | 9 of 14 START view model analytics.shopify_refunds................... [RUN]
2017-04-19 21:43:11,756: Compiling model.shopify.shopify_refunds
2017-04-19 21:43:11,758: Acquiring new redshift connection "shopify_refunds".
2017-04-19 21:43:11,759: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d19550>]}
2017-04-19 21:43:11,760: Re-using an available connection from the pool.
2017-04-19 21:43:11,760: Using redshift connection "shopify_refunds".
2017-04-19 21:43:11,761: On shopify_refunds: BEGIN
2017-04-19 21:43:11,843: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:43:11,843: Using redshift connection "shopify_refunds".
2017-04-19 21:43:11,843: On shopify_refunds: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:11,938: SQL status: SELECT in 0.10 seconds
2017-04-19 21:43:11,940: executing node model.shopify.shopify_refunds
2017-04-19 21:43:11,941: Using redshift connection "shopify_refunds".
2017-04-19 21:43:11,941: On shopify_refunds: -- Compiled by DBT

    

    create view "analytics"."shopify_refunds__dbt_tmp" as (
        select

  id,
  order_id,
  user_id,
  restock,
  note,
  created_at

from
  shippo_chooze_shopify.order_refunds
    );

    
2017-04-19 21:43:12,554: SQL status: CREATE VIEW in 0.61 seconds
2017-04-19 21:43:12,856: Using redshift connection "shopify_customers".
2017-04-19 21:43:12,856: On shopify_customers: BEGIN
2017-04-19 21:43:12,903: SQL status: BEGIN in 0.05 seconds
2017-04-19 21:43:12,903: Using redshift connection "shopify_customers".
2017-04-19 21:43:12,903: On shopify_customers: alter table "analytics"."shopify_customers__dbt_tmp" rename to "shopify_customers"
2017-04-19 21:43:12,903: On shopify_discount_codes: COMMIT
2017-04-19 21:43:12,922: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:43:12,922: On shopify_customers: COMMIT
2017-04-19 21:43:13,520: Using redshift connection "shopify_discount_codes".
2017-04-19 21:43:13,520: On shopify_discount_codes: BEGIN
2017-04-19 21:43:13,573: 21:43:13 | 6 of 14 OK created view model analytics.shopify_customers............ [CREATE VIEW in 8.06s]
2017-04-19 21:43:13,573: 21:43:13 | 10 of 14 START view model analytics.shopify_orders_base.............. [RUN]
2017-04-19 21:43:13,573: Compiling model.shippo_test.shopify_orders_base
2017-04-19 21:43:13,573: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d19908>]}
2017-04-19 21:43:13,575: Acquiring new redshift connection "shopify_orders_base".
2017-04-19 21:43:13,576: Re-using an available connection from the pool.
2017-04-19 21:43:13,576: Using redshift connection "shopify_orders_base".
2017-04-19 21:43:13,576: On shopify_orders_base: BEGIN
2017-04-19 21:43:13,588: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:13,588: Using redshift connection "shopify_discount_codes".
2017-04-19 21:43:13,589: On shopify_discount_codes: drop view if exists "analytics"."shopify_discount_codes" cascade
2017-04-19 21:43:13,618: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:13,618: Using redshift connection "shopify_orders_base".
2017-04-19 21:43:13,618: On shopify_orders_base: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:13,631: SQL status: DROP VIEW in 0.04 seconds
2017-04-19 21:43:13,631: On shopify_discount_codes: COMMIT
2017-04-19 21:43:13,671: SQL status: SELECT in 0.05 seconds
2017-04-19 21:43:13,672: executing node model.shippo_test.shopify_orders_base
2017-04-19 21:43:13,673: Using redshift connection "shopify_orders_base".
2017-04-19 21:43:13,674: On shopify_orders_base: -- Compiled by DBT

    

    create view "analytics"."shopify_orders_base__dbt_tmp" as (
        select
  -- ids
  id,
  customer__id,
  checkout_id,
  cart_token,
  checkout_token,
  token,

  -- logical ids reported in the application
  "number",
  order_number,

  -- state
  financial_status,
  fulfillment_status,
  confirmed,

  -- cancellation information
  cancel_reason,
  cancelled_at,

  -- etc
  closed_at,
  processed_at,
  email,
  contact_email,
  name,
  note,
  tags,

  -- attribution
  browser_ip,
  source_name,
  landing_site,
  null::varchar as landing_site_ref,
  referring_site,

  -- financial
  currency,
  processing_method,

  -- numbers
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_price_usd,
  total_tax,
  total_weight,

  -- point of sale info
  user_id,
  location_id,

  -- address
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,

  -- audit
  created_at,
  updated_at,
  test

from
  shippo_chooze_shopify.orders
    );

    
2017-04-19 21:43:13,965: Using redshift connection "shopify_discount_codes".
2017-04-19 21:43:13,965: On shopify_discount_codes: BEGIN
2017-04-19 21:43:13,986: SQL status: CREATE VIEW in 0.31 seconds
2017-04-19 21:43:14,029: SQL status: BEGIN in 0.06 seconds
2017-04-19 21:43:14,029: Using redshift connection "shopify_discount_codes".
2017-04-19 21:43:14,029: On shopify_discount_codes: alter table "analytics"."shopify_discount_codes__dbt_tmp" rename to "shopify_discount_codes"
2017-04-19 21:43:14,030: On shopify_products: COMMIT
2017-04-19 21:43:14,061: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 21:43:14,061: On shopify_discount_codes: COMMIT
2017-04-19 21:43:14,868: Using redshift connection "shopify_products".
2017-04-19 21:43:14,869: On shopify_products: BEGIN
2017-04-19 21:43:14,906: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:14,907: Using redshift connection "shopify_products".
2017-04-19 21:43:14,907: On shopify_products: drop view if exists "analytics"."shopify_products" cascade
2017-04-19 21:43:15,047: SQL status: DROP VIEW in 0.14 seconds
2017-04-19 21:43:15,047: On shopify_products: COMMIT
2017-04-19 21:43:15,307: 21:43:15 | 7 of 14 OK created view model analytics.shopify_discount_codes....... [CREATE VIEW in 8.22s]
2017-04-19 21:43:15,308: 21:43:15 | 11 of 14 START view model analytics.shopify_checkouts................ [RUN]
2017-04-19 21:43:15,308: Compiling model.shopify.shopify_checkouts
2017-04-19 21:43:15,310: Acquiring new redshift connection "shopify_checkouts".
2017-04-19 21:43:15,310: Re-using an available connection from the pool.
2017-04-19 21:43:15,310: Using redshift connection "shopify_checkouts".
2017-04-19 21:43:15,310: On shopify_checkouts: BEGIN
2017-04-19 21:43:15,311: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d04cf8>]}
2017-04-19 21:43:15,380: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:15,381: Using redshift connection "shopify_checkouts".
2017-04-19 21:43:15,381: On shopify_checkouts: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:15,418: Using redshift connection "shopify_products".
2017-04-19 21:43:15,418: On shopify_products: BEGIN
2017-04-19 21:43:15,459: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:15,459: Using redshift connection "shopify_products".
2017-04-19 21:43:15,460: On shopify_products: alter table "analytics"."shopify_products__dbt_tmp" rename to "shopify_products"
2017-04-19 21:43:15,460: On shopify_refunds: COMMIT
2017-04-19 21:43:15,464: SQL status: SELECT in 0.08 seconds
2017-04-19 21:43:15,466: executing node model.shopify.shopify_checkouts
2017-04-19 21:43:15,467: Using redshift connection "shopify_checkouts".
2017-04-19 21:43:15,467: On shopify_checkouts: -- Compiled by DBT

    

    create view "analytics"."shopify_checkouts__dbt_tmp" as (
        select
  id,
  customer__id as customer_id,
  email,
  nullif(cart_token, '') as cart_token,
  nullif(token, '') as token,
  abandoned_checkout_url,
  name,
  completed_at,
  currency,
  gateway,
  landing_site,
  note,
  source_name,
  referring_site,
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_tax,
  total_weight,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  updated_at,
  created_at
from
  shippo_chooze_shopify.checkouts
    );

    
2017-04-19 21:43:15,484: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:43:15,484: On shopify_products: COMMIT
2017-04-19 21:43:16,078: SQL status: CREATE VIEW in 0.61 seconds
2017-04-19 21:43:16,317: Using redshift connection "shopify_refunds".
2017-04-19 21:43:16,317: On shopify_refunds: BEGIN
2017-04-19 21:43:16,402: SQL status: BEGIN in 0.08 seconds
2017-04-19 21:43:16,403: Using redshift connection "shopify_refunds".
2017-04-19 21:43:16,403: On shopify_refunds: drop view if exists "analytics"."shopify_refunds" cascade
2017-04-19 21:43:16,620: SQL status: DROP VIEW in 0.22 seconds
2017-04-19 21:43:16,620: On shopify_refunds: COMMIT
2017-04-19 21:43:16,679: 21:43:16 | 8 of 14 OK created view model analytics.shopify_products............. [CREATE VIEW in 7.99s]
2017-04-19 21:43:16,679: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e42b0>]}
2017-04-19 21:43:16,960: Using redshift connection "shopify_refunds".
2017-04-19 21:43:16,960: On shopify_refunds: BEGIN
2017-04-19 21:43:17,048: SQL status: BEGIN in 0.09 seconds
2017-04-19 21:43:17,048: Using redshift connection "shopify_refunds".
2017-04-19 21:43:17,048: On shopify_refunds: alter table "analytics"."shopify_refunds__dbt_tmp" rename to "shopify_refunds"
2017-04-19 21:43:17,048: On shopify_orders_base: COMMIT
2017-04-19 21:43:17,091: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:43:17,091: On shopify_refunds: COMMIT
2017-04-19 21:43:17,597: Using redshift connection "shopify_orders_base".
2017-04-19 21:43:17,598: On shopify_orders_base: BEGIN
2017-04-19 21:43:17,641: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:17,641: Using redshift connection "shopify_orders_base".
2017-04-19 21:43:17,641: On shopify_orders_base: drop view if exists "analytics"."shopify_orders_base" cascade
2017-04-19 21:43:18,209: 21:43:18 | 9 of 14 OK created view model analytics.shopify_refunds.............. [CREATE VIEW in 6.45s]
2017-04-19 21:43:18,210: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e4240>]}
2017-04-19 21:43:18,301: SQL status: DROP VIEW in 0.66 seconds
2017-04-19 21:43:18,301: On shopify_orders_base: COMMIT
2017-04-19 21:43:18,682: Using redshift connection "shopify_orders_base".
2017-04-19 21:43:18,682: On shopify_orders_base: BEGIN
2017-04-19 21:43:18,722: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:18,722: Using redshift connection "shopify_orders_base".
2017-04-19 21:43:18,722: On shopify_orders_base: alter table "analytics"."shopify_orders_base__dbt_tmp" rename to "shopify_orders_base"
2017-04-19 21:43:18,722: On shopify_checkouts: COMMIT
2017-04-19 21:43:18,739: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:43:18,739: On shopify_orders_base: COMMIT
2017-04-19 21:43:19,164: Using redshift connection "shopify_checkouts".
2017-04-19 21:43:19,164: On shopify_checkouts: BEGIN
2017-04-19 21:43:19,216: 21:43:19 | 10 of 14 OK created view model analytics.shopify_orders_base......... [CREATE VIEW in 5.64s]
2017-04-19 21:43:19,217: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f77b8>]}
2017-04-19 21:43:19,236: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:19,236: Using redshift connection "shopify_checkouts".
2017-04-19 21:43:19,237: On shopify_checkouts: drop view if exists "analytics"."shopify_checkouts" cascade
2017-04-19 21:43:19,280: SQL status: DROP VIEW in 0.04 seconds
2017-04-19 21:43:19,280: On shopify_checkouts: COMMIT
2017-04-19 21:43:19,681: Using redshift connection "shopify_checkouts".
2017-04-19 21:43:19,681: On shopify_checkouts: BEGIN
2017-04-19 21:43:19,747: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:19,747: Using redshift connection "shopify_checkouts".
2017-04-19 21:43:19,747: On shopify_checkouts: alter table "analytics"."shopify_checkouts__dbt_tmp" rename to "shopify_checkouts"
2017-04-19 21:43:19,793: SQL status: ALTER TABLE in 0.05 seconds
2017-04-19 21:43:19,793: On shopify_checkouts: COMMIT
2017-04-19 21:43:20,074: 21:43:20 | 11 of 14 OK created view model analytics.shopify_checkouts........... [CREATE VIEW in 4.77s]
2017-04-19 21:43:20,074: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d28b00>]}
2017-04-19 21:43:20,178: 21:43:20 | 12 of 14 START view model analytics.shopify_orders................... [RUN]
2017-04-19 21:43:20,178: Compiling model.shopify.shopify_orders
2017-04-19 21:43:20,181: Acquiring new redshift connection "shopify_orders".
2017-04-19 21:43:20,181: Re-using an available connection from the pool.
2017-04-19 21:43:20,181: Using redshift connection "shopify_orders".
2017-04-19 21:43:20,181: On shopify_orders: BEGIN
2017-04-19 21:43:20,181: 21:43:20 | 13 of 14 START view model analytics.shopify_order_items.............. [RUN]
2017-04-19 21:43:20,181: Compiling model.shopify.shopify_order_items
2017-04-19 21:43:20,183: Acquiring new redshift connection "shopify_order_items".
2017-04-19 21:43:20,183: Re-using an available connection from the pool.
2017-04-19 21:43:20,183: Using redshift connection "shopify_order_items".
2017-04-19 21:43:20,183: On shopify_order_items: BEGIN
2017-04-19 21:43:20,219: SQL status: BEGIN in 0.04 seconds
2017-04-19 21:43:20,219: Using redshift connection "shopify_order_items".
2017-04-19 21:43:20,219: On shopify_order_items: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:20,254: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:20,254: Using redshift connection "shopify_orders".
2017-04-19 21:43:20,254: On shopify_orders: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:20,270: SQL status: SELECT in 0.05 seconds
2017-04-19 21:43:20,271: executing node model.shopify.shopify_order_items
2017-04-19 21:43:20,272: Using redshift connection "shopify_order_items".
2017-04-19 21:43:20,272: On shopify_order_items: -- Compiled by DBT

    

    create view "analytics"."shopify_order_items__dbt_tmp" as (
        select

  id,
  product_id,
  _sdc_source_key_id as order_id,
  sku,
  name,
  title,
  vendor,
  quantity,
  pre_tax_price,
  price,
  taxable,
  gift_card,
  total_discount,
  grams

from
  "analytics"."shopify_order_items_base"
    );

    
2017-04-19 21:43:20,334: SQL status: SELECT in 0.08 seconds
2017-04-19 21:43:20,336: executing node model.shopify.shopify_orders
2017-04-19 21:43:20,337: Using redshift connection "shopify_orders".
2017-04-19 21:43:20,337: On shopify_orders: -- Compiled by DBT

    

    create view "analytics"."shopify_orders__dbt_tmp" as (
        -- see shopify docs here:
-- https://help.shopify.com/api/reference/order

select
  -- ids
  id,
  customer__id as customer_id,
  checkout_id,
  nullif(cart_token, '') as cart_token,
  nullif(checkout_token, '') as checkout_token,
  nullif(token, '') as token,

  -- logical ids reported in the application
  "number",
  order_number,

  -- state
  financial_status,
  fulfillment_status,
  confirmed,

  -- cancellation information
  cancel_reason,
  cancelled_at,

  -- etc
  closed_at,
  processed_at,
  email,
  contact_email,
  name,
  note,
  tags,

  -- attribution
  browser_ip,
  source_name,
  landing_site,
  landing_site_ref,
  referring_site,

  -- financial
  currency,
  processing_method,

  -- numbers
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_price_usd,
  total_tax,
  total_weight,

  -- point of sale info
  user_id,
  location_id,

  -- address
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,

  -- audit
  created_at,
  updated_at

from
  "analytics"."shopify_orders_base"

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 21:43:20,444: SQL status: CREATE VIEW in 0.17 seconds
2017-04-19 21:43:20,444: Using redshift connection "shopify_order_items".
2017-04-19 21:43:20,444: On shopify_order_items: alter table "analytics"."shopify_order_items__dbt_tmp" rename to "shopify_order_items"
2017-04-19 21:43:20,465: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 21:43:20,466: On shopify_order_items: COMMIT
2017-04-19 21:43:20,493: SQL status: CREATE VIEW in 0.16 seconds
2017-04-19 21:43:20,493: On shopify_orders: COMMIT
2017-04-19 21:43:20,968: 21:43:20 | 13 of 14 OK created view model analytics.shopify_order_items......... [CREATE VIEW in 0.79s]
2017-04-19 21:43:20,969: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de6048>]}
2017-04-19 21:43:21,433: Using redshift connection "shopify_orders".
2017-04-19 21:43:21,433: On shopify_orders: BEGIN
2017-04-19 21:43:21,503: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:21,504: Using redshift connection "shopify_orders".
2017-04-19 21:43:21,504: On shopify_orders: drop view if exists "analytics"."shopify_orders" cascade
2017-04-19 21:43:21,539: SQL status: DROP VIEW in 0.04 seconds
2017-04-19 21:43:21,539: On shopify_orders: COMMIT
2017-04-19 21:43:21,792: Using redshift connection "shopify_orders".
2017-04-19 21:43:21,792: On shopify_orders: BEGIN
2017-04-19 21:43:21,858: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:21,858: Using redshift connection "shopify_orders".
2017-04-19 21:43:21,859: On shopify_orders: alter table "analytics"."shopify_orders__dbt_tmp" rename to "shopify_orders"
2017-04-19 21:43:21,893: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 21:43:21,893: On shopify_orders: COMMIT
2017-04-19 21:43:22,175: 21:43:22 | 12 of 14 OK created view model analytics.shopify_orders.............. [CREATE VIEW in 2.00s]
2017-04-19 21:43:22,176: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106406f60>]}
2017-04-19 21:43:22,329: 21:43:22 | 14 of 14 START view model analytics.shopify_orders_xf................ [RUN]
2017-04-19 21:43:22,329: Compiling model.shopify.shopify_orders_xf
2017-04-19 21:43:22,331: Acquiring new redshift connection "shopify_orders_xf".
2017-04-19 21:43:22,331: Re-using an available connection from the pool.
2017-04-19 21:43:22,331: Using redshift connection "shopify_orders_xf".
2017-04-19 21:43:22,331: On shopify_orders_xf: BEGIN
2017-04-19 21:43:22,394: SQL status: BEGIN in 0.06 seconds
2017-04-19 21:43:22,394: Using redshift connection "shopify_orders_xf".
2017-04-19 21:43:22,394: On shopify_orders_xf: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 21:43:22,475: SQL status: SELECT in 0.08 seconds
2017-04-19 21:43:22,476: executing node model.shopify.shopify_orders_xf
2017-04-19 21:43:22,477: Using redshift connection "shopify_orders_xf".
2017-04-19 21:43:22,477: On shopify_orders_xf: -- Compiled by DBT

    

    create view "analytics"."shopify_orders_xf__dbt_tmp" as (
        

with orders as (

  select * from "analytics"."shopify_orders"

)

select
  *,
  row_number() over (partition by customer_id order by created_at) as order_seq_number,
  case
    when row_number() over (partition by customer_id order by created_at) = 1 then 'new'
    else 'repeat'
  end as new_vs_repeat,
  case
    when cancelled_at is not null then true
    else false
  end as cancelled
from orders
    );

    
2017-04-19 21:43:22,554: SQL status: CREATE VIEW in 0.08 seconds
2017-04-19 21:43:22,554: On shopify_orders_xf: COMMIT
2017-04-19 21:43:23,075: Using redshift connection "shopify_orders_xf".
2017-04-19 21:43:23,075: On shopify_orders_xf: BEGIN
2017-04-19 21:43:23,148: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:23,148: Using redshift connection "shopify_orders_xf".
2017-04-19 21:43:23,148: On shopify_orders_xf: drop view if exists "analytics"."shopify_orders_xf" cascade
2017-04-19 21:43:23,183: SQL status: DROP VIEW in 0.03 seconds
2017-04-19 21:43:23,183: On shopify_orders_xf: COMMIT
2017-04-19 21:43:23,393: Using redshift connection "shopify_orders_xf".
2017-04-19 21:43:23,393: On shopify_orders_xf: BEGIN
2017-04-19 21:43:23,459: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:23,460: Using redshift connection "shopify_orders_xf".
2017-04-19 21:43:23,460: On shopify_orders_xf: alter table "analytics"."shopify_orders_xf__dbt_tmp" rename to "shopify_orders_xf"
2017-04-19 21:43:23,499: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 21:43:23,499: On shopify_orders_xf: COMMIT
2017-04-19 21:43:23,854: 21:43:23 | 14 of 14 OK created view model analytics.shopify_orders_xf........... [CREATE VIEW in 1.52s]
2017-04-19 21:43:23,854: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16875fa1-3c73-4f9a-9754-aeabf4fd40e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d28b00>]}
2017-04-19 21:43:24,087: Using redshift connection "master".
2017-04-19 21:43:24,087: On master: BEGIN
2017-04-19 21:43:24,155: SQL status: BEGIN in 0.07 seconds
2017-04-19 21:43:24,156: On master: COMMIT
2017-04-19 21:43:24,185: 21:43:24 | 
2017-04-19 21:43:24,185: 21:43:24 | Finished running 14 view models in 21.60s.
2017-04-19 21:43:24,185: Connection 'master' was left open.
2017-04-19 21:43:24,186: Done. PASS=14 ERROR=0 SKIP=0 TOTAL=14
2017-04-19 21:43:24,186: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f77b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f7f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106406f60>]}
2017-04-19 21:43:24,346: Flushing usage events
2017-04-19 22:19:15,093: Tracking: tracking
2017-04-19 22:19:15,099: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f8a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f8a58>]}
2017-04-19 22:19:15,419: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 22:19:15,465: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 22:19:15,510: Parsing materializations/incremental.sql
2017-04-19 22:19:15,525: Parsing materializations/table.sql
2017-04-19 22:19:15,532: Parsing materializations/view.sql
2017-04-19 22:19:15,536: Parsing materializations/wrapper.sql
2017-04-19 22:19:15,538: Parsing schema_tests/accepted_values.sql
2017-04-19 22:19:15,540: Parsing schema_tests/not_null.sql
2017-04-19 22:19:15,542: Parsing schema_tests/relationships.sql
2017-04-19 22:19:15,543: Parsing schema_tests/unique.sql
2017-04-19 22:19:15,548: Parsing model.shippo_test.shippo_addresses
2017-04-19 22:19:15,550: Parsing model.shippo_test.shippo_parcels
2017-04-19 22:19:15,551: Parsing model.shippo_test.shippo_shipments
2017-04-19 22:19:15,552: Parsing model.shippo_test.shopify_order_items_base
2017-04-19 22:19:15,553: Parsing model.shippo_test.shopify_orders_base
2017-04-19 22:19:15,559: Parsing model.shopify.shopify_checkouts
2017-04-19 22:19:15,560: Parsing model.shopify.shopify_customers
2017-04-19 22:19:15,562: Parsing model.shopify.shopify_discount_codes
2017-04-19 22:19:15,563: Parsing model.shopify.shopify_order_items
2017-04-19 22:19:15,564: Parsing model.shopify.shopify_orders
2017-04-19 22:19:15,566: Parsing model.shopify.shopify_products
2017-04-19 22:19:15,568: Parsing model.shopify.shopify_refunds
2017-04-19 22:19:15,569: Parsing model.shopify.shopify_transactions
2017-04-19 22:19:15,570: Parsing model.shopify.shopify_orders_xf
2017-04-19 22:19:15,583: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 22:19:15,584: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 22:19:15,585: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 22:19:15,586: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 22:19:15,587: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 22:19:15,589: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 22:19:15,590: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 22:19:15,591: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 22:19:15,592: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 22:19:15,593: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 22:19:15,594: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 22:19:15,596: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 22:19:15,597: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 22:19:15,600: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 22:19:15,602: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 22:19:15,604: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 22:19:15,605: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 22:19:15,607: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 22:19:15,608: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 22:19:15,610: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 22:19:15,622: Parsing test.shopify.unique_shopify_orders_cart_token
2017-04-19 22:19:15,624: Parsing test.shopify.unique_shopify_orders_id
2017-04-19 22:19:15,625: Parsing test.shopify.not_null_shopify_orders_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 22:19:15,626: Parsing test.shopify.not_null_shopify_orders_id
2017-04-19 22:19:15,627: Parsing test.shopify.relationships_shopify_orders_id__customer_id__shopify_customers
2017-04-19 22:19:15,628: Parsing test.shopify.unique_shopify_checkouts_cart_token
2017-04-19 22:19:15,630: Parsing test.shopify.unique_shopify_checkouts_id
2017-04-19 22:19:15,631: Parsing test.shopify.not_null_shopify_checkouts_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 22:19:15,632: Parsing test.shopify.not_null_shopify_checkouts_id
2017-04-19 22:19:15,633: Parsing test.shopify.relationships_shopify_checkouts_id__customer_id__shopify_customers
2017-04-19 22:19:15,635: Parsing test.shopify.unique_shopify_customers_id
2017-04-19 22:19:15,636: Parsing test.shopify.not_null_shopify_customers_id
2017-04-19 22:19:15,637: Parsing test.shopify.not_null_shopify_discount_codes_order_id
2017-04-19 22:19:15,638: Parsing test.shopify.relationships_shopify_discount_codes_id__order_id__shopify_orders
2017-04-19 22:19:15,640: Parsing test.shopify.not_null_shopify_transactions_id
2017-04-19 22:19:15,641: Parsing test.shopify.not_null_shopify_transactions_order_id
2017-04-19 22:19:15,642: Parsing test.shopify.unique_shopify_transactions_id
2017-04-19 22:19:15,643: Parsing test.shopify.relationships_shopify_transactions_id__order_id__shopify_orders
2017-04-19 22:19:15,645: Parsing test.shopify.not_null_shopify_refunds_id
2017-04-19 22:19:15,646: Parsing test.shopify.not_null_shopify_refunds_order_id
2017-04-19 22:19:15,647: Parsing test.shopify.unique_shopify_refunds_id
2017-04-19 22:19:15,648: Parsing test.shopify.relationships_shopify_refunds_id__order_id__shopify_orders
2017-04-19 22:19:15,649: Parsing test.shopify.not_null_shopify_products_id
2017-04-19 22:19:15,651: Parsing test.shopify.unique_shopify_products_id
2017-04-19 22:19:15,652: Parsing test.shopify.not_null_shopify_order_items_id
2017-04-19 22:19:15,654: Parsing test.shopify.not_null_shopify_order_items_order_id
2017-04-19 22:19:15,655: Parsing test.shopify.unique_shopify_order_items_id
2017-04-19 22:19:15,656: Parsing test.shopify.relationships_shopify_order_items_id__order_id__shopify_orders
2017-04-19 22:19:15,657: Parsing test.shopify.relationships_shopify_order_items_id__product_id__shopify_products
2017-04-19 22:19:15,660: Compiled 14 models, 49 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 22:19:15,664: Acquiring new redshift connection "master".
2017-04-19 22:19:15,664: Opening a new connection (0 currently allocated)
2017-04-19 22:19:15,845: Using redshift connection "master".
2017-04-19 22:19:15,845: On master: BEGIN
2017-04-19 22:19:15,889: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:19:15,889: Creating schema "analytics".
2017-04-19 22:19:15,889: Using redshift connection "master".
2017-04-19 22:19:15,889: On master: create schema if not exists "analytics"
2017-04-19 22:19:15,908: SQL status: CREATE SCHEMA in 0.02 seconds
2017-04-19 22:19:15,908: On master: COMMIT
2017-04-19 22:19:16,322: Concurrency: 4 threads (target='only')
2017-04-19 22:19:16,322: Using redshift connection "master".
2017-04-19 22:19:16,323: On master: BEGIN
2017-04-19 22:19:16,362: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:19:16,363: Using redshift connection "master".
2017-04-19 22:19:16,363: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:16,406: SQL status: SELECT in 0.04 seconds
2017-04-19 22:19:16,406: On master: COMMIT
2017-04-19 22:19:16,430: 
2017-04-19 22:19:16,430: 22:19:16 | Running 12 view models, 2 ephemeral models
2017-04-19 22:19:16,430: 22:19:16 | 
2017-04-19 22:19:16,430: Using redshift connection "master".
2017-04-19 22:19:16,430: On master: BEGIN
2017-04-19 22:19:16,471: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:19:16,471: On master: COMMIT
2017-04-19 22:19:16,520: Compiling model.shippo_test.shopify_orders_base
2017-04-19 22:19:16,520: 22:19:16 | 1 of 12 START view model analytics.shopify_products.................. [RUN]
2017-04-19 22:19:16,520: 22:19:16 | 2 of 12 START view model analytics.shippo_shipments.................. [RUN]
2017-04-19 22:19:16,523: Compiling model.shopify.shopify_products
2017-04-19 22:19:16,523: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c557e10>]}
2017-04-19 22:19:16,520: 22:19:16 | 3 of 12 START view model analytics.shopify_discount_codes............ [RUN]
2017-04-19 22:19:16,523: Compiling model.shippo_test.shippo_shipments
2017-04-19 22:19:16,522: 22:19:16 | 4 of 12 START view model analytics.shopify_checkouts................. [RUN]
2017-04-19 22:19:16,525: Acquiring new redshift connection "shopify_products".
2017-04-19 22:19:16,525: Compiling model.shopify.shopify_discount_codes
2017-04-19 22:19:16,528: Acquiring new redshift connection "shippo_shipments".
2017-04-19 22:19:16,528: Compiling model.shopify.shopify_checkouts
2017-04-19 22:19:16,529: Opening a new connection (1 currently allocated)
2017-04-19 22:19:16,531: Acquiring new redshift connection "shopify_discount_codes".
2017-04-19 22:19:16,533: Acquiring new redshift connection "shopify_checkouts".
2017-04-19 22:19:16,841: Using redshift connection "shopify_products".
2017-04-19 22:19:16,841: On shopify_products: BEGIN
2017-04-19 22:19:16,842: Opening a new connection (2 currently allocated)
2017-04-19 22:19:16,911: SQL status: BEGIN in 0.07 seconds
2017-04-19 22:19:16,911: Using redshift connection "shopify_products".
2017-04-19 22:19:16,911: On shopify_products: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:16,966: SQL status: SELECT in 0.05 seconds
2017-04-19 22:19:16,968: executing node model.shopify.shopify_products
2017-04-19 22:19:16,969: Using redshift connection "shopify_products".
2017-04-19 22:19:16,969: On shopify_products: -- Compiled by DBT

    

    create view "analytics"."shopify_products__dbt_tmp" as (
        select

  id,
  title,
  product_type,
  vendor,
  tags,
  handle,
  published_at,
  created_at,
  updated_at

from
  shippo_chooze_shopify.products
    );

    
2017-04-19 22:19:16,997: Using redshift connection "shippo_shipments".
2017-04-19 22:19:16,997: On shippo_shipments: BEGIN
2017-04-19 22:19:16,997: Opening a new connection (3 currently allocated)
2017-04-19 22:19:17,022: SQL status: CREATE VIEW in 0.05 seconds
2017-04-19 22:19:17,023: Using redshift connection "shopify_products".
2017-04-19 22:19:17,023: On shopify_products: alter table "analytics"."shopify_products__dbt_tmp" rename to "shopify_products"
2017-04-19 22:19:17,042: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:19:17,042: Using redshift connection "shippo_shipments".
2017-04-19 22:19:17,042: On shippo_shipments: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:17,054: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 22:19:17,054: On shopify_products: COMMIT
2017-04-19 22:19:17,077: SQL status: SELECT in 0.03 seconds
2017-04-19 22:19:17,078: executing node model.shippo_test.shippo_shipments
2017-04-19 22:19:17,079: Using redshift connection "shippo_shipments".
2017-04-19 22:19:17,079: On shippo_shipments: -- Compiled by DBT

    

    create view "analytics"."shippo_shipments__dbt_tmp" as (
        select

    object_id as id,

    address_from as address_from_id,
    address_return as address_return_id,
    address_to as address_to_id,
    parcel as parcel_id,

    insurance_amount::float,
    insurance_currency,

    rates_url,
    return_of,
    submission_date,
    lower(submission_type) as submission_type,
    customs_declaration,


    object_owner as owner,
    lower(object_state) as state,
    lower(object_purpose) as purpose,
    lower(object_status) as status,


    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments
    );

    
2017-04-19 22:19:17,200: Using redshift connection "shopify_discount_codes".
2017-04-19 22:19:17,200: On shopify_discount_codes: BEGIN
2017-04-19 22:19:17,200: Opening a new connection (4 currently allocated)
2017-04-19 22:19:17,245: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:19:17,246: Using redshift connection "shopify_discount_codes".
2017-04-19 22:19:17,246: On shopify_discount_codes: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:17,286: SQL status: SELECT in 0.04 seconds
2017-04-19 22:19:17,288: executing node model.shopify.shopify_discount_codes
2017-04-19 22:19:17,289: Using redshift connection "shopify_discount_codes".
2017-04-19 22:19:17,289: On shopify_discount_codes: -- Compiled by DBT

    

    create view "analytics"."shopify_discount_codes__dbt_tmp" as (
        select

  _sdc_source_key_id as order_id,
  code,
  amount,
  type

from
  shippo_chooze_shopify.orders__discount_codes
    );

    
2017-04-19 22:19:17,394: SQL status: CREATE VIEW in 0.31 seconds
2017-04-19 22:19:17,395: Using redshift connection "shippo_shipments".
2017-04-19 22:19:17,395: On shippo_shipments: alter table "analytics"."shippo_shipments__dbt_tmp" rename to "shippo_shipments"
2017-04-19 22:19:17,418: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 22:19:17,418: On shippo_shipments: COMMIT
2017-04-19 22:19:17,529: Using redshift connection "shopify_checkouts".
2017-04-19 22:19:17,529: On shopify_checkouts: BEGIN
2017-04-19 22:19:17,601: SQL status: BEGIN in 0.07 seconds
2017-04-19 22:19:17,601: Using redshift connection "shopify_checkouts".
2017-04-19 22:19:17,601: On shopify_checkouts: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:17,657: SQL status: SELECT in 0.06 seconds
2017-04-19 22:19:17,659: executing node model.shopify.shopify_checkouts
2017-04-19 22:19:17,661: Using redshift connection "shopify_checkouts".
2017-04-19 22:19:17,661: On shopify_checkouts: -- Compiled by DBT

    

    create view "analytics"."shopify_checkouts__dbt_tmp" as (
        select
  id,
  customer__id as customer_id,
  email,
  nullif(cart_token, '') as cart_token,
  nullif(token, '') as token,
  abandoned_checkout_url,
  name,
  completed_at,
  currency,
  gateway,
  landing_site,
  note,
  source_name,
  referring_site,
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_tax,
  total_weight,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  updated_at,
  created_at
from
  shippo_chooze_shopify.checkouts
    );

    
2017-04-19 22:19:17,664: SQL status: CREATE VIEW in 0.38 seconds
2017-04-19 22:19:17,665: Using redshift connection "shopify_discount_codes".
2017-04-19 22:19:17,665: On shopify_discount_codes: alter table "analytics"."shopify_discount_codes__dbt_tmp" rename to "shopify_discount_codes"
2017-04-19 22:19:17,755: 22:19:17 | 1 of 12 OK created view model analytics.shopify_products............. [CREATE VIEW in 1.23s]
2017-04-19 22:19:17,755: Compiling model.shippo_test.shopify_order_items_base
2017-04-19 22:19:17,757: 22:19:17 | 5 of 12 START view model analytics.shopify_transactions.............. [RUN]
2017-04-19 22:19:17,757: Compiling model.shopify.shopify_transactions
2017-04-19 22:19:17,759: Acquiring new redshift connection "shopify_transactions".
2017-04-19 22:19:17,760: Re-using an available connection from the pool.
2017-04-19 22:19:17,760: Using redshift connection "shopify_transactions".
2017-04-19 22:19:17,760: On shopify_transactions: BEGIN
2017-04-19 22:19:17,760: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf102b0>]}
2017-04-19 22:19:17,784: SQL status: ALTER TABLE in 0.12 seconds
2017-04-19 22:19:17,784: On shopify_discount_codes: COMMIT
2017-04-19 22:19:17,828: SQL status: BEGIN in 0.07 seconds
2017-04-19 22:19:17,828: Using redshift connection "shopify_transactions".
2017-04-19 22:19:17,828: On shopify_transactions: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:17,870: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbdb898>]}
2017-04-19 22:19:17,880: SQL status: SELECT in 0.05 seconds
2017-04-19 22:19:17,882: executing node model.shopify.shopify_transactions
2017-04-19 22:19:17,883: Using redshift connection "shopify_transactions".
2017-04-19 22:19:17,883: On shopify_transactions: -- Compiled by DBT

    

    create view "analytics"."shopify_transactions__dbt_tmp" as (
        select

  id,
  parent_id,
  order_id,

  status,
  error_code,
  message,

  kind,
  amount,
  "authorization",
  currency,
  gateway,

  source_name,

  created_at

from
  shippo_chooze_shopify.transactions

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 22:19:18,144: 22:19:18 | 2 of 12 OK created view model analytics.shippo_shipments............. [CREATE VIEW in 1.62s]
2017-04-19 22:19:18,144: 22:19:18 | 6 of 12 START view model analytics.shopify_customers................. [RUN]
2017-04-19 22:19:18,144: Compiling model.shopify.shopify_customers
2017-04-19 22:19:18,147: Acquiring new redshift connection "shopify_customers".
2017-04-19 22:19:18,147: Re-using an available connection from the pool.
2017-04-19 22:19:18,147: Using redshift connection "shopify_customers".
2017-04-19 22:19:18,147: On shopify_customers: BEGIN
2017-04-19 22:19:18,147: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf10780>]}
2017-04-19 22:19:18,192: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:19:18,192: Using redshift connection "shopify_customers".
2017-04-19 22:19:18,192: On shopify_customers: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:18,311: SQL status: SELECT in 0.12 seconds
2017-04-19 22:19:18,312: executing node model.shopify.shopify_customers
2017-04-19 22:19:18,313: Using redshift connection "shopify_customers".
2017-04-19 22:19:18,313: On shopify_customers: -- Compiled by DBT

    

    create view "analytics"."shopify_customers__dbt_tmp" as (
        select
  id,
  first_name,
  last_name,
  email,
  verified_email,
  default_address__id as default_address_id,
  note,
  state,
  tags,
  tax_exempt,
  created_at,
  updated_at
from
  shippo_chooze_shopify.customers
    );

    
2017-04-19 22:19:18,733: SQL status: CREATE VIEW in 1.07 seconds
2017-04-19 22:19:18,734: Using redshift connection "shopify_checkouts".
2017-04-19 22:19:18,734: On shopify_checkouts: alter table "analytics"."shopify_checkouts__dbt_tmp" rename to "shopify_checkouts"
2017-04-19 22:19:18,771: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 22:19:18,771: On shopify_checkouts: COMMIT
2017-04-19 22:19:18,878: SQL status: CREATE VIEW in 0.56 seconds
2017-04-19 22:19:18,878: Using redshift connection "shopify_customers".
2017-04-19 22:19:18,878: On shopify_customers: alter table "analytics"."shopify_customers__dbt_tmp" rename to "shopify_customers"
2017-04-19 22:19:18,894: SQL status: CREATE VIEW in 1.01 seconds
2017-04-19 22:19:18,895: Using redshift connection "shopify_transactions".
2017-04-19 22:19:18,895: On shopify_transactions: alter table "analytics"."shopify_transactions__dbt_tmp" rename to "shopify_transactions"
2017-04-19 22:19:18,901: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 22:19:18,901: On shopify_customers: COMMIT
2017-04-19 22:19:18,933: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 22:19:18,933: On shopify_transactions: COMMIT
2017-04-19 22:19:18,934: 22:19:18 | 3 of 12 OK created view model analytics.shopify_discount_codes....... [CREATE VIEW in 2.41s]
2017-04-19 22:19:18,935: 22:19:18 | 7 of 12 START view model analytics.shopify_refunds................... [RUN]
2017-04-19 22:19:18,935: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf10780>]}
2017-04-19 22:19:18,935: Compiling model.shopify.shopify_refunds
2017-04-19 22:19:18,939: Acquiring new redshift connection "shopify_refunds".
2017-04-19 22:19:18,939: Re-using an available connection from the pool.
2017-04-19 22:19:18,939: Using redshift connection "shopify_refunds".
2017-04-19 22:19:18,939: On shopify_refunds: BEGIN
2017-04-19 22:19:18,980: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:19:18,980: Using redshift connection "shopify_refunds".
2017-04-19 22:19:18,980: On shopify_refunds: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:19,020: SQL status: SELECT in 0.04 seconds
2017-04-19 22:19:19,021: executing node model.shopify.shopify_refunds
2017-04-19 22:19:19,022: Using redshift connection "shopify_refunds".
2017-04-19 22:19:19,022: On shopify_refunds: -- Compiled by DBT

    

    create view "analytics"."shopify_refunds__dbt_tmp" as (
        select

  id,
  order_id,
  user_id,
  restock,
  note,
  created_at

from
  shippo_chooze_shopify.order_refunds
    );

    
2017-04-19 22:19:19,599: SQL status: CREATE VIEW in 0.58 seconds
2017-04-19 22:19:19,599: Using redshift connection "shopify_refunds".
2017-04-19 22:19:19,599: On shopify_refunds: alter table "analytics"."shopify_refunds__dbt_tmp" rename to "shopify_refunds"
2017-04-19 22:19:19,906: SQL status: ALTER TABLE in 0.31 seconds
2017-04-19 22:19:19,906: On shopify_refunds: COMMIT
2017-04-19 22:19:19,969: 22:19:19 | 4 of 12 OK created view model analytics.shopify_checkouts............ [CREATE VIEW in 3.45s]
2017-04-19 22:19:19,969: 22:19:19 | 8 of 12 START view model analytics.shippo_parcels.................... [RUN]
2017-04-19 22:19:19,969: Compiling model.shippo_test.shippo_parcels
2017-04-19 22:19:19,972: Acquiring new redshift connection "shippo_parcels".
2017-04-19 22:19:19,972: Re-using an available connection from the pool.
2017-04-19 22:19:19,972: Using redshift connection "shippo_parcels".
2017-04-19 22:19:19,972: On shippo_parcels: BEGIN
2017-04-19 22:19:19,972: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c552fd0>]}
2017-04-19 22:19:20,041: SQL status: BEGIN in 0.07 seconds
2017-04-19 22:19:20,041: Using redshift connection "shippo_parcels".
2017-04-19 22:19:20,041: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:20,095: SQL status: SELECT in 0.05 seconds
2017-04-19 22:19:20,097: executing node model.shippo_test.shippo_parcels
2017-04-19 22:19:20,097: Using redshift connection "shippo_parcels".
2017-04-19 22:19:20,097: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 22:19:20,520: SQL status: CREATE VIEW in 0.42 seconds
2017-04-19 22:19:20,521: Using redshift connection "shippo_parcels".
2017-04-19 22:19:20,521: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 22:19:20,553: 22:19:20 | 6 of 12 OK created view model analytics.shopify_customers............ [CREATE VIEW in 2.41s]
2017-04-19 22:19:20,554: 22:19:20 | 9 of 12 START view model analytics.shippo_addresses.................. [RUN]
2017-04-19 22:19:20,554: Compiling model.shippo_test.shippo_addresses
2017-04-19 22:19:20,557: Acquiring new redshift connection "shippo_addresses".
2017-04-19 22:19:20,557: Re-using an available connection from the pool.
2017-04-19 22:19:20,557: Using redshift connection "shippo_addresses".
2017-04-19 22:19:20,557: On shippo_addresses: BEGIN
2017-04-19 22:19:20,557: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c552fd0>]}
2017-04-19 22:19:20,600: SQL status: ALTER TABLE in 0.08 seconds
2017-04-19 22:19:20,601: On shippo_parcels: COMMIT
2017-04-19 22:19:20,605: SQL status: BEGIN in 0.05 seconds
2017-04-19 22:19:20,605: Using redshift connection "shippo_addresses".
2017-04-19 22:19:20,605: On shippo_addresses: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:20,641: SQL status: SELECT in 0.04 seconds
2017-04-19 22:19:20,643: executing node model.shippo_test.shippo_addresses
2017-04-19 22:19:20,644: Using redshift connection "shippo_addresses".
2017-04-19 22:19:20,644: On shippo_addresses: -- Compiled by DBT

    

    create view "analytics"."shippo_addresses__dbt_tmp" as (
        select

    object_id as id,

    name,
    company,

    street1,
    street2,
    street3,
    street_no,

    city,
    state,
    zip,
    country,

    email,
    phone,

    is_residential,

    object_owner as owner,
    lower(object_purpose) as purpose,
    lower(object_source) as source,
    lower(object_state) as object_state,

    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.addresses
    );

    
2017-04-19 22:19:20,807: 22:19:20 | 5 of 12 OK created view model analytics.shopify_transactions......... [CREATE VIEW in 3.05s]
2017-04-19 22:19:20,808: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c434eb8>]}
2017-04-19 22:19:21,237: 22:19:21 | 7 of 12 OK created view model analytics.shopify_refunds.............. [CREATE VIEW in 2.30s]
2017-04-19 22:19:21,238: SQL status: CREATE VIEW in 0.59 seconds
2017-04-19 22:19:21,238: Using redshift connection "shippo_addresses".
2017-04-19 22:19:21,238: On shippo_addresses: alter table "analytics"."shippo_addresses__dbt_tmp" rename to "shippo_addresses"
2017-04-19 22:19:21,238: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfb4b38>]}
2017-04-19 22:19:21,255: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 22:19:21,255: On shippo_addresses: COMMIT
2017-04-19 22:19:21,949: 22:19:21 | 8 of 12 OK created view model analytics.shippo_parcels............... [CREATE VIEW in 1.98s]
2017-04-19 22:19:21,949: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbdb400>]}
2017-04-19 22:19:22,036: 22:19:22 | 9 of 12 OK created view model analytics.shippo_addresses............. [CREATE VIEW in 1.48s]
2017-04-19 22:19:22,105: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdcce80>]}
2017-04-19 22:19:22,267: 22:19:22 | 10 of 12 START view model analytics.shopify_order_items.............. [RUN]
2017-04-19 22:19:22,267: 22:19:22 | 11 of 12 START view model analytics.shopify_orders................... [RUN]
2017-04-19 22:19:22,267: Compiling model.shopify.shopify_order_items
2017-04-19 22:19:22,267: Compiling model.shopify.shopify_orders
2017-04-19 22:19:22,284: Acquiring new redshift connection "shopify_order_items".
2017-04-19 22:19:22,284: Re-using an available connection from the pool.
2017-04-19 22:19:22,284: Using redshift connection "shopify_order_items".
2017-04-19 22:19:22,284: On shopify_order_items: BEGIN
2017-04-19 22:19:22,300: Acquiring new redshift connection "shopify_orders".
2017-04-19 22:19:22,300: Re-using an available connection from the pool.
2017-04-19 22:19:22,300: Using redshift connection "shopify_orders".
2017-04-19 22:19:22,300: On shopify_orders: BEGIN
2017-04-19 22:19:22,321: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:19:22,321: Using redshift connection "shopify_order_items".
2017-04-19 22:19:22,321: On shopify_order_items: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:22,374: SQL status: SELECT in 0.05 seconds
2017-04-19 22:19:22,376: executing node model.shopify.shopify_order_items
2017-04-19 22:19:22,377: Using redshift connection "shopify_order_items".
2017-04-19 22:19:22,377: On shopify_order_items: -- Compiled by DBT

    

    create view "analytics"."shopify_order_items__dbt_tmp" as (
        with __dbt__CTE__shopify_order_items_base as (


select

    id,
    product_id,
    _sdc_source_key_id,
    sku,
    name,
    title,
    vendor,
    quantity,
    null::float as pre_tax_price,
    price,
    taxable,
    gift_card,
    total_discount,
    grams

from
    shippo_chooze_shopify.orders__line_items
)select

  id,
  product_id,
  _sdc_source_key_id as order_id,
  sku,
  name,
  title,
  vendor,
  quantity,
  pre_tax_price,
  price,
  taxable,
  gift_card,
  total_discount,
  grams

from
  __dbt__CTE__shopify_order_items_base
    );

    
2017-04-19 22:19:22,383: SQL status: BEGIN in 0.08 seconds
2017-04-19 22:19:22,384: Using redshift connection "shopify_orders".
2017-04-19 22:19:22,384: On shopify_orders: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:22,477: SQL status: SELECT in 0.09 seconds
2017-04-19 22:19:22,480: executing node model.shopify.shopify_orders
2017-04-19 22:19:22,482: Using redshift connection "shopify_orders".
2017-04-19 22:19:22,482: On shopify_orders: -- Compiled by DBT

    

    create view "analytics"."shopify_orders__dbt_tmp" as (
        with __dbt__CTE__shopify_orders_base as (


select
    -- ids
    id,
    customer__id,
    checkout_id,
    cart_token,
    checkout_token,
    token,

    -- logical ids reported in the application
    "number",
    order_number,

    -- state
    financial_status,
    fulfillment_status,
    confirmed,

    -- cancellation information
    cancel_reason,
    cancelled_at,

    -- etc
    closed_at,
    processed_at,
    email,
    contact_email,
    name,
    note,
    tags,

    -- attribution
    browser_ip,
    source_name,
    landing_site,
    null::varchar as landing_site_ref,
    referring_site,

    -- financial
    currency,
    processing_method,

    -- numbers
    subtotal_price,
    taxes_included,
    total_discounts,
    total_line_items_price,
    total_price,
    total_price_usd,
    total_tax,
    total_weight,

    -- point of sale info
    user_id,
    location_id,

    -- address
    shipping_address__address1,
    shipping_address__address2,
    shipping_address__city,
    shipping_address__company,
    shipping_address__country,
    shipping_address__country_code,
    shipping_address__first_name,
    shipping_address__last_name,
    shipping_address__latitude,
    shipping_address__longitude,
    shipping_address__name,
    shipping_address__phone,
    shipping_address__province,
    shipping_address__province_code,
    shipping_address__zip,
    billing_address__address1,
    billing_address__address2,
    billing_address__city,
    billing_address__company,
    billing_address__country,
    billing_address__country_code,
    billing_address__first_name,
    billing_address__last_name,
    billing_address__latitude,
    billing_address__longitude,
    billing_address__name,
    billing_address__phone,
    billing_address__province,
    billing_address__province_code,
    billing_address__zip,

    -- audit
    created_at,
    updated_at,
    test

from
  shippo_chooze_shopify.orders
)-- see shopify docs here:
-- https://help.shopify.com/api/reference/order

select
  -- ids
  id,
  customer__id as customer_id,
  checkout_id,
  nullif(cart_token, '') as cart_token,
  nullif(checkout_token, '') as checkout_token,
  nullif(token, '') as token,

  -- logical ids reported in the application
  "number",
  order_number,

  -- state
  financial_status,
  fulfillment_status,
  confirmed,

  -- cancellation information
  cancel_reason,
  cancelled_at,

  -- etc
  closed_at,
  processed_at,
  email,
  contact_email,
  name,
  note,
  tags,

  -- attribution
  browser_ip,
  source_name,
  landing_site,
  landing_site_ref,
  referring_site,

  -- financial
  currency,
  processing_method,

  -- numbers
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_price_usd,
  total_tax,
  total_weight,

  -- point of sale info
  user_id,
  location_id,

  -- address
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,

  -- audit
  created_at,
  updated_at

from
  __dbt__CTE__shopify_orders_base

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 22:19:22,663: SQL status: CREATE VIEW in 0.29 seconds
2017-04-19 22:19:22,664: Using redshift connection "shopify_order_items".
2017-04-19 22:19:22,664: On shopify_order_items: alter table "analytics"."shopify_order_items__dbt_tmp" rename to "shopify_order_items"
2017-04-19 22:19:22,685: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 22:19:22,685: On shopify_order_items: COMMIT
2017-04-19 22:19:22,724: SQL status: CREATE VIEW in 0.24 seconds
2017-04-19 22:19:22,724: Using redshift connection "shopify_orders".
2017-04-19 22:19:22,724: On shopify_orders: alter table "analytics"."shopify_orders__dbt_tmp" rename to "shopify_orders"
2017-04-19 22:19:22,759: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 22:19:22,759: On shopify_orders: COMMIT
2017-04-19 22:19:23,258: 22:19:23 | 10 of 12 OK created view model analytics.shopify_order_items......... [CREATE VIEW in 0.99s]
2017-04-19 22:19:23,258: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfa0208>]}
2017-04-19 22:19:23,541: 22:19:23 | 11 of 12 OK created view model analytics.shopify_orders.............. [CREATE VIEW in 1.27s]
2017-04-19 22:19:23,541: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf7e358>]}
2017-04-19 22:19:23,645: 22:19:23 | 12 of 12 START view model analytics.shopify_orders_xf................ [RUN]
2017-04-19 22:19:23,645: Compiling model.shopify.shopify_orders_xf
2017-04-19 22:19:23,647: Acquiring new redshift connection "shopify_orders_xf".
2017-04-19 22:19:23,647: Re-using an available connection from the pool.
2017-04-19 22:19:23,647: Using redshift connection "shopify_orders_xf".
2017-04-19 22:19:23,647: On shopify_orders_xf: BEGIN
2017-04-19 22:19:23,724: SQL status: BEGIN in 0.08 seconds
2017-04-19 22:19:23,724: Using redshift connection "shopify_orders_xf".
2017-04-19 22:19:23,724: On shopify_orders_xf: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:19:23,808: SQL status: SELECT in 0.08 seconds
2017-04-19 22:19:23,810: executing node model.shopify.shopify_orders_xf
2017-04-19 22:19:23,811: Using redshift connection "shopify_orders_xf".
2017-04-19 22:19:23,811: On shopify_orders_xf: -- Compiled by DBT

    

    create view "analytics"."shopify_orders_xf__dbt_tmp" as (
        

with orders as (

  select * from "analytics"."shopify_orders"

)

select
  *,
  row_number() over (partition by customer_id order by created_at) as order_seq_number,
  case
    when row_number() over (partition by customer_id order by created_at) = 1 then 'new'
    else 'repeat'
  end as new_vs_repeat,
  case
    when cancelled_at is not null then true
    else false
  end as cancelled
from orders
    );

    
2017-04-19 22:19:24,412: SQL status: CREATE VIEW in 0.60 seconds
2017-04-19 22:19:24,412: Using redshift connection "shopify_orders_xf".
2017-04-19 22:19:24,412: On shopify_orders_xf: alter table "analytics"."shopify_orders_xf__dbt_tmp" rename to "shopify_orders_xf"
2017-04-19 22:19:24,462: SQL status: ALTER TABLE in 0.05 seconds
2017-04-19 22:19:24,463: On shopify_orders_xf: COMMIT
2017-04-19 22:19:24,924: 22:19:24 | 12 of 12 OK created view model analytics.shopify_orders_xf........... [CREATE VIEW in 1.28s]
2017-04-19 22:19:24,924: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0279c266-3d4e-45f0-a93e-9670f2bd8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf59438>]}
2017-04-19 22:19:25,083: Using redshift connection "master".
2017-04-19 22:19:25,083: On master: BEGIN
2017-04-19 22:19:25,127: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:19:25,128: On master: COMMIT
2017-04-19 22:19:25,146: 22:19:25 | 
2017-04-19 22:19:25,146: 22:19:25 | Finished running 2 ephemeral models, 12 view models in 8.72s.
2017-04-19 22:19:25,146: Connection 'master' was left open.
2017-04-19 22:19:25,147: Done. PASS=14 ERROR=0 SKIP=0 TOTAL=14
2017-04-19 22:19:25,147: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbdb898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbdbe48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf2f9e8>]}
2017-04-19 22:19:25,348: Flushing usage events
2017-04-19 22:37:13,179: Tracking: tracking
2017-04-19 22:37:13,179: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110efdb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110efdb38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110efdb00>]}
2017-04-19 22:37:13,356: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 22:37:13,401: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 22:37:13,446: Parsing materializations/incremental.sql
2017-04-19 22:37:13,460: Parsing materializations/table.sql
2017-04-19 22:37:13,468: Parsing materializations/view.sql
2017-04-19 22:37:13,471: Parsing materializations/wrapper.sql
2017-04-19 22:37:13,474: Parsing schema_tests/accepted_values.sql
2017-04-19 22:37:13,476: Parsing schema_tests/not_null.sql
2017-04-19 22:37:13,478: Parsing schema_tests/relationships.sql
2017-04-19 22:37:13,479: Parsing schema_tests/unique.sql
2017-04-19 22:37:13,486: Parsing model.shippo_test.shippo_addresses
2017-04-19 22:37:13,488: Parsing model.shippo_test.shippo_parcels
2017-04-19 22:37:13,490: Parsing model.shippo_test.shippo_shipments
2017-04-19 22:37:13,491: Parsing model.shippo_test.shopify_order_items_base
2017-04-19 22:37:13,492: Parsing model.shippo_test.shopify_orders_base
2017-04-19 22:37:13,494: Parsing model.shippo_test.shopify_orders_shipping
2017-04-19 22:37:13,499: Parsing model.shopify.shopify_checkouts
2017-04-19 22:37:13,501: Parsing model.shopify.shopify_customers
2017-04-19 22:37:13,502: Parsing model.shopify.shopify_discount_codes
2017-04-19 22:37:13,504: Parsing model.shopify.shopify_order_items
2017-04-19 22:37:13,505: Parsing model.shopify.shopify_orders
2017-04-19 22:37:13,507: Parsing model.shopify.shopify_products
2017-04-19 22:37:13,508: Parsing model.shopify.shopify_refunds
2017-04-19 22:37:13,509: Parsing model.shopify.shopify_transactions
2017-04-19 22:37:13,511: Parsing model.shopify.shopify_orders_xf
2017-04-19 22:37:13,524: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 22:37:13,525: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 22:37:13,526: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 22:37:13,527: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 22:37:13,528: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 22:37:13,530: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 22:37:13,531: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 22:37:13,532: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 22:37:13,533: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 22:37:13,534: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 22:37:13,535: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 22:37:13,537: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 22:37:13,539: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 22:37:13,540: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 22:37:13,542: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 22:37:13,543: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 22:37:13,544: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 22:37:13,545: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 22:37:13,546: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 22:37:13,547: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 22:37:13,560: Parsing test.shopify.unique_shopify_orders_cart_token
2017-04-19 22:37:13,562: Parsing test.shopify.unique_shopify_orders_id
2017-04-19 22:37:13,563: Parsing test.shopify.not_null_shopify_orders_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 22:37:13,564: Parsing test.shopify.not_null_shopify_orders_id
2017-04-19 22:37:13,565: Parsing test.shopify.relationships_shopify_orders_id__customer_id__shopify_customers
2017-04-19 22:37:13,567: Parsing test.shopify.unique_shopify_checkouts_cart_token
2017-04-19 22:37:13,568: Parsing test.shopify.unique_shopify_checkouts_id
2017-04-19 22:37:13,569: Parsing test.shopify.not_null_shopify_checkouts_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 22:37:13,570: Parsing test.shopify.not_null_shopify_checkouts_id
2017-04-19 22:37:13,571: Parsing test.shopify.relationships_shopify_checkouts_id__customer_id__shopify_customers
2017-04-19 22:37:13,573: Parsing test.shopify.unique_shopify_customers_id
2017-04-19 22:37:13,574: Parsing test.shopify.not_null_shopify_customers_id
2017-04-19 22:37:13,575: Parsing test.shopify.not_null_shopify_discount_codes_order_id
2017-04-19 22:37:13,600: Parsing test.shopify.relationships_shopify_discount_codes_id__order_id__shopify_orders
2017-04-19 22:37:13,602: Parsing test.shopify.not_null_shopify_transactions_id
2017-04-19 22:37:13,603: Parsing test.shopify.not_null_shopify_transactions_order_id
2017-04-19 22:37:13,605: Parsing test.shopify.unique_shopify_transactions_id
2017-04-19 22:37:13,606: Parsing test.shopify.relationships_shopify_transactions_id__order_id__shopify_orders
2017-04-19 22:37:13,608: Parsing test.shopify.not_null_shopify_refunds_id
2017-04-19 22:37:13,609: Parsing test.shopify.not_null_shopify_refunds_order_id
2017-04-19 22:37:13,611: Parsing test.shopify.unique_shopify_refunds_id
2017-04-19 22:37:13,612: Parsing test.shopify.relationships_shopify_refunds_id__order_id__shopify_orders
2017-04-19 22:37:13,615: Parsing test.shopify.not_null_shopify_products_id
2017-04-19 22:37:13,616: Parsing test.shopify.unique_shopify_products_id
2017-04-19 22:37:13,618: Parsing test.shopify.not_null_shopify_order_items_id
2017-04-19 22:37:13,620: Parsing test.shopify.not_null_shopify_order_items_order_id
2017-04-19 22:37:13,621: Parsing test.shopify.unique_shopify_order_items_id
2017-04-19 22:37:13,623: Parsing test.shopify.relationships_shopify_order_items_id__order_id__shopify_orders
2017-04-19 22:37:13,625: Parsing test.shopify.relationships_shopify_order_items_id__product_id__shopify_products
2017-04-19 22:37:13,628: Compiled 15 models, 49 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 22:37:13,629: Acquiring new redshift connection "master".
2017-04-19 22:37:13,629: Opening a new connection (0 currently allocated)
2017-04-19 22:37:13,811: Using redshift connection "master".
2017-04-19 22:37:13,811: On master: BEGIN
2017-04-19 22:37:13,851: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:37:13,852: Creating schema "analytics".
2017-04-19 22:37:13,852: Using redshift connection "master".
2017-04-19 22:37:13,852: On master: create schema if not exists "analytics"
2017-04-19 22:37:13,873: SQL status: CREATE SCHEMA in 0.02 seconds
2017-04-19 22:37:13,874: On master: COMMIT
2017-04-19 22:37:14,503: Concurrency: 4 threads (target='only')
2017-04-19 22:37:14,504: Using redshift connection "master".
2017-04-19 22:37:14,504: On master: BEGIN
2017-04-19 22:37:14,542: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:37:14,543: Using redshift connection "master".
2017-04-19 22:37:14,543: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:37:14,603: SQL status: SELECT in 0.06 seconds
2017-04-19 22:37:14,603: On master: COMMIT
2017-04-19 22:37:14,622: 
2017-04-19 22:37:14,622: 22:37:14 | Running 1 view models
2017-04-19 22:37:14,622: 22:37:14 | 
2017-04-19 22:37:14,622: Using redshift connection "master".
2017-04-19 22:37:14,622: On master: BEGIN
2017-04-19 22:37:14,662: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:37:14,662: On master: COMMIT
2017-04-19 22:37:14,688: 22:37:14 | 1 of 1 START view model analytics.shopify_orders_shipping............ [RUN]
2017-04-19 22:37:14,688: Compiling model.shippo_test.shopify_orders_shipping
2017-04-19 22:37:14,689: Acquiring new redshift connection "shopify_orders_shipping".
2017-04-19 22:37:14,689: Opening a new connection (1 currently allocated)
2017-04-19 22:37:14,955: Using redshift connection "shopify_orders_shipping".
2017-04-19 22:37:14,955: On shopify_orders_shipping: BEGIN
2017-04-19 22:37:15,019: SQL status: BEGIN in 0.06 seconds
2017-04-19 22:37:15,019: Using redshift connection "shopify_orders_shipping".
2017-04-19 22:37:15,019: On shopify_orders_shipping: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:37:15,078: SQL status: SELECT in 0.06 seconds
2017-04-19 22:37:15,080: executing node model.shippo_test.shopify_orders_shipping
2017-04-19 22:37:15,081: Using redshift connection "shopify_orders_shipping".
2017-04-19 22:37:15,081: On shopify_orders_shipping: -- Compiled by DBT

    

    create view "analytics"."shopify_orders_shipping__dbt_tmp" as (
        select

    id,
    _sdc_source_key_id as order_id,
    price,
    source,
    title,
    code

from shippo_chooze_shopify.orders__shipping_lines
    );

    
2017-04-19 22:37:15,209: SQL status: CREATE VIEW in 0.13 seconds
2017-04-19 22:37:15,209: Using redshift connection "shopify_orders_shipping".
2017-04-19 22:37:15,209: On shopify_orders_shipping: alter table "analytics"."shopify_orders_shipping__dbt_tmp" rename to "shopify_orders_shipping"
2017-04-19 22:37:15,238: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 22:37:15,238: On shopify_orders_shipping: COMMIT
2017-04-19 22:37:15,542: 22:37:15 | 1 of 1 OK created view model analytics.shopify_orders_shipping....... [CREATE VIEW in 0.85s]
2017-04-19 22:37:15,543: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b814d2e-ff29-43fa-a292-40060591fe59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ffa780>]}
2017-04-19 22:37:15,649: Using redshift connection "master".
2017-04-19 22:37:15,649: On master: BEGIN
2017-04-19 22:37:15,687: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:37:15,687: On master: COMMIT
2017-04-19 22:37:15,708: 22:37:15 | 
2017-04-19 22:37:15,708: 22:37:15 | Finished running 1 view models in 1.09s.
2017-04-19 22:37:15,709: Connection 'master' was left open.
2017-04-19 22:37:15,709: Done. PASS=1 ERROR=0 SKIP=0 TOTAL=1
2017-04-19 22:37:15,710: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a15c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a1748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110efdb70>]}
2017-04-19 22:37:15,816: Flushing usage events
2017-04-19 22:56:07,117: Tracking: tracking
2017-04-19 22:56:07,117: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102689e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110268a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110268b70>]}
2017-04-19 22:56:07,355: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 22:56:07,401: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 22:56:07,447: Parsing materializations/incremental.sql
2017-04-19 22:56:07,461: Parsing materializations/table.sql
2017-04-19 22:56:07,468: Parsing materializations/view.sql
2017-04-19 22:56:07,472: Parsing materializations/wrapper.sql
2017-04-19 22:56:07,474: Parsing schema_tests/accepted_values.sql
2017-04-19 22:56:07,477: Parsing schema_tests/not_null.sql
2017-04-19 22:56:07,478: Parsing schema_tests/relationships.sql
2017-04-19 22:56:07,480: Parsing schema_tests/unique.sql
2017-04-19 22:56:07,485: Parsing model.shippo_test.shippo_addresses
2017-04-19 22:56:07,486: Parsing model.shippo_test.shippo_parcels
2017-04-19 22:56:07,487: Parsing model.shippo_test.shippo_rates_list
2017-04-19 22:56:07,488: Parsing model.shippo_test.shippo_shipments
2017-04-19 22:56:07,489: Parsing model.shippo_test.shopify_order_items_base
2017-04-19 22:56:07,490: Parsing model.shippo_test.shopify_orders_base
2017-04-19 22:56:07,491: Parsing model.shippo_test.shopify_orders_shipping
2017-04-19 22:56:07,497: Parsing model.shopify.shopify_checkouts
2017-04-19 22:56:07,499: Parsing model.shopify.shopify_customers
2017-04-19 22:56:07,500: Parsing model.shopify.shopify_discount_codes
2017-04-19 22:56:07,501: Parsing model.shopify.shopify_order_items
2017-04-19 22:56:07,503: Parsing model.shopify.shopify_orders
2017-04-19 22:56:07,505: Parsing model.shopify.shopify_products
2017-04-19 22:56:07,506: Parsing model.shopify.shopify_refunds
2017-04-19 22:56:07,507: Parsing model.shopify.shopify_transactions
2017-04-19 22:56:07,508: Parsing model.shopify.shopify_orders_xf
2017-04-19 22:56:07,521: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 22:56:07,522: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 22:56:07,523: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 22:56:07,524: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 22:56:07,526: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 22:56:07,527: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 22:56:07,528: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 22:56:07,529: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 22:56:07,530: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 22:56:07,531: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 22:56:07,532: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 22:56:07,534: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 22:56:07,535: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 22:56:07,538: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 22:56:07,539: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 22:56:07,540: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 22:56:07,542: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 22:56:07,543: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 22:56:07,544: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 22:56:07,545: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 22:56:07,558: Parsing test.shopify.unique_shopify_orders_cart_token
2017-04-19 22:56:07,559: Parsing test.shopify.unique_shopify_orders_id
2017-04-19 22:56:07,560: Parsing test.shopify.not_null_shopify_orders_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 22:56:07,561: Parsing test.shopify.not_null_shopify_orders_id
2017-04-19 22:56:07,562: Parsing test.shopify.relationships_shopify_orders_id__customer_id__shopify_customers
2017-04-19 22:56:07,564: Parsing test.shopify.unique_shopify_checkouts_cart_token
2017-04-19 22:56:07,565: Parsing test.shopify.unique_shopify_checkouts_id
2017-04-19 22:56:07,566: Parsing test.shopify.not_null_shopify_checkouts_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 22:56:07,567: Parsing test.shopify.not_null_shopify_checkouts_id
2017-04-19 22:56:07,568: Parsing test.shopify.relationships_shopify_checkouts_id__customer_id__shopify_customers
2017-04-19 22:56:07,570: Parsing test.shopify.unique_shopify_customers_id
2017-04-19 22:56:07,571: Parsing test.shopify.not_null_shopify_customers_id
2017-04-19 22:56:07,572: Parsing test.shopify.not_null_shopify_discount_codes_order_id
2017-04-19 22:56:07,597: Parsing test.shopify.relationships_shopify_discount_codes_id__order_id__shopify_orders
2017-04-19 22:56:07,599: Parsing test.shopify.not_null_shopify_transactions_id
2017-04-19 22:56:07,600: Parsing test.shopify.not_null_shopify_transactions_order_id
2017-04-19 22:56:07,602: Parsing test.shopify.unique_shopify_transactions_id
2017-04-19 22:56:07,603: Parsing test.shopify.relationships_shopify_transactions_id__order_id__shopify_orders
2017-04-19 22:56:07,605: Parsing test.shopify.not_null_shopify_refunds_id
2017-04-19 22:56:07,607: Parsing test.shopify.not_null_shopify_refunds_order_id
2017-04-19 22:56:07,608: Parsing test.shopify.unique_shopify_refunds_id
2017-04-19 22:56:07,610: Parsing test.shopify.relationships_shopify_refunds_id__order_id__shopify_orders
2017-04-19 22:56:07,611: Parsing test.shopify.not_null_shopify_products_id
2017-04-19 22:56:07,613: Parsing test.shopify.unique_shopify_products_id
2017-04-19 22:56:07,614: Parsing test.shopify.not_null_shopify_order_items_id
2017-04-19 22:56:07,616: Parsing test.shopify.not_null_shopify_order_items_order_id
2017-04-19 22:56:07,617: Parsing test.shopify.unique_shopify_order_items_id
2017-04-19 22:56:07,619: Parsing test.shopify.relationships_shopify_order_items_id__order_id__shopify_orders
2017-04-19 22:56:07,620: Parsing test.shopify.relationships_shopify_order_items_id__product_id__shopify_products
2017-04-19 22:56:07,624: Compiled 16 models, 49 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 22:56:07,624: Acquiring new redshift connection "master".
2017-04-19 22:56:07,624: Opening a new connection (0 currently allocated)
2017-04-19 22:56:07,803: Using redshift connection "master".
2017-04-19 22:56:07,803: On master: BEGIN
2017-04-19 22:56:07,844: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:56:07,844: Creating schema "analytics".
2017-04-19 22:56:07,844: Using redshift connection "master".
2017-04-19 22:56:07,844: On master: create schema if not exists "analytics"
2017-04-19 22:56:07,866: SQL status: CREATE SCHEMA in 0.02 seconds
2017-04-19 22:56:07,867: On master: COMMIT
2017-04-19 22:56:08,288: Concurrency: 4 threads (target='only')
2017-04-19 22:56:08,288: Using redshift connection "master".
2017-04-19 22:56:08,288: On master: BEGIN
2017-04-19 22:56:08,326: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:56:08,327: Using redshift connection "master".
2017-04-19 22:56:08,327: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:56:08,384: SQL status: SELECT in 0.06 seconds
2017-04-19 22:56:08,384: On master: COMMIT
2017-04-19 22:56:08,407: 
2017-04-19 22:56:08,407: 22:56:08 | Running 1 view models
2017-04-19 22:56:08,408: 22:56:08 | 
2017-04-19 22:56:08,408: Using redshift connection "master".
2017-04-19 22:56:08,408: On master: BEGIN
2017-04-19 22:56:08,448: SQL status: BEGIN in 0.04 seconds
2017-04-19 22:56:08,449: On master: COMMIT
2017-04-19 22:56:08,469: 22:56:08 | 1 of 1 START view model analytics.shippo_rates_list.................. [RUN]
2017-04-19 22:56:08,469: Compiling model.shippo_test.shippo_rates_list
2017-04-19 22:56:08,470: Acquiring new redshift connection "shippo_rates_list".
2017-04-19 22:56:08,471: Opening a new connection (1 currently allocated)
2017-04-19 22:56:08,766: Using redshift connection "shippo_rates_list".
2017-04-19 22:56:08,766: On shippo_rates_list: BEGIN
2017-04-19 22:56:08,836: SQL status: BEGIN in 0.07 seconds
2017-04-19 22:56:08,837: Using redshift connection "shippo_rates_list".
2017-04-19 22:56:08,837: On shippo_rates_list: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 22:56:08,890: SQL status: SELECT in 0.05 seconds
2017-04-19 22:56:08,892: executing node model.shippo_test.shippo_rates_list
2017-04-19 22:56:08,894: Using redshift connection "shippo_rates_list".
2017-04-19 22:56:08,894: On shippo_rates_list: -- Compiled by DBT

    

    create view "analytics"."shippo_rates_list__dbt_tmp" as (
        select

    object_id as id,

    shipment as shipment_id,


    amount,
    amount_local,
    available_shippo,
    carrier_account,
    currency,
    currency_local,
    days,
    duration_terms,
    inbound_endpoint,
    insurance,
    insurance_amount,
    insurance_amount_local,
    insurance_currency,
    insurance_currency_local,

    outbound_endpoint,
    provider,

    servicelevel_name as service_level_name,
    servicelevel_terms as service_level_terms,
    servicelevel_token as service_level_token,

    trackable,
    zone,

    object_owner as owner,
    object_purpose as purpose,
    object_state as state,

    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments__rates_list

where test = false
    );

    
2017-04-19 22:56:09,414: SQL status: CREATE VIEW in 0.52 seconds
2017-04-19 22:56:09,414: Using redshift connection "shippo_rates_list".
2017-04-19 22:56:09,415: On shippo_rates_list: alter table "analytics"."shippo_rates_list__dbt_tmp" rename to "shippo_rates_list"
2017-04-19 22:56:09,456: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 22:56:09,456: On shippo_rates_list: COMMIT
2017-04-19 22:56:09,812: 22:56:09 | 1 of 1 OK created view model analytics.shippo_rates_list............. [CREATE VIEW in 1.34s]
2017-04-19 22:56:09,812: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '380896a6-33e2-48ab-a01a-78cd6e39b225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110361438>]}
2017-04-19 22:56:09,942: Using redshift connection "master".
2017-04-19 22:56:09,942: On master: BEGIN
2017-04-19 22:56:09,977: SQL status: BEGIN in 0.03 seconds
2017-04-19 22:56:09,978: On master: COMMIT
2017-04-19 22:56:09,998: 22:56:09 | 
2017-04-19 22:56:09,999: 22:56:09 | Finished running 1 view models in 1.59s.
2017-04-19 22:56:09,999: Connection 'master' was left open.
2017-04-19 22:56:10,000: Done. PASS=1 ERROR=0 SKIP=0 TOTAL=1
2017-04-19 22:56:10,000: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f952048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9bc588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9bc780>]}
2017-04-19 22:56:10,099: Flushing usage events
2017-04-19 23:01:00,999: Tracking: tracking
2017-04-19 23:01:00,999: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fbd860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fbd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fbda20>]}
2017-04-19 23:01:01,193: Loading dependency project from /usr/local/Cellar/dbt/0.8.0/libexec/lib/python3.6/site-packages/dbt/include
2017-04-19 23:01:01,242: Loading dependency project from /Users/tristan/dev/scratch/shippo-test/dbt_modules
2017-04-19 23:01:01,287: Parsing materializations/incremental.sql
2017-04-19 23:01:01,302: Parsing materializations/table.sql
2017-04-19 23:01:01,309: Parsing materializations/view.sql
2017-04-19 23:01:01,315: Parsing materializations/wrapper.sql
2017-04-19 23:01:01,318: Parsing schema_tests/accepted_values.sql
2017-04-19 23:01:01,321: Parsing schema_tests/not_null.sql
2017-04-19 23:01:01,322: Parsing schema_tests/relationships.sql
2017-04-19 23:01:01,324: Parsing schema_tests/unique.sql
2017-04-19 23:01:01,330: Parsing model.shippo_test.shipping_cost_vs_price
2017-04-19 23:01:01,333: Parsing model.shippo_test.shippo_addresses
2017-04-19 23:01:01,334: Parsing model.shippo_test.shippo_parcels
2017-04-19 23:01:01,336: Parsing model.shippo_test.shippo_rates_list
2017-04-19 23:01:01,337: Parsing model.shippo_test.shippo_shipments
2017-04-19 23:01:01,338: Parsing model.shippo_test.shopify_order_items_base
2017-04-19 23:01:01,339: Parsing model.shippo_test.shopify_orders_base
2017-04-19 23:01:01,340: Parsing model.shippo_test.shopify_orders_shipping
2017-04-19 23:01:01,347: Parsing model.shopify.shopify_checkouts
2017-04-19 23:01:01,349: Parsing model.shopify.shopify_customers
2017-04-19 23:01:01,350: Parsing model.shopify.shopify_discount_codes
2017-04-19 23:01:01,352: Parsing model.shopify.shopify_order_items
2017-04-19 23:01:01,353: Parsing model.shopify.shopify_orders
2017-04-19 23:01:01,355: Parsing model.shopify.shopify_products
2017-04-19 23:01:01,357: Parsing model.shopify.shopify_refunds
2017-04-19 23:01:01,358: Parsing model.shopify.shopify_transactions
2017-04-19 23:01:01,359: Parsing model.shopify.shopify_orders_xf
2017-04-19 23:01:01,372: Parsing test.shippo_test.unique_shippo_parcels_id
2017-04-19 23:01:01,373: Parsing test.shippo_test.not_null_shippo_parcels_id
2017-04-19 23:01:01,374: Parsing test.shippo_test.not_null_shippo_parcels_state
2017-04-19 23:01:01,376: Parsing test.shippo_test.not_null_shippo_parcels_created_at
2017-04-19 23:01:01,377: Parsing test.shippo_test.unique_shippo_shipments_id
2017-04-19 23:01:01,378: Parsing test.shippo_test.not_null_shippo_shipments_id
2017-04-19 23:01:01,379: Parsing test.shippo_test.not_null_shippo_shipments_state
2017-04-19 23:01:01,380: Parsing test.shippo_test.not_null_shippo_shipments_purpose
2017-04-19 23:01:01,381: Parsing test.shippo_test.not_null_shippo_shipments_status
2017-04-19 23:01:01,383: Parsing test.shippo_test.not_null_shippo_shipments_created_at
2017-04-19 23:01:01,384: Parsing test.shippo_test.relationships_shippo_shipments_id__parcel_id__ref_shippo_parcels_
2017-04-19 23:01:01,385: Parsing test.shippo_test.relationships_shippo_shipments_id__address_from_id__ref_shippo_addresses_
2017-04-19 23:01:01,387: Parsing test.shippo_test.relationships_shippo_shipments_id__address_return_id__ref_shippo_addresses_
2017-04-19 23:01:01,388: Parsing test.shippo_test.relationships_shippo_shipments_id__address_to_id__ref_shippo_addresses_
2017-04-19 23:01:01,390: Parsing test.shippo_test.unique_shippo_addresses_id
2017-04-19 23:01:01,391: Parsing test.shippo_test.not_null_shippo_addresses_id
2017-04-19 23:01:01,392: Parsing test.shippo_test.not_null_shippo_addresses_object_state
2017-04-19 23:01:01,393: Parsing test.shippo_test.not_null_shippo_addresses_purpose
2017-04-19 23:01:01,395: Parsing test.shippo_test.not_null_shippo_addresses_source
2017-04-19 23:01:01,396: Parsing test.shippo_test.not_null_shippo_addresses_created_at
2017-04-19 23:01:01,411: Parsing test.shopify.unique_shopify_orders_cart_token
2017-04-19 23:01:01,412: Parsing test.shopify.unique_shopify_orders_id
2017-04-19 23:01:01,414: Parsing test.shopify.not_null_shopify_orders_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 23:01:01,415: Parsing test.shopify.not_null_shopify_orders_id
2017-04-19 23:01:01,416: Parsing test.shopify.relationships_shopify_orders_id__customer_id__shopify_customers
2017-04-19 23:01:01,417: Parsing test.shopify.unique_shopify_checkouts_cart_token
2017-04-19 23:01:01,419: Parsing test.shopify.unique_shopify_checkouts_id
2017-04-19 23:01:01,420: Parsing test.shopify.not_null_shopify_checkouts_case_when_source_name_web_then_cart_token_else_ok_end
2017-04-19 23:01:01,421: Parsing test.shopify.not_null_shopify_checkouts_id
2017-04-19 23:01:01,422: Parsing test.shopify.relationships_shopify_checkouts_id__customer_id__shopify_customers
2017-04-19 23:01:01,424: Parsing test.shopify.unique_shopify_customers_id
2017-04-19 23:01:01,425: Parsing test.shopify.not_null_shopify_customers_id
2017-04-19 23:01:01,426: Parsing test.shopify.not_null_shopify_discount_codes_order_id
2017-04-19 23:01:01,428: Parsing test.shopify.relationships_shopify_discount_codes_id__order_id__shopify_orders
2017-04-19 23:01:01,429: Parsing test.shopify.not_null_shopify_transactions_id
2017-04-19 23:01:01,430: Parsing test.shopify.not_null_shopify_transactions_order_id
2017-04-19 23:01:01,431: Parsing test.shopify.unique_shopify_transactions_id
2017-04-19 23:01:01,433: Parsing test.shopify.relationships_shopify_transactions_id__order_id__shopify_orders
2017-04-19 23:01:01,434: Parsing test.shopify.not_null_shopify_refunds_id
2017-04-19 23:01:01,435: Parsing test.shopify.not_null_shopify_refunds_order_id
2017-04-19 23:01:01,436: Parsing test.shopify.unique_shopify_refunds_id
2017-04-19 23:01:01,438: Parsing test.shopify.relationships_shopify_refunds_id__order_id__shopify_orders
2017-04-19 23:01:01,440: Parsing test.shopify.not_null_shopify_products_id
2017-04-19 23:01:01,442: Parsing test.shopify.unique_shopify_products_id
2017-04-19 23:01:01,443: Parsing test.shopify.not_null_shopify_order_items_id
2017-04-19 23:01:01,445: Parsing test.shopify.not_null_shopify_order_items_order_id
2017-04-19 23:01:01,471: Parsing test.shopify.unique_shopify_order_items_id
2017-04-19 23:01:01,473: Parsing test.shopify.relationships_shopify_order_items_id__order_id__shopify_orders
2017-04-19 23:01:01,475: Parsing test.shopify.relationships_shopify_order_items_id__product_id__shopify_products
2017-04-19 23:01:01,479: Compiled 17 models, 49 tests, 0 archives, 0 analyses, 9 macros
2017-04-19 23:01:01,484: Acquiring new redshift connection "master".
2017-04-19 23:01:01,484: Opening a new connection (0 currently allocated)
2017-04-19 23:01:01,940: Using redshift connection "master".
2017-04-19 23:01:01,940: On master: BEGIN
2017-04-19 23:01:02,010: SQL status: BEGIN in 0.07 seconds
2017-04-19 23:01:02,010: Creating schema "analytics".
2017-04-19 23:01:02,011: Using redshift connection "master".
2017-04-19 23:01:02,011: On master: create schema if not exists "analytics"
2017-04-19 23:01:02,050: SQL status: CREATE SCHEMA in 0.04 seconds
2017-04-19 23:01:02,050: On master: COMMIT
2017-04-19 23:01:02,736: Concurrency: 4 threads (target='only')
2017-04-19 23:01:02,736: Using redshift connection "master".
2017-04-19 23:01:02,737: On master: BEGIN
2017-04-19 23:01:02,808: SQL status: BEGIN in 0.07 seconds
2017-04-19 23:01:02,808: Using redshift connection "master".
2017-04-19 23:01:02,808: On master: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:02,864: SQL status: SELECT in 0.06 seconds
2017-04-19 23:01:02,864: On master: COMMIT
2017-04-19 23:01:02,901: 
2017-04-19 23:01:02,902: 23:01:02 | Running 14 view models, 2 ephemeral models, 1 table models
2017-04-19 23:01:02,902: 23:01:02 | 
2017-04-19 23:01:02,902: Using redshift connection "master".
2017-04-19 23:01:02,902: On master: BEGIN
2017-04-19 23:01:02,971: SQL status: BEGIN in 0.07 seconds
2017-04-19 23:01:02,971: On master: COMMIT
2017-04-19 23:01:03,006: 23:01:03 | 1 of 15 START view model analytics.shippo_rates_list................. [RUN]
2017-04-19 23:01:03,006: Compiling model.shippo_test.shippo_rates_list
2017-04-19 23:01:03,008: Acquiring new redshift connection "shippo_rates_list".
2017-04-19 23:01:03,008: Opening a new connection (1 currently allocated)
2017-04-19 23:01:03,008: 23:01:03 | 2 of 15 START view model analytics.shippo_shipments.................. [RUN]
2017-04-19 23:01:03,009: Compiling model.shippo_test.shippo_shipments
2017-04-19 23:01:03,011: Acquiring new redshift connection "shippo_shipments".
2017-04-19 23:01:03,011: 23:01:03 | 3 of 15 START view model analytics.shippo_parcels.................... [RUN]
2017-04-19 23:01:03,011: Compiling model.shippo_test.shippo_parcels
2017-04-19 23:01:03,013: Acquiring new redshift connection "shippo_parcels".
2017-04-19 23:01:03,013: 23:01:03 | 4 of 15 START view model analytics.shopify_transactions.............. [RUN]
2017-04-19 23:01:03,013: Compiling model.shopify.shopify_transactions
2017-04-19 23:01:03,015: Acquiring new redshift connection "shopify_transactions".
2017-04-19 23:01:03,199: Using redshift connection "shippo_rates_list".
2017-04-19 23:01:03,199: Opening a new connection (2 currently allocated)
2017-04-19 23:01:03,199: On shippo_rates_list: BEGIN
2017-04-19 23:01:03,242: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:03,242: Using redshift connection "shippo_rates_list".
2017-04-19 23:01:03,242: On shippo_rates_list: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:03,297: SQL status: SELECT in 0.05 seconds
2017-04-19 23:01:03,299: executing node model.shippo_test.shippo_rates_list
2017-04-19 23:01:03,301: Using redshift connection "shippo_rates_list".
2017-04-19 23:01:03,301: On shippo_rates_list: -- Compiled by DBT

    

    create view "analytics"."shippo_rates_list__dbt_tmp" as (
        select

    object_id as id,

    shipment as shipment_id,


    amount,
    amount_local,
    available_shippo,
    carrier_account,
    currency,
    currency_local,
    days,
    duration_terms,
    inbound_endpoint,
    insurance,
    insurance_amount,
    insurance_amount_local,
    insurance_currency,
    insurance_currency_local,

    outbound_endpoint,
    provider,

    servicelevel_name as service_level_name,
    servicelevel_terms as service_level_terms,
    servicelevel_token as service_level_token,

    trackable,
    zone,

    object_owner as owner,
    object_purpose as purpose,
    object_state as state,

    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments__rates_list

where test = false
    );

    
2017-04-19 23:01:03,379: Using redshift connection "shippo_shipments".
2017-04-19 23:01:03,379: On shippo_shipments: BEGIN
2017-04-19 23:01:03,379: Opening a new connection (3 currently allocated)
2017-04-19 23:01:03,419: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:03,420: Using redshift connection "shippo_shipments".
2017-04-19 23:01:03,420: On shippo_shipments: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:03,467: SQL status: SELECT in 0.05 seconds
2017-04-19 23:01:03,469: executing node model.shippo_test.shippo_shipments
2017-04-19 23:01:03,470: Using redshift connection "shippo_shipments".
2017-04-19 23:01:03,470: On shippo_shipments: -- Compiled by DBT

    

    create view "analytics"."shippo_shipments__dbt_tmp" as (
        select

    object_id as id,

    address_from as address_from_id,
    address_return as address_return_id,
    address_to as address_to_id,
    parcel as parcel_id,

    insurance_amount::float,
    insurance_currency,

    rates_url,
    return_of,
    submission_date,
    lower(submission_type) as submission_type,
    customs_declaration,


    object_owner as owner,
    lower(object_state) as state,
    lower(object_purpose) as purpose,
    lower(object_status) as status,


    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.shipments
    );

    
2017-04-19 23:01:03,526: Using redshift connection "shippo_parcels".
2017-04-19 23:01:03,527: On shippo_parcels: BEGIN
2017-04-19 23:01:03,527: Opening a new connection (4 currently allocated)
2017-04-19 23:01:03,567: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:03,568: Using redshift connection "shippo_parcels".
2017-04-19 23:01:03,568: On shippo_parcels: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:03,610: SQL status: SELECT in 0.04 seconds
2017-04-19 23:01:03,612: executing node model.shippo_test.shippo_parcels
2017-04-19 23:01:03,613: Using redshift connection "shippo_parcels".
2017-04-19 23:01:03,613: On shippo_parcels: -- Compiled by DBT

    

    create view "analytics"."shippo_parcels__dbt_tmp" as (
        select

    object_id as id,

    distance_unit,
    height::float,
    length::float,
    width::float,
    mass_unit,
    weight::float,

    object_owner as owner,
    template,
    lower(object_state) as state,

    object_created as created_at,
    object_updated as updated_at

from shippo_chooze.parcels
    );

    
2017-04-19 23:01:03,725: SQL status: CREATE VIEW in 0.42 seconds
2017-04-19 23:01:03,725: On shippo_rates_list: COMMIT
2017-04-19 23:01:03,730: SQL status: CREATE VIEW in 0.12 seconds
2017-04-19 23:01:03,843: Using redshift connection "shopify_transactions".
2017-04-19 23:01:03,843: On shopify_transactions: BEGIN
2017-04-19 23:01:03,863: SQL status: CREATE VIEW in 0.39 seconds
2017-04-19 23:01:03,920: SQL status: BEGIN in 0.08 seconds
2017-04-19 23:01:03,920: Using redshift connection "shopify_transactions".
2017-04-19 23:01:03,920: On shopify_transactions: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:03,977: SQL status: SELECT in 0.06 seconds
2017-04-19 23:01:03,979: executing node model.shopify.shopify_transactions
2017-04-19 23:01:03,980: Using redshift connection "shopify_transactions".
2017-04-19 23:01:03,980: On shopify_transactions: -- Compiled by DBT

    

    create view "analytics"."shopify_transactions__dbt_tmp" as (
        select

  id,
  parent_id,
  order_id,

  status,
  error_code,
  message,

  kind,
  amount,
  "authorization",
  currency,
  gateway,

  source_name,

  created_at

from
  shippo_chooze_shopify.transactions

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 23:01:04,024: SQL status: CREATE VIEW in 0.04 seconds
2017-04-19 23:01:04,329: Using redshift connection "shippo_rates_list".
2017-04-19 23:01:04,329: On shippo_rates_list: BEGIN
2017-04-19 23:01:04,373: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:04,373: Using redshift connection "shippo_rates_list".
2017-04-19 23:01:04,373: On shippo_rates_list: drop view if exists "analytics"."shippo_rates_list" cascade
2017-04-19 23:01:04,402: SQL status: DROP VIEW in 0.03 seconds
2017-04-19 23:01:04,402: On shippo_rates_list: COMMIT
2017-04-19 23:01:04,952: Using redshift connection "shippo_rates_list".
2017-04-19 23:01:04,952: On shippo_rates_list: BEGIN
2017-04-19 23:01:04,990: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:04,990: Using redshift connection "shippo_rates_list".
2017-04-19 23:01:04,991: On shippo_rates_list: alter table "analytics"."shippo_rates_list__dbt_tmp" rename to "shippo_rates_list"
2017-04-19 23:01:04,991: On shippo_parcels: COMMIT
2017-04-19 23:01:05,015: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 23:01:05,015: On shippo_rates_list: COMMIT
2017-04-19 23:01:05,763: Using redshift connection "shippo_parcels".
2017-04-19 23:01:05,763: On shippo_parcels: BEGIN
2017-04-19 23:01:05,801: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:05,801: Using redshift connection "shippo_parcels".
2017-04-19 23:01:05,801: On shippo_parcels: drop view if exists "analytics"."shippo_parcels" cascade
2017-04-19 23:01:05,861: 23:01:05 | 1 of 15 OK created view model analytics.shippo_rates_list............ [CREATE VIEW in 2.85s]
2017-04-19 23:01:05,861: 23:01:05 | 5 of 15 START view model analytics.shopify_products.................. [RUN]
2017-04-19 23:01:05,862: Compiling model.shopify.shopify_products
2017-04-19 23:01:05,864: Acquiring new redshift connection "shopify_products".
2017-04-19 23:01:05,864: Re-using an available connection from the pool.
2017-04-19 23:01:05,864: Using redshift connection "shopify_products".
2017-04-19 23:01:05,864: On shopify_products: BEGIN
2017-04-19 23:01:05,864: SQL status: DROP VIEW in 0.06 seconds
2017-04-19 23:01:05,865: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b17898>]}
2017-04-19 23:01:05,865: On shippo_parcels: COMMIT
2017-04-19 23:01:05,908: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:05,908: Using redshift connection "shopify_products".
2017-04-19 23:01:05,909: On shopify_products: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:05,948: SQL status: SELECT in 0.04 seconds
2017-04-19 23:01:05,949: executing node model.shopify.shopify_products
2017-04-19 23:01:05,950: Using redshift connection "shopify_products".
2017-04-19 23:01:05,950: On shopify_products: -- Compiled by DBT

    

    create view "analytics"."shopify_products__dbt_tmp" as (
        select

  id,
  title,
  product_type,
  vendor,
  tags,
  handle,
  published_at,
  created_at,
  updated_at

from
  shippo_chooze_shopify.products
    );

    
2017-04-19 23:01:06,275: SQL status: CREATE VIEW in 0.32 seconds
2017-04-19 23:01:06,276: Using redshift connection "shippo_parcels".
2017-04-19 23:01:06,276: On shippo_parcels: BEGIN
2017-04-19 23:01:06,319: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:06,320: Using redshift connection "shippo_parcels".
2017-04-19 23:01:06,320: On shippo_parcels: alter table "analytics"."shippo_parcels__dbt_tmp" rename to "shippo_parcels"
2017-04-19 23:01:06,320: On shippo_shipments: COMMIT
2017-04-19 23:01:06,343: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 23:01:06,343: On shippo_parcels: COMMIT
2017-04-19 23:01:06,992: Using redshift connection "shippo_shipments".
2017-04-19 23:01:06,992: On shippo_shipments: BEGIN
2017-04-19 23:01:07,032: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:07,032: Using redshift connection "shippo_shipments".
2017-04-19 23:01:07,032: On shippo_shipments: drop view if exists "analytics"."shippo_shipments" cascade
2017-04-19 23:01:07,503: SQL status: DROP VIEW in 0.47 seconds
2017-04-19 23:01:07,504: On shippo_shipments: COMMIT
2017-04-19 23:01:07,688: 23:01:07 | 3 of 15 OK created view model analytics.shippo_parcels............... [CREATE VIEW in 4.68s]
2017-04-19 23:01:07,689: Compiling model.shippo_test.shopify_order_items_base
2017-04-19 23:01:07,691: Compiling model.shippo_test.shopify_orders_base
2017-04-19 23:01:07,693: 23:01:07 | 6 of 15 START view model analytics.shopify_customers................. [RUN]
2017-04-19 23:01:07,693: Compiling model.shopify.shopify_customers
2017-04-19 23:01:07,695: Acquiring new redshift connection "shopify_customers".
2017-04-19 23:01:07,695: Re-using an available connection from the pool.
2017-04-19 23:01:07,695: Using redshift connection "shopify_customers".
2017-04-19 23:01:07,695: On shopify_customers: BEGIN
2017-04-19 23:01:07,695: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b1eb70>]}
2017-04-19 23:01:07,734: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:07,735: Using redshift connection "shopify_customers".
2017-04-19 23:01:07,735: On shopify_customers: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:07,788: SQL status: SELECT in 0.05 seconds
2017-04-19 23:01:07,789: executing node model.shopify.shopify_customers
2017-04-19 23:01:07,790: Using redshift connection "shopify_customers".
2017-04-19 23:01:07,790: On shopify_customers: -- Compiled by DBT

    

    create view "analytics"."shopify_customers__dbt_tmp" as (
        select
  id,
  first_name,
  last_name,
  email,
  verified_email,
  default_address__id as default_address_id,
  note,
  state,
  tags,
  tax_exempt,
  created_at,
  updated_at
from
  shippo_chooze_shopify.customers
    );

    
2017-04-19 23:01:07,808: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b1eb70>]}
2017-04-19 23:01:07,913: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b40390>]}
2017-04-19 23:01:08,089: SQL status: CREATE VIEW in 0.30 seconds
2017-04-19 23:01:08,250: Using redshift connection "shippo_shipments".
2017-04-19 23:01:08,250: On shippo_shipments: BEGIN
2017-04-19 23:01:08,296: SQL status: BEGIN in 0.05 seconds
2017-04-19 23:01:08,296: Using redshift connection "shippo_shipments".
2017-04-19 23:01:08,296: On shippo_shipments: alter table "analytics"."shippo_shipments__dbt_tmp" rename to "shippo_shipments"
2017-04-19 23:01:08,296: On shopify_transactions: COMMIT
2017-04-19 23:01:08,514: SQL status: ALTER TABLE in 0.22 seconds
2017-04-19 23:01:08,514: On shippo_shipments: COMMIT
2017-04-19 23:01:09,424: Using redshift connection "shopify_transactions".
2017-04-19 23:01:09,424: On shopify_transactions: BEGIN
2017-04-19 23:01:09,467: 23:01:09 | 2 of 15 OK created view model analytics.shippo_shipments............. [CREATE VIEW in 6.46s]
2017-04-19 23:01:09,467: 23:01:09 | 7 of 15 START view model analytics.shopify_orders_shipping........... [RUN]
2017-04-19 23:01:09,467: Compiling model.shippo_test.shopify_orders_shipping
2017-04-19 23:01:09,468: Acquiring new redshift connection "shopify_orders_shipping".
2017-04-19 23:01:09,468: Re-using an available connection from the pool.
2017-04-19 23:01:09,469: Using redshift connection "shopify_orders_shipping".
2017-04-19 23:01:09,469: On shopify_orders_shipping: BEGIN
2017-04-19 23:01:09,469: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af3710>]}
2017-04-19 23:01:09,503: SQL status: BEGIN in 0.08 seconds
2017-04-19 23:01:09,503: Using redshift connection "shopify_transactions".
2017-04-19 23:01:09,503: On shopify_transactions: drop view if exists "analytics"."shopify_transactions" cascade
2017-04-19 23:01:09,514: SQL status: BEGIN in 0.05 seconds
2017-04-19 23:01:09,515: Using redshift connection "shopify_orders_shipping".
2017-04-19 23:01:09,515: On shopify_orders_shipping: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:09,555: SQL status: SELECT in 0.04 seconds
2017-04-19 23:01:09,557: executing node model.shippo_test.shopify_orders_shipping
2017-04-19 23:01:09,558: Using redshift connection "shopify_orders_shipping".
2017-04-19 23:01:09,558: On shopify_orders_shipping: -- Compiled by DBT

    

    create view "analytics"."shopify_orders_shipping__dbt_tmp" as (
        select

    id,
    _sdc_source_key_id as order_id,
    price,
    source,
    title,
    code

from shippo_chooze_shopify.orders__shipping_lines
    );

    
2017-04-19 23:01:09,566: SQL status: DROP VIEW in 0.06 seconds
2017-04-19 23:01:09,567: On shopify_transactions: COMMIT
2017-04-19 23:01:10,718: SQL status: CREATE VIEW in 1.16 seconds
2017-04-19 23:01:10,800: Using redshift connection "shopify_transactions".
2017-04-19 23:01:10,800: On shopify_transactions: BEGIN
2017-04-19 23:01:10,876: SQL status: BEGIN in 0.08 seconds
2017-04-19 23:01:10,876: Using redshift connection "shopify_transactions".
2017-04-19 23:01:10,876: On shopify_transactions: alter table "analytics"."shopify_transactions__dbt_tmp" rename to "shopify_transactions"
2017-04-19 23:01:10,876: On shopify_products: COMMIT
2017-04-19 23:01:10,919: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 23:01:10,919: On shopify_transactions: COMMIT
2017-04-19 23:01:12,296: Using redshift connection "shopify_products".
2017-04-19 23:01:12,296: On shopify_products: BEGIN
2017-04-19 23:01:12,337: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:12,337: Using redshift connection "shopify_products".
2017-04-19 23:01:12,337: On shopify_products: drop view if exists "analytics"."shopify_products" cascade
2017-04-19 23:01:12,442: 23:01:12 | 4 of 15 OK created view model analytics.shopify_transactions......... [CREATE VIEW in 9.43s]
2017-04-19 23:01:12,442: 23:01:12 | 8 of 15 START view model analytics.shopify_checkouts................. [RUN]
2017-04-19 23:01:12,443: Compiling model.shopify.shopify_checkouts
2017-04-19 23:01:12,443: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112985710>]}
2017-04-19 23:01:12,446: Acquiring new redshift connection "shopify_checkouts".
2017-04-19 23:01:12,447: Re-using an available connection from the pool.
2017-04-19 23:01:12,447: Using redshift connection "shopify_checkouts".
2017-04-19 23:01:12,447: On shopify_checkouts: BEGIN
2017-04-19 23:01:12,517: SQL status: BEGIN in 0.07 seconds
2017-04-19 23:01:12,517: Using redshift connection "shopify_checkouts".
2017-04-19 23:01:12,517: On shopify_checkouts: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:12,606: SQL status: SELECT in 0.09 seconds
2017-04-19 23:01:12,608: executing node model.shopify.shopify_checkouts
2017-04-19 23:01:12,610: Using redshift connection "shopify_checkouts".
2017-04-19 23:01:12,610: On shopify_checkouts: -- Compiled by DBT

    

    create view "analytics"."shopify_checkouts__dbt_tmp" as (
        select
  id,
  customer__id as customer_id,
  email,
  nullif(cart_token, '') as cart_token,
  nullif(token, '') as token,
  abandoned_checkout_url,
  name,
  completed_at,
  currency,
  gateway,
  landing_site,
  note,
  source_name,
  referring_site,
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_tax,
  total_weight,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  updated_at,
  created_at
from
  shippo_chooze_shopify.checkouts
    );

    
2017-04-19 23:01:12,651: SQL status: DROP VIEW in 0.31 seconds
2017-04-19 23:01:12,651: On shopify_products: COMMIT
2017-04-19 23:01:13,443: Using redshift connection "shopify_products".
2017-04-19 23:01:13,443: On shopify_products: BEGIN
2017-04-19 23:01:13,443: SQL status: CREATE VIEW in 0.83 seconds
2017-04-19 23:01:13,481: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:13,481: Using redshift connection "shopify_products".
2017-04-19 23:01:13,481: On shopify_products: alter table "analytics"."shopify_products__dbt_tmp" rename to "shopify_products"
2017-04-19 23:01:13,482: On shopify_customers: COMMIT
2017-04-19 23:01:13,503: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 23:01:13,503: On shopify_products: COMMIT
2017-04-19 23:01:15,696: Using redshift connection "shopify_customers".
2017-04-19 23:01:15,696: On shopify_customers: BEGIN
2017-04-19 23:01:15,735: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:15,735: Using redshift connection "shopify_customers".
2017-04-19 23:01:15,735: On shopify_customers: drop view if exists "analytics"."shopify_customers" cascade
2017-04-19 23:01:16,310: 23:01:16 | 5 of 15 OK created view model analytics.shopify_products............. [CREATE VIEW in 10.45s]
2017-04-19 23:01:16,311: 23:01:16 | 9 of 15 START view model analytics.shopify_discount_codes............ [RUN]
2017-04-19 23:01:16,311: Compiling model.shopify.shopify_discount_codes
2017-04-19 23:01:16,313: Acquiring new redshift connection "shopify_discount_codes".
2017-04-19 23:01:16,313: Re-using an available connection from the pool.
2017-04-19 23:01:16,313: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d24a8>]}
2017-04-19 23:01:16,313: Using redshift connection "shopify_discount_codes".
2017-04-19 23:01:16,315: On shopify_discount_codes: BEGIN
2017-04-19 23:01:16,348: SQL status: DROP VIEW in 0.61 seconds
2017-04-19 23:01:16,348: On shopify_customers: COMMIT
2017-04-19 23:01:16,357: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:16,357: Using redshift connection "shopify_discount_codes".
2017-04-19 23:01:16,357: On shopify_discount_codes: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:16,407: SQL status: SELECT in 0.05 seconds
2017-04-19 23:01:16,409: executing node model.shopify.shopify_discount_codes
2017-04-19 23:01:16,410: Using redshift connection "shopify_discount_codes".
2017-04-19 23:01:16,410: On shopify_discount_codes: -- Compiled by DBT

    

    create view "analytics"."shopify_discount_codes__dbt_tmp" as (
        select

  _sdc_source_key_id as order_id,
  code,
  amount,
  type

from
  shippo_chooze_shopify.orders__discount_codes
    );

    
2017-04-19 23:01:16,522: SQL status: CREATE VIEW in 0.11 seconds
2017-04-19 23:01:17,027: Using redshift connection "shopify_customers".
2017-04-19 23:01:17,027: On shopify_customers: BEGIN
2017-04-19 23:01:17,065: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:17,065: Using redshift connection "shopify_customers".
2017-04-19 23:01:17,065: On shopify_customers: alter table "analytics"."shopify_customers__dbt_tmp" rename to "shopify_customers"
2017-04-19 23:01:17,065: On shopify_orders_shipping: COMMIT
2017-04-19 23:01:17,087: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 23:01:17,088: On shopify_customers: COMMIT
2017-04-19 23:01:17,746: Using redshift connection "shopify_orders_shipping".
2017-04-19 23:01:17,747: On shopify_orders_shipping: BEGIN
2017-04-19 23:01:17,877: 23:01:17 | 6 of 15 OK created view model analytics.shopify_customers............ [CREATE VIEW in 10.18s]
2017-04-19 23:01:17,878: 23:01:17 | 10 of 15 START view model analytics.shopify_refunds.................. [RUN]
2017-04-19 23:01:17,878: Compiling model.shopify.shopify_refunds
2017-04-19 23:01:17,880: Acquiring new redshift connection "shopify_refunds".
2017-04-19 23:01:17,880: Re-using an available connection from the pool.
2017-04-19 23:01:17,880: Using redshift connection "shopify_refunds".
2017-04-19 23:01:17,880: On shopify_refunds: BEGIN
2017-04-19 23:01:17,881: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fefe48>]}
2017-04-19 23:01:17,893: SQL status: BEGIN in 0.15 seconds
2017-04-19 23:01:17,893: Using redshift connection "shopify_orders_shipping".
2017-04-19 23:01:17,893: On shopify_orders_shipping: drop view if exists "analytics"."shopify_orders_shipping" cascade
2017-04-19 23:01:17,918: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:17,918: Using redshift connection "shopify_refunds".
2017-04-19 23:01:17,918: On shopify_refunds: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:17,943: SQL status: DROP VIEW in 0.05 seconds
2017-04-19 23:01:17,943: On shopify_orders_shipping: COMMIT
2017-04-19 23:01:17,971: SQL status: SELECT in 0.05 seconds
2017-04-19 23:01:17,972: executing node model.shopify.shopify_refunds
2017-04-19 23:01:17,972: Using redshift connection "shopify_refunds".
2017-04-19 23:01:17,973: On shopify_refunds: -- Compiled by DBT

    

    create view "analytics"."shopify_refunds__dbt_tmp" as (
        select

  id,
  order_id,
  user_id,
  restock,
  note,
  created_at

from
  shippo_chooze_shopify.order_refunds
    );

    
2017-04-19 23:01:18,768: SQL status: CREATE VIEW in 0.80 seconds
2017-04-19 23:01:19,099: Using redshift connection "shopify_orders_shipping".
2017-04-19 23:01:19,099: On shopify_orders_shipping: BEGIN
2017-04-19 23:01:19,143: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:19,144: Using redshift connection "shopify_orders_shipping".
2017-04-19 23:01:19,144: On shopify_orders_shipping: alter table "analytics"."shopify_orders_shipping__dbt_tmp" rename to "shopify_orders_shipping"
2017-04-19 23:01:19,144: On shopify_checkouts: COMMIT
2017-04-19 23:01:19,165: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 23:01:19,166: On shopify_orders_shipping: COMMIT
2017-04-19 23:01:19,933: Using redshift connection "shopify_checkouts".
2017-04-19 23:01:19,933: On shopify_checkouts: BEGIN
2017-04-19 23:01:19,957: 23:01:19 | 7 of 15 OK created view model analytics.shopify_orders_shipping...... [CREATE VIEW in 10.49s]
2017-04-19 23:01:19,958: 23:01:19 | 11 of 15 START view model analytics.shippo_addresses................. [RUN]
2017-04-19 23:01:19,958: Compiling model.shippo_test.shippo_addresses
2017-04-19 23:01:19,960: Acquiring new redshift connection "shippo_addresses".
2017-04-19 23:01:19,961: Re-using an available connection from the pool.
2017-04-19 23:01:19,961: Using redshift connection "shippo_addresses".
2017-04-19 23:01:19,961: On shippo_addresses: BEGIN
2017-04-19 23:01:19,961: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b17be0>]}
2017-04-19 23:01:20,004: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:20,004: Using redshift connection "shippo_addresses".
2017-04-19 23:01:20,004: On shippo_addresses: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:20,008: SQL status: BEGIN in 0.07 seconds
2017-04-19 23:01:20,008: Using redshift connection "shopify_checkouts".
2017-04-19 23:01:20,008: On shopify_checkouts: drop view if exists "analytics"."shopify_checkouts" cascade
2017-04-19 23:01:20,072: SQL status: SELECT in 0.07 seconds
2017-04-19 23:01:20,073: executing node model.shippo_test.shippo_addresses
2017-04-19 23:01:20,074: Using redshift connection "shippo_addresses".
2017-04-19 23:01:20,074: On shippo_addresses: -- Compiled by DBT

    

    create view "analytics"."shippo_addresses__dbt_tmp" as (
        select

    object_id as id,

    name,
    company,

    street1,
    street2,
    street3,
    street_no,

    city,
    state,
    zip,
    country,

    email,
    phone,

    is_residential,

    object_owner as owner,
    lower(object_purpose) as purpose,
    lower(object_source) as source,
    lower(object_state) as object_state,

    object_created as created_at,
    object_updated as updated_at


from shippo_chooze.addresses
    );

    
2017-04-19 23:01:20,112: SQL status: CREATE VIEW in 0.04 seconds
2017-04-19 23:01:20,112: SQL status: DROP VIEW in 0.10 seconds
2017-04-19 23:01:20,113: On shopify_checkouts: COMMIT
2017-04-19 23:01:20,816: Using redshift connection "shopify_checkouts".
2017-04-19 23:01:20,816: On shopify_checkouts: BEGIN
2017-04-19 23:01:20,887: SQL status: BEGIN in 0.07 seconds
2017-04-19 23:01:20,888: Using redshift connection "shopify_checkouts".
2017-04-19 23:01:20,888: On shopify_checkouts: alter table "analytics"."shopify_checkouts__dbt_tmp" rename to "shopify_checkouts"
2017-04-19 23:01:20,888: On shopify_discount_codes: COMMIT
2017-04-19 23:01:20,924: SQL status: ALTER TABLE in 0.04 seconds
2017-04-19 23:01:20,925: On shopify_checkouts: COMMIT
2017-04-19 23:01:21,350: Using redshift connection "shopify_discount_codes".
2017-04-19 23:01:21,350: On shopify_discount_codes: BEGIN
2017-04-19 23:01:21,388: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:21,388: Using redshift connection "shopify_discount_codes".
2017-04-19 23:01:21,388: On shopify_discount_codes: drop view if exists "analytics"."shopify_discount_codes" cascade
2017-04-19 23:01:21,453: SQL status: DROP VIEW in 0.06 seconds
2017-04-19 23:01:21,453: On shopify_discount_codes: COMMIT
2017-04-19 23:01:21,469: 23:01:21 | 8 of 15 OK created view model analytics.shopify_checkouts............ [CREATE VIEW in 9.03s]
2017-04-19 23:01:21,469: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112996b00>]}
2017-04-19 23:01:21,710: Using redshift connection "shopify_discount_codes".
2017-04-19 23:01:21,710: On shopify_discount_codes: BEGIN
2017-04-19 23:01:21,752: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:21,752: Using redshift connection "shopify_discount_codes".
2017-04-19 23:01:21,752: On shopify_discount_codes: alter table "analytics"."shopify_discount_codes__dbt_tmp" rename to "shopify_discount_codes"
2017-04-19 23:01:21,752: On shopify_refunds: COMMIT
2017-04-19 23:01:21,774: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 23:01:21,774: On shopify_discount_codes: COMMIT
2017-04-19 23:01:22,556: Using redshift connection "shopify_refunds".
2017-04-19 23:01:22,556: On shopify_refunds: BEGIN
2017-04-19 23:01:22,597: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:22,597: Using redshift connection "shopify_refunds".
2017-04-19 23:01:22,598: On shopify_refunds: drop view if exists "analytics"."shopify_refunds" cascade
2017-04-19 23:01:22,753: SQL status: DROP VIEW in 0.15 seconds
2017-04-19 23:01:22,753: On shopify_refunds: COMMIT
2017-04-19 23:01:22,836: 23:01:22 | 9 of 15 OK created view model analytics.shopify_discount_codes....... [CREATE VIEW in 6.52s]
2017-04-19 23:01:22,836: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11279fcf8>]}
2017-04-19 23:01:23,278: Using redshift connection "shopify_refunds".
2017-04-19 23:01:23,279: On shopify_refunds: BEGIN
2017-04-19 23:01:23,322: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:23,322: Using redshift connection "shopify_refunds".
2017-04-19 23:01:23,322: On shopify_refunds: alter table "analytics"."shopify_refunds__dbt_tmp" rename to "shopify_refunds"
2017-04-19 23:01:23,322: On shippo_addresses: COMMIT
2017-04-19 23:01:23,352: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 23:01:23,352: On shopify_refunds: COMMIT
2017-04-19 23:01:24,502: Using redshift connection "shippo_addresses".
2017-04-19 23:01:24,502: On shippo_addresses: BEGIN
2017-04-19 23:01:24,548: SQL status: BEGIN in 0.05 seconds
2017-04-19 23:01:24,548: Using redshift connection "shippo_addresses".
2017-04-19 23:01:24,548: On shippo_addresses: drop view if exists "analytics"."shippo_addresses" cascade
2017-04-19 23:01:24,600: SQL status: DROP VIEW in 0.05 seconds
2017-04-19 23:01:24,600: On shippo_addresses: COMMIT
2017-04-19 23:01:24,646: 23:01:24 | 10 of 15 OK created view model analytics.shopify_refunds............. [CREATE VIEW in 6.77s]
2017-04-19 23:01:24,646: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d3a20>]}
2017-04-19 23:01:24,914: Using redshift connection "shippo_addresses".
2017-04-19 23:01:24,915: On shippo_addresses: BEGIN
2017-04-19 23:01:24,960: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:24,960: Using redshift connection "shippo_addresses".
2017-04-19 23:01:24,960: On shippo_addresses: alter table "analytics"."shippo_addresses__dbt_tmp" rename to "shippo_addresses"
2017-04-19 23:01:24,992: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 23:01:24,992: On shippo_addresses: COMMIT
2017-04-19 23:01:25,424: 23:01:25 | 11 of 15 OK created view model analytics.shippo_addresses............ [CREATE VIEW in 5.47s]
2017-04-19 23:01:25,424: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126cfd68>]}
2017-04-19 23:01:25,536: 23:01:25 | 12 of 15 START view model analytics.shopify_order_items.............. [RUN]
2017-04-19 23:01:25,536: Compiling model.shopify.shopify_order_items
2017-04-19 23:01:25,542: 23:01:25 | 13 of 15 START view model analytics.shopify_orders................... [RUN]
2017-04-19 23:01:25,542: Compiling model.shopify.shopify_orders
2017-04-19 23:01:25,553: Acquiring new redshift connection "shopify_order_items".
2017-04-19 23:01:25,553: Re-using an available connection from the pool.
2017-04-19 23:01:25,553: Using redshift connection "shopify_order_items".
2017-04-19 23:01:25,553: On shopify_order_items: BEGIN
2017-04-19 23:01:25,568: Acquiring new redshift connection "shopify_orders".
2017-04-19 23:01:25,568: Re-using an available connection from the pool.
2017-04-19 23:01:25,568: Using redshift connection "shopify_orders".
2017-04-19 23:01:25,568: On shopify_orders: BEGIN
2017-04-19 23:01:25,593: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:25,593: Using redshift connection "shopify_order_items".
2017-04-19 23:01:25,593: On shopify_order_items: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:25,615: SQL status: BEGIN in 0.05 seconds
2017-04-19 23:01:25,615: Using redshift connection "shopify_orders".
2017-04-19 23:01:25,615: On shopify_orders: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:25,648: SQL status: SELECT in 0.06 seconds
2017-04-19 23:01:25,650: executing node model.shopify.shopify_order_items
2017-04-19 23:01:25,651: Using redshift connection "shopify_order_items".
2017-04-19 23:01:25,651: On shopify_order_items: -- Compiled by DBT

    

    create view "analytics"."shopify_order_items__dbt_tmp" as (
        with __dbt__CTE__shopify_order_items_base as (


select

    id,
    product_id,
    _sdc_source_key_id,
    sku,
    name,
    title,
    vendor,
    quantity,
    null::float as pre_tax_price,
    price,
    taxable,
    gift_card,
    total_discount,
    grams

from
    shippo_chooze_shopify.orders__line_items
)select

  id,
  product_id,
  _sdc_source_key_id as order_id,
  sku,
  name,
  title,
  vendor,
  quantity,
  pre_tax_price,
  price,
  taxable,
  gift_card,
  total_discount,
  grams

from
  __dbt__CTE__shopify_order_items_base
    );

    
2017-04-19 23:01:25,666: SQL status: SELECT in 0.05 seconds
2017-04-19 23:01:25,669: executing node model.shopify.shopify_orders
2017-04-19 23:01:25,671: Using redshift connection "shopify_orders".
2017-04-19 23:01:25,671: On shopify_orders: -- Compiled by DBT

    

    create view "analytics"."shopify_orders__dbt_tmp" as (
        with __dbt__CTE__shopify_orders_base as (


select
    -- ids
    id,
    customer__id,
    checkout_id,
    cart_token,
    checkout_token,
    token,

    -- logical ids reported in the application
    "number",
    order_number,

    -- state
    financial_status,
    fulfillment_status,
    confirmed,

    -- cancellation information
    cancel_reason,
    cancelled_at,

    -- etc
    closed_at,
    processed_at,
    email,
    contact_email,
    name,
    note,
    tags,

    -- attribution
    browser_ip,
    source_name,
    landing_site,
    null::varchar as landing_site_ref,
    referring_site,

    -- financial
    currency,
    processing_method,

    -- numbers
    subtotal_price,
    taxes_included,
    total_discounts,
    total_line_items_price,
    total_price,
    total_price_usd,
    total_tax,
    total_weight,

    -- point of sale info
    user_id,
    location_id,

    -- address
    shipping_address__address1,
    shipping_address__address2,
    shipping_address__city,
    shipping_address__company,
    shipping_address__country,
    shipping_address__country_code,
    shipping_address__first_name,
    shipping_address__last_name,
    shipping_address__latitude,
    shipping_address__longitude,
    shipping_address__name,
    shipping_address__phone,
    shipping_address__province,
    shipping_address__province_code,
    shipping_address__zip,
    billing_address__address1,
    billing_address__address2,
    billing_address__city,
    billing_address__company,
    billing_address__country,
    billing_address__country_code,
    billing_address__first_name,
    billing_address__last_name,
    billing_address__latitude,
    billing_address__longitude,
    billing_address__name,
    billing_address__phone,
    billing_address__province,
    billing_address__province_code,
    billing_address__zip,

    -- audit
    created_at,
    updated_at,
    test

from
  shippo_chooze_shopify.orders
)-- see shopify docs here:
-- https://help.shopify.com/api/reference/order

select
  -- ids
  id,
  customer__id as customer_id,
  checkout_id,
  nullif(cart_token, '') as cart_token,
  nullif(checkout_token, '') as checkout_token,
  nullif(token, '') as token,

  -- logical ids reported in the application
  "number",
  order_number,

  -- state
  financial_status,
  fulfillment_status,
  confirmed,

  -- cancellation information
  cancel_reason,
  cancelled_at,

  -- etc
  closed_at,
  processed_at,
  email,
  contact_email,
  name,
  note,
  tags,

  -- attribution
  browser_ip,
  source_name,
  landing_site,
  landing_site_ref,
  referring_site,

  -- financial
  currency,
  processing_method,

  -- numbers
  subtotal_price,
  taxes_included,
  total_discounts,
  total_line_items_price,
  total_price,
  total_price_usd,
  total_tax,
  total_weight,

  -- point of sale info
  user_id,
  location_id,

  -- address
  shipping_address__address1,
  shipping_address__address2,
  shipping_address__city,
  shipping_address__company,
  shipping_address__country,
  shipping_address__country_code,
  shipping_address__first_name,
  shipping_address__last_name,
  shipping_address__latitude,
  shipping_address__longitude,
  shipping_address__name,
  shipping_address__phone,
  shipping_address__province,
  shipping_address__province_code,
  shipping_address__zip,
  billing_address__address1,
  billing_address__address2,
  billing_address__city,
  billing_address__company,
  billing_address__country,
  billing_address__country_code,
  billing_address__first_name,
  billing_address__last_name,
  billing_address__latitude,
  billing_address__longitude,
  billing_address__name,
  billing_address__phone,
  billing_address__province,
  billing_address__province_code,
  billing_address__zip,

  -- audit
  created_at,
  updated_at

from
  __dbt__CTE__shopify_orders_base

where
  -- filter test transactions
  test = false
    );

    
2017-04-19 23:01:25,686: SQL status: CREATE VIEW in 0.04 seconds
2017-04-19 23:01:25,687: On shopify_order_items: COMMIT
2017-04-19 23:01:26,038: Using redshift connection "shopify_order_items".
2017-04-19 23:01:26,038: On shopify_order_items: BEGIN
2017-04-19 23:01:26,043: SQL status: CREATE VIEW in 0.37 seconds
2017-04-19 23:01:26,084: SQL status: BEGIN in 0.05 seconds
2017-04-19 23:01:26,084: Using redshift connection "shopify_order_items".
2017-04-19 23:01:26,084: On shopify_order_items: drop view if exists "analytics"."shopify_order_items" cascade
2017-04-19 23:01:26,124: SQL status: DROP VIEW in 0.04 seconds
2017-04-19 23:01:26,125: On shopify_order_items: COMMIT
2017-04-19 23:01:26,377: Using redshift connection "shopify_order_items".
2017-04-19 23:01:26,377: On shopify_order_items: BEGIN
2017-04-19 23:01:26,419: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:26,419: Using redshift connection "shopify_order_items".
2017-04-19 23:01:26,419: On shopify_order_items: alter table "analytics"."shopify_order_items__dbt_tmp" rename to "shopify_order_items"
2017-04-19 23:01:26,420: On shopify_orders: COMMIT
2017-04-19 23:01:26,440: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 23:01:26,440: On shopify_order_items: COMMIT
2017-04-19 23:01:26,960: Using redshift connection "shopify_orders".
2017-04-19 23:01:26,960: On shopify_orders: BEGIN
2017-04-19 23:01:26,999: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:26,999: Using redshift connection "shopify_orders".
2017-04-19 23:01:26,999: On shopify_orders: drop view if exists "analytics"."shopify_orders" cascade
2017-04-19 23:01:27,019: 23:01:27 | 12 of 15 OK created view model analytics.shopify_order_items......... [CREATE VIEW in 1.48s]
2017-04-19 23:01:27,020: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112773588>]}
2017-04-19 23:01:27,032: SQL status: DROP VIEW in 0.03 seconds
2017-04-19 23:01:27,032: On shopify_orders: COMMIT
2017-04-19 23:01:27,472: Using redshift connection "shopify_orders".
2017-04-19 23:01:27,472: On shopify_orders: BEGIN
2017-04-19 23:01:27,511: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:27,511: Using redshift connection "shopify_orders".
2017-04-19 23:01:27,511: On shopify_orders: alter table "analytics"."shopify_orders__dbt_tmp" rename to "shopify_orders"
2017-04-19 23:01:27,536: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 23:01:27,537: On shopify_orders: COMMIT
2017-04-19 23:01:27,984: 23:01:27 | 13 of 15 OK created view model analytics.shopify_orders.............. [CREATE VIEW in 2.44s]
2017-04-19 23:01:27,985: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fefb38>]}
2017-04-19 23:01:28,092: 23:01:28 | 14 of 15 START view model analytics.shopify_orders_xf................ [RUN]
2017-04-19 23:01:28,092: Compiling model.shopify.shopify_orders_xf
2017-04-19 23:01:28,094: Acquiring new redshift connection "shopify_orders_xf".
2017-04-19 23:01:28,094: Re-using an available connection from the pool.
2017-04-19 23:01:28,094: Using redshift connection "shopify_orders_xf".
2017-04-19 23:01:28,095: On shopify_orders_xf: BEGIN
2017-04-19 23:01:28,136: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:28,137: Using redshift connection "shopify_orders_xf".
2017-04-19 23:01:28,137: On shopify_orders_xf: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:28,175: SQL status: SELECT in 0.04 seconds
2017-04-19 23:01:28,176: executing node model.shopify.shopify_orders_xf
2017-04-19 23:01:28,177: Using redshift connection "shopify_orders_xf".
2017-04-19 23:01:28,177: On shopify_orders_xf: -- Compiled by DBT

    

    create view "analytics"."shopify_orders_xf__dbt_tmp" as (
        

with orders as (

  select * from "analytics"."shopify_orders"

)

select
  *,
  row_number() over (partition by customer_id order by created_at) as order_seq_number,
  case
    when row_number() over (partition by customer_id order by created_at) = 1 then 'new'
    else 'repeat'
  end as new_vs_repeat,
  case
    when cancelled_at is not null then true
    else false
  end as cancelled
from orders
    );

    
2017-04-19 23:01:28,257: SQL status: CREATE VIEW in 0.08 seconds
2017-04-19 23:01:28,257: On shopify_orders_xf: COMMIT
2017-04-19 23:01:28,701: Using redshift connection "shopify_orders_xf".
2017-04-19 23:01:28,701: On shopify_orders_xf: BEGIN
2017-04-19 23:01:28,743: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:28,743: Using redshift connection "shopify_orders_xf".
2017-04-19 23:01:28,743: On shopify_orders_xf: drop view if exists "analytics"."shopify_orders_xf" cascade
2017-04-19 23:01:28,763: SQL status: DROP VIEW in 0.02 seconds
2017-04-19 23:01:28,763: On shopify_orders_xf: COMMIT
2017-04-19 23:01:29,028: Using redshift connection "shopify_orders_xf".
2017-04-19 23:01:29,028: On shopify_orders_xf: BEGIN
2017-04-19 23:01:29,068: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:29,068: Using redshift connection "shopify_orders_xf".
2017-04-19 23:01:29,068: On shopify_orders_xf: alter table "analytics"."shopify_orders_xf__dbt_tmp" rename to "shopify_orders_xf"
2017-04-19 23:01:29,103: SQL status: ALTER TABLE in 0.03 seconds
2017-04-19 23:01:29,103: On shopify_orders_xf: COMMIT
2017-04-19 23:01:29,418: 23:01:29 | 14 of 15 OK created view model analytics.shopify_orders_xf........... [CREATE VIEW in 1.33s]
2017-04-19 23:01:29,418: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126cfd68>]}
2017-04-19 23:01:29,590: 23:01:29 | 15 of 15 START table model analytics.shipping_cost_vs_price.......... [RUN]
2017-04-19 23:01:29,590: Compiling model.shippo_test.shipping_cost_vs_price
2017-04-19 23:01:29,593: Acquiring new redshift connection "shipping_cost_vs_price".
2017-04-19 23:01:29,593: Re-using an available connection from the pool.
2017-04-19 23:01:29,594: Using redshift connection "shipping_cost_vs_price".
2017-04-19 23:01:29,594: On shipping_cost_vs_price: BEGIN
2017-04-19 23:01:29,637: SQL status: BEGIN in 0.04 seconds
2017-04-19 23:01:29,637: Using redshift connection "shipping_cost_vs_price".
2017-04-19 23:01:29,637: On shipping_cost_vs_price: select tablename as name, 'table' as type from pg_tables
        where schemaname = 'analytics'
        union all
        select viewname as name, 'view' as type from pg_views
        where schemaname = 'analytics'
2017-04-19 23:01:29,690: SQL status: SELECT in 0.05 seconds
2017-04-19 23:01:29,691: executing node model.shippo_test.shipping_cost_vs_price
2017-04-19 23:01:29,692: Using redshift connection "shipping_cost_vs_price".
2017-04-19 23:01:29,692: On shipping_cost_vs_price: -- Compiled by DBT

    

    create table "analytics"."shipping_cost_vs_price__dbt_tmp"
        as (
        

with orders as (

    select
        *,
        md5(lower(shipping_address__address1) || shipping_address__zip)
            as address_id
    from "analytics"."shopify_orders"

),

prices as (

    select * from "analytics"."shopify_orders_shipping"

),

addresses as (

    select
        *,
        md5(lower(street1) || zip) as address_id
    from "analytics"."shippo_addresses"

),

shipments as (

    select * from "analytics"."shippo_shipments"

),

rates as (

    select * from "analytics"."shippo_rates_list"

),

final as (

    select

        orders.total_price,
        prices.price as shipping_price,
        min(rates.amount) as shipping_cost

    from orders

    left outer join prices on orders.id = prices.order_id
    left outer join addresses on orders.address_id = addresses.address_id
    left outer join shipments on addresses.id = shipments.address_to_id
    left outer join rates on shipments.id = rates.shipment_id

    where shipments.id is not null

    group by 1, 2

)

select * from final
    );

    
2017-04-19 23:01:34,651: SQL status: SELECT in 4.96 seconds
2017-04-19 23:01:34,651: Using redshift connection "shipping_cost_vs_price".
2017-04-19 23:01:34,651: On shipping_cost_vs_price: alter table "analytics"."shipping_cost_vs_price__dbt_tmp" rename to "shipping_cost_vs_price"
2017-04-19 23:01:34,671: SQL status: ALTER TABLE in 0.02 seconds
2017-04-19 23:01:34,672: On shipping_cost_vs_price: COMMIT
2017-04-19 23:01:35,069: 23:01:35 | 15 of 15 OK created table model analytics.shipping_cost_vs_price..... [SELECT in 5.48s]
2017-04-19 23:01:35,069: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fce1a6f-b028-4538-918f-462ff5a798d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fefe10>]}
2017-04-19 23:01:35,275: Using redshift connection "master".
2017-04-19 23:01:35,275: On master: BEGIN
2017-04-19 23:01:35,348: SQL status: BEGIN in 0.07 seconds
2017-04-19 23:01:35,348: On master: COMMIT
2017-04-19 23:01:35,382: 23:01:35 | 
2017-04-19 23:01:35,382: 23:01:35 | Finished running 14 view models, 2 ephemeral models, 1 table models in 32.48s.
2017-04-19 23:01:35,383: Connection 'master' was left open.
2017-04-19 23:01:35,383: Done. PASS=17 ERROR=0 SKIP=0 TOTAL=17
2017-04-19 23:01:35,383: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b1e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b40390>]}
2017-04-19 23:01:35,486: Flushing usage events
